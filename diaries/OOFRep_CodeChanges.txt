OOFRep Code Change Diary

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
VERSION 1.2 released  2nd April 1996
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/05/01
REPORT-WRITER
CLASS	dbRepPage
Method	endPage
		- don't print the dashes

			

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
SIMPLIFYING BUILDING PP REPORTS
96/06/18
CLASS	dbRep
Method	reportTitle
		- added to return the report title from our dbRepSizer



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
ENHANCE THE PP REPORTS HACK FOR PRINTING dbRepChar from POWERPLANT
96/06/20
CLASS	dbRepSizer
Method	ctors
		- change the default left and right margins from 6 to 0


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/10/15
MODS TO NEW STRUCTURE (SINCE 1ST VERSION TO KEN)

CLASS	oofRepSettings
- added settings and methods
	unsigned short*	mPageHeight;
	unsigned short*	mPageWidth;
	unsigned short*	mLeftMargin;
	unsigned short*	mRightMargin;
	unsigned short*	mTopMargin;
	unsigned short*	mBottomMargin;
	unsigned short*	mColSepWidth;
	unsigned short*	mBlockVertSep;

- mLineHeight (and methods) renamed to mLineThickness


CLASS	oofRepDefaultSettings
Method	ctor
		- added defaults for the above settings
		
		
CLASS	oofRepEnvironment
Method	heightOfTextStyle
Method	moveToVerticalPos
		- added pure virtual
		
		
CLASS	oofRepMacGUI
- public isPreview data member added as hack until have separate drawing routines (probably via factories)

Method	heightOfTextStyle
		- added empty method (for Ken to do)

Method	moveToVerticalPos
		- added empty method		
		
		
CLASS	oofRepTextStyle
Method	fixedHeight
		- call the environment (through the current report) to measure the style


CLASS	oofRep
- mFootersStartAt, mPageHeight, mVerticalPos added

Method	environment
		- added to return the drawing environment
		
Method	drawPageBreak
		- draw the footers, using moveToVerticalPos
		
Method	DrawViewBand
		- cope with nil band
				
				

CLASS	oofRepLineBand
CLASS	oofRepLayoutBand
CLASS	oofRepViewBand
CLASS	oofRepSpaceBand
Method	draw
		- update the report's currentVerticalPos()
		
		
CLASS	oofRepLayoutBand
- mCalcHeight, mFixedHeight added

Method	fixedHeight
		- check mCalcHeight and calc mFixedHeight to cache the value
		
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/10/16
MODS TO NEW STRUCTURE (SINCE 2nd VERSION TO KEN)
- COPYING OF REPORT OBJECTS, DEFAULT FOOTERS & DRAW DEBUGGING

CLASS	oofRep
Method	body
		- added two methods to get and set body band
		
Method	ctor
		- take optional view band

Method	draw
		- iterate over the view's table, not the view fields
		

CLASS	oofRepSettings
- mDefaultPageHeaders, mDefaultPageFooters added with the accessor methods

Method	copy ctor
		- added (was missing altogether)
		
		
CLASS	oofRepDefaultSettings
Method	ctor
		- create blank lists for the 2 new settings
		

CLASS	oofRepBandList
CLASS	oofRepBreakList
CLASS	oofRepBlockList
- methods copy ctor, operator= & clone added
- method value added for a const retrieval of an item


CLASS	oofRepBandList
CLASS	oofRepBreakList
Method	fixedHeight
		- use count() and value() as faster iterator
						

CLASS	oofRepBreak
Method	copy ctor
		- added to clone mBand
		
Method	clone
		- added pure virtual
										
										
CLASS	oofRepBreakEveryRecord
Method	clone
		- added
										


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/10/16
HACK FOR CODEWARRIOR 10 bool

CLASS	oofRep
Method	ProcessBreakList
		- don't use |= on the bool newPage, just use an if()
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/11/18
INTEGRATE NEW REPORT API'S
(see OOFILE Code Change Diary for oofColSizer and related changes).


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/11/27
COMPILE WITHOUT POWERPLANT PRECOMPILED HEADERS

FILE	oofRepWindow.h
- #include <LListener.h>
- add forward decl of LStdButton


FILE	oofRepWindow.cp
- #include <LStdControl.h>
- #include <LScroller.h>
- #include <PP_Messages.h>





-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/11/27
MAKE IT EASIER TO CONSTRUCT REPORT BODIES WITH STYLES
CLASS	oofRep
Method	body(oofRepViewBand* 
		- return the band passed in, so can have expressions like:
SimpleReport.body( new oofRepViewBand(MainView) )->textStyle("Helvetica", 9);


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/11/28
CHANGE HEADER DEFAULT STYLES (HARD-CODED)

CLASS	oofRepViewBand
Method	drawColumnHeaders
		- hardcode setting bold text style
		- comment out drawing lines under headers



-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/11/28
COSMETIC FIXES

CLASS	oofRepViewBand
Method	drawColumnHeaders
		- don't draw if view is related view
		

CLASS	oofRepGraphBand
Method	draw
		- set the drawing style
		
		
CLASS	oofRep
Method	draw		
		- set mPageNumber to 1, to isn't 0-based and doesn't increase every time the 
		  report is re-drawn
		  
		 

PPob	oofRepWindow.PPob
		- DisplayWindow - change to  0,0,440,640 size so fills small screen
		(can't work out why zoom box not displayed!)


CLASS	oofGraphSettings
- mYAxisHeight added

Method	YAxisHeight getter & setter added


CLASS	oofGraphDefaultSettings
Method	ctor
		- init YAxisHeight(100)
		
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/11/29
MAKE IT EASIER TO ADD GRAPHS TO REPORTS

CLASS	oofRepGraphBand
Method	ctor
		- change default graph rect params from 0 to 400
		- pass the graph rect params into oofGraph::setPaneRect()
		- add graph title optional param
		
Method	finishConstruction
		- added to call oofGraph::finishConstructionWithPresets
		
		
CLASS	oofRepBand
Method	finishConstruction
		- added empty
		

CLASS	oofRep
- mFinishedConstruction added

Method	ctor
		- init mFinishedConstruction(false)
		
Method	draw
		- make a lot of settings only happen if !mFinishedConstruction								
		- call finishConstruction on all bands and band lists
		
		
		
CLASS	oofRepBandList
Method	finishConstruction
		- call finishConstruction on all bands
		
		
CLASS	oofRepBreakList
Method	finishConstruction
		- call finishConstruction on all breaks
		
		
CLASS	oofRepViewBand		
Method	finishConstruction
		- call finishConstruction on all band & break lists
		
		
CLASS	oofRepBreak
Method	finishConstruction
		- call on mBand
		
				
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/12/01
KEN'S FIXES

* Horizontal margins are now supported

* Margins are now measured from the page edges rather than the printable area
  NOTE: This means that the Report Display window displays paper size now.

* Much more extensive use of PowerPlant's UPrintingMgr in the PowerPlant
  report classes

* Rewrite of the default settings so that the measurements from the paper mean
  that the report will be within the printable area.

* oofRepWindow now supports repagination via Page Setup - NOTE: This REQUIRES
  that the report and all dependent items are still in memory since the
  report must be regenerated

* oofRepMacPrint rewritten to emulate all of the above, and make it a bit
safer.



-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
96/12/06
KEN'S FIXES

CLASS	oofRepLayoutBand
Method	draw
		- fix RA drawing by adding in leftMargin to right-aligned position
	
		
CLASS	oofTextSizer
Method	CalculateWrapping				
		- allow for line breaks
	

CLASS	oofRepWindow
Method	ctor
		- add an optional THPrint param
			


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/01/02
KEN'S FIXES
* Fixed bug which caused the report to be drawn scaled down on the page
  (making it look off-centre)

* Added ability to "box" view bands - either construct the band with an
  optional second parameter set to "true" or call band->setBoxed().

	
=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/01/13,17, 21
ENVIRONMENT-SPECIFIC RENDERERS

CLASS	oofRepEnvironment
Method	makeRender
		- added pure virtuals:
		

CLASS	oofRepMacPrint
- use base class of oofRepMacEnvironment
- mPrintRecordH put in base class


CLASS	oofRepMacGUIPreviewPP
- use base class of oofRepMacEnvironment
- mPrintRecordH put in base class
		
		
CLASS	oofRepBand
- made subclass of oofRepDrawable		


CLASS	oofRepBlock
- made subclass of oofRepDrawable		


CLASS	oofRepPageNoBlock
Method	draw
		- removed - use oofRepDrawable to call renderer
		
Method	width
		- use mRender

Method	leadingText
		trailingText
		- added inline getters
				
		
CLASS	oofRepFieldBlock
Method	draw
		- removed, using oofRepDrawable to call renderer
		(and bug fixed, use copyAsChars, not asChars)
		
Method	width
		- use mRender
		(and bug fixed, use copyAsChars, not asChars)

Method	field
		- added inline getter
				
		
CLASS	oofRepGraphBand
Method	draw
		- removed, using oofRepDrawable to call renderer
		
Method	graph
		graphWidth
		- added inline getters


CLASS	oofRepLayoutBand
Method	draw
		- BecomeCurrent() then use oofRepDrawable to call renderer
		
Method	blocks
		- added inline getter


CLASS	oofRepLineBand
Method	draw
		- removed, using oofRepDrawable to call renderer


CLASS	oofRepSpaceBand
Method	draw
		- removed, using oofRepDrawable to call renderer
		

CLASS	oofRepTextBlock
Method	draw
		- removed - use oofRepDrawable to call renderer
		
Method	width
		- use mRender

Method	text
		- added inline getter


CLASS	oofRepViewBand
Method	draw
		- removed - use oofRepDrawable to call renderer
		
Method	view
		isBoxed
		- added inline getters


type	oofRepRenderT
		- added
		
		
CLASS	oofRep
- mLastRenderType added

Method	ctor
		- init mLastRenderType(0)
		
Method	draw
		- check last drawing type against environment, in case need to create 
		  new render objects

Method	makeRender
		- added to iterate all items attached to report
		

added pure virtual base classes
- oofRepRenderer
- oofRepFieldBlock_Render
- oofRepGraphBand_Render
- oofRepLayoutBand_Render
- oofRepLineBand_Render
- oofRepPageNoBlock_Render
- oofRepSpaceBand_Render
- oofRepTextBlock_Render
- oofRepViewBand_Render

added concrete drawing classes
- oofRepFieldBlock_MacRender
- oofRepGraphBand_MacRender
- oofRepLayoutBand_MacRender
- oofRepLineBand_MacRender
- oofRepPageNoBlock_MacRender
- oofRepSpaceBand_MacRender
- oofRepTextBlock_MacRender
- oofRepViewBand_MacRender


=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/01/23
COPE WITH VIEWS WITH NO TABLE

CLASS	oofRep
Method	DrawViewBand
		- if no table, just draw once


CLASS	oofRepViewBand_MacRender
Method	drawColumnHeaders		
		- check if no table, before checking if it's a related clone
	

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/01/25
IMPLEMENT HEADER SUPPRESSION ON REPORTS

	
CLASS	oofRepDefaultSettings
Method	ctor
		- add drawHeadingsDownToLevel(1)
		
		
CLASS	oofRep
- mNestedViewLevel added

Method	ctor
		- init mNestedViewLevel(0)
		
Method	draw
		- inc and dec mNestedViewLevel around the entire draw
		
Method	shouldDrawViewColumnHeaders
		- added		
		
		
CLASS	oofRepSettings
- mDrawHeadingsDownToLevel added

Method	copy ctor
		- copy mDrawHeadingsDownToLevel
		
Method	ctor
		- init mDrawHeadingsDownToLevel(0)
		
Method	dtor
		- delete mDrawHeadingsDownToLevel		

Method	drawHeadingsDownToLevel
		- add setter and getter
		
		
CLASS	oofRepViewBand_MacRender
Method	drawColumnHeaders		
		- check oofRep::shouldDrawViewColumnHeaders()
		
		

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/02/16
BE ABLE TO COMPILE MAC PROJECTS WITHOUT PRECOMPILED HEADERS & CLEANUP FILENAMES
(see also OOFGRAPH Code Change Diary & OOFILE Code Change Diary)

ADD #IFDEF'D INCLUDES
oofRepmac.hpp
#include <UPrintingMgr.h>

oofRepMacPrint.cpp
oofRepMacPreviewPP.cpp
#include <Fonts.h>


oofRepWindow.cp
- renamed to oofRepMacWindow.cpp to reflect its bias
#include <Scrap.h>


oofrdMac.cpp & oofrdWin.cpp
merged these dummy files into an #ifdef'd oofrep3.cpp. They existed only to provide empty methods to avoid link errors if you are compiling the other platform. Having a standard file in your project regardless of platform is much cleaner.

		

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/02/16-17
CLEANUP INTEGRATION OF RTF & HTML REPORT WRITERS

CLASS	oofRepEnvironment
Method	canDraw
		- added default true
		
		
CLASS	oofRepStreamEnv
- added to hold common iostream behaviour
Method	canDraw
		- display save file dialog for destination files.
		

CLASS	oofRepHTMEnv
- made subclass of oofRepStreamEnv


CLASS	oofRep
Method	draw
		- call canDraw
		- call startEnvironment & endEnvironment


CLASS	oofRepWindow
Method	CreateWindow
		- don't call Finish any more		

Method	DoPageSetup
		- don't call Finish any more		


CLASS	oofRepMacPrint
Method	dtor
		- moved most logic to endEnvironment		
		
Method	ctor
		- moved most logic to startEnvironment, which is safer if we create
		environment but never draw it!			


CLASS	oofRepMacGUIPreviewPP
- mFinished removed
Method	Finish
		- renamed to endEnvironment
		
Method	dtor
		- moved remaining cleanup to endEnvironment		
		
Method	ctor
		- moved most logic to startEnvironment, which is safer if we create
		environment but never draw it!			


RENAMED files oofRepMacWindow.* to oofRepPPWindow.*


=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/02/16
FIX CRASHING PROBLEM WITH REPORT PAGE SETUP

CLASS	oofRepWindow
Method	dtor
		- delete mRepPtr
		
Method	CreateWindow
		- add variant that takes reference to report and clones it

Method	DoPageSetup				
		- enabled Next button if more than one pict (eg: change to landscape)
		- don't reset mEnv with the temp Preview




=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/03/21
FIX - DRAW HEADERS (NOT FIRST LINE OF DATA) IN RTF AND HTML

CLASS	oofRepViewBand_RTFRender
Method	drawColumnHeaders
		- put getHeading call in instead of reading field data
		



=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/03/21
FIX PAGE NUMBER TEXT NOT BEING SHOWN IN RTF
CLASS	oofRepPageNoBlock_RTFRender
METHOD	draw		
		- add a space after the \par so the leading string is separated from the
		 rtf directive



=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
PARTIALLY OBEY FONT STYLES IN RTF
97/03/24

set font size and style from text style in:
- oofRepViewBand_RTFRender::drawColumnHeaders
- oofRepViewBand_RTFRender::draw
- oofRepLayoutBand_RTFRender::draw


=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/03/24
DRAW GRAY LINES IN RTF (WAS BLACK)

CLASS	oofRepLineBand_RTFRender
Method	draw
		- use a picture to draw gray line, instead of a black border
		
		

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/03/30
INCLUDE RICK'S START TABLE MODS
(view band renderers may need pre and post-processing as their draw() draws a single record at a time)

CLASS	oofRep
Method	DrawViewBand		
		- call startTable and endTable


CLASS	oofRepViewBand
Method	startTable, endTable
		- added
		


CLASS	oofRepViewBand_Render
Method	startTable, endTable
		- added empty base methods
		

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/03/28
FIX - RTF EXPORT OF GREY LINE NOT WIDE ENOUGH
CLASS	oofRepLineBand_RTFRender
METHOD	draw		
		- changed conversion from twips to pixels from /21 to /19.6

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/03/29
CLEANUP - RTF EXPORT OF INLINE GRAPH AND LINE 
CLASS	oofRepLineBand_RTFRender, oofRepGraphBand_RTFRender
METHOD	draw		
		- added comments, cut out superfluous code

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/03/29
FIX - UNTERMINATED TAG
CLASS	oofRepViewBand_HTMLRender
METHOD	endTable		
		- "<p" is now properly "<p>"
		
=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/02
FIX - ELIMINATED THE "const int	kPageWidth" IN oofrpRTF.cpp
FILE		oofrpRTF.cpp	
		- all references to the page width are now done through the
		  correct access functions.
	
=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/02
FIX - PAGE DIMENSIONS NOW IN PIXELS RATHER THAN IN TWIPS
CLASS	oofRepRTFEnv
METHOD	calcPageHeight
		calcPageWidth	
		- dimensions in pixels are converted to twips just before use
		  with the twips function

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/02
FIX - COLUMN WIDTH INFORMATION IS NOW HONOURED IN THE RTF EXPORT
CLASS	oofRepViewBand_RTFRender
METHOD	draw
		drawColumnHeaders
		- uses a dbView colSizer to output RTF tables with correct
		  column width sizing

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/02
FIX - RTF PICT INLINING NOW USES BUILTIN STREAM OPERATORS FOR HEX OUTPUT
CLASS	oofRepLineBand_RTFRender, oofRepGraphBand_RTFRender
METHOD	draw		
		- took out the ugly case statement opting instead for elegant
		  stream directives. The previous stream characteristics are
		  restored after the picture's been outputed

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/03
ADD - INCLUDED A TWIPS FUNCTION WHICH CONVERTS FROM PIXELS TO TWIPS
FILE		oofrpRTF.cpp
FUNCTION	twips		


=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/03
FIX - SCANS FOR EMBEDDED NEWLINES WITHIN STRINGS FOR RTF EXPORT
CLASS	oofRepViewBand_RTFRender
METHOD	draw
		drawColumnHeaders
		- runs through a string for either CRs or LFs outputing a
		  "\par " so it is honoured in RTF

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/03
FIX - REMOVED SUPERFLUOUS SPACE IN RTF EXPORT OF TEXT BLOCKS IN TABLES
CLASS	oofRepViewBand_RTFRender, oofRepLayoutBand_RTFRender
METHOD	draw
		drawColumnHeaders
		- previously it would erroneously export a space between the
		  closing "}" and the "\cell" which would cause an overlooked
		  space to be appended to the text in the RTF

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/03
FIX - CORRECTED OUTPUT OF PAGEWIDTH TO USE TWIPS
CLASS	oofRepLayoutBand_RTFRender
METHOD	draw
		- now uses the twips function and also grabs the page width from
		  oofRep::currentReport()->bodyWidth()

=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/03
FIX - POTENTIAL PROBLEM WITH RTF CONTROL WORD WITHOUT TRAILING SPACE
CLASS	oofRepLayoutBand_RTFRender
METHOD	draw		
		- add a space after the \par so any leading string is separated
		  from the rtf directive
		 
=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/03
FIX - IMPROVED THE SPACING ACCURACY OF A SPACEBAND
CLASS	oofRepSpaceBand_RTFRender
METHOD	draw
		- now uses space between lines to determine distance, outputting
		  one space. A negative value N (ie."\sl-N") means an absolute
		  value of N is used, even if it is shorter than the tallest
		  character.


=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/03
ENABLE RICK'S RTF HEADER/FOOTER MODS

CLASS	oofRep
Method	draw
Method	drawPageBreak
		- check preprocessesPageHeadersAndFooters and don't draw those bands


CLASS	oofRepEnvironment
Method	preprocessesPageHeadersAndFooters
		- add default that returns false


CLASS	oofRepRTFEnv
Method	preprocessesPageHeadersAndFooters
		- add to return true

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
VERSION 1.3b3 released  6th April 1997
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/04/07
FIX BUG IN GRAPH BANDS - WON'T ALLOW SMALL BANDS

CLASS	oofRepGraphBand
Method	ctor
		- replace assert(heigh<=grHght) with if() and proportional reduction of graph width
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
94/04/26
FIX BUG CAUSING DRAWING OVER END OF PAGE ON MAC
* Fixed bug in oofRepViewBand_MacRender::draw() which caused view bands to
draw off the end of the page in some circumstances - this was a bug that
was actually caused by the following bug...

* Fixed a bug (or oversight) in oofRep::DrawBandList() that allowed fixed
height bands to draw off the end of the page.  This, coupled with the bug
in the view band renderer caused graphs to draw off the page ad infinitum.


NOTE: A similar fix to that of line 176 of oofRepMac.cpp will need to be
applied to any ports that were derivative of it..  (ie: addition code
rather than subtraction)

ALSO NOTE: This bug should no longer bite, because it only showed up
because the fixed size bands were actually casuing the problem - but it
would be worth fixing anyway..



-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/05/09
FIX BUGS IN PAGE OVERRUN WITHIN A RECORD, AND GRAPH SIZING

* Changed behaviour of View Bands in the Mac Renderer to draw spanning
pagebreaks
  instead of the original behaviour that always tried to start a record on a
  fresh page

* Added ability for records to span pages via a new method "drawOverRun".

* Modified standard "draw" to call "drawOverRun" in cases where the record
  won't fit on a page.

* Fixed bug in Graph bands which caused them to ignore passed in sizes - NOTE
  It's legal to pass in a graph width that's wider than the printable area
  of the page - this is currently coped with by simply centering - if the
  graph is too big, it will be cropped at the edges.


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
OOFILE 1.3b4d7 put on CW12 as demo
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/05/16
ADD COLUMN ALIGNMENT WITHIN VIEWS

CLASS	oofRepViewBand_MacRender
Method	draw, drawOverRun, drawColumnHeaders
		- check alignment settings for each field in view and offset drawing 
		  to match, with natural alignment being left for char & text fields
		  and all others right aligned.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/05/23
TRY TO FIX GRAPH BAND WIDTH PROBLEMS & FIX GRAY LINES EXPORTING AS BLACK
CLASS	oofRepGraphBand_RTFRender
Method	draw
		- call the graphHeight and graphWidth methods now those quantities are
		  actually set
		  


CLASS	oofRepLineBand_RTFRender
Method	draw		  
		- moved the PenPat(black) OUTSIDE the Close
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/05/25
FIX MINOR BUGS IN RTF READER

CLASS	oofRepSpaceBand_RTFRender
Method	draw
		- reset fixed para height by outputting \sl120 instead of \sl-120
		(problem was following rows appeared squished, due to having 
		accumulated a negative space in front of them)


CLASS	oofRepGraphBand_RTFRender
Method	draw		
		- use graph height and width, not a square of the height, as most graphs
		  are non-square to make room for the legend and axes.
		- scale the height by same factor if width is wider than the report body
		
		  
Add #ifdef OOF_Debug guarded output of RTF comments to show which draw method
just wrote the following RTF to aid in debugging, in:
- oofRepSpaceBand_RTFRender::draw
- oofRepFieldBlock_RTFRender::draw
- oofRepGraphBand_RTFRender::draw
- oofRepLayoutBand_RTFRender::draw
- oofRepLineBand_RTFRender::draw
- oofRepPageNoBlock_RTFRender::draw
- oofRepTextBlock_RTFRender::draw
- oofRepViewBand_RTFRender::draw
- oofRepViewBand_RTFRender::drawColumnHeaders
- oofRepRTFEnv::startEnvironment
- oofRepRTFEnv::endEnvironment


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/05/28, 06/01
FIX BUGS WITH RTF EXPORT

CLASS	oofRepRTFEnv
Method	preprocessesPageHeadersAndFooters
		- return true

Method	startEnvironment
		- draw the page headers and footers AFTER the start of section
		(missing H&F before because drawn before \sectd)
		

CLASS	oofRepFieldBlock_RTFRender
Method	draw		
		- don't output a \par before the field


CLASS	oofRepViewBand_RTFRender
Method	draw
		- output line break for embedded \n, not paragraph break
		- check column alignment and set paragraphs appropriately


use bitmasking for style parsing, rather than subtraction:
- oofRepViewBand_RTFRender::draw
- oofRepViewBand_RTFRender::drawColumnHeaders
- oofRepLayoutBand_RTFRender::draw		


CLASS	oofRepGraphBand_RTFRender
Method	draw
		- swap height and width to SetRect (remember left, top, right, bottom)
		Note: the giveaway should have been the graph picture being narrower
		than the picture frame
		- draw graph centred - added a \qc tag
		

CLASS	oofGraph
Method	draw		
		- reset the TextFace before drawing as we don't set it anywhere else 
		  in the graph engine and so if environment is (say) bold we will redraw
		  in bold. This is an issue when exporting RTF reports.
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/06/04
WINDOWS COMPATABILITY

FILE		oofrep.h
- add enums to match Mac constants like bold, italic so people can keep same
text styles in cross-platform code


CLASS	oofRepTextStyle
- mLOGFONT added (conditionally)

Method	ctor(LOGFONT&)
		- added  (conditionally)
		
Method	getLogFont (conditionally)
		- added
		
		
CLASS	oofRepGraphBand
Method	ctor
		- change Rect to oofRect


CLASS	oofRepLineBand_RTFRender
Method	draw
		- use platform-specific code to draw grey lines as pictures				
		
		
CLASS	oofRepWinEnv
Method	makeRenderDispatch
		- implemented		
		

CLASS	oofRep*Band
Method	makeRender(oofRepWinEnv&)
		- filled in real body
		
CLASS	oofRep*_WinRender
		- added lots of drawing classes				


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/06/06
RIGHT-ALIGNMENT IN RTF

CLASS	oofRepViewBand_RTFRender
Method	drawColumnHeaders
		- output \intbl for embedded \par triggered by newline
		- write the \q directive OUTSIDE the {} of the cell body
		
Method	draw
		- write the \q directive OUTSIDE the {} of the cell body
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/06/11
PAGE SIZES IN RTF

CLASS	oofRep
- mPageWidth added

Method	draw
		- moved startEnvironment after all height calcs
		- don't calculate pageHeight as body height, leave the margins in

Method	pageHeight, pageWidth
		- added simple accessors
		

CLASS	oofRepRTFEnv
Method	calcPageHeight		
		- change constant to A4 height (11 2/3" not 11" US)
		
Method	calcPageWidth
		- change constant to A4 width (8.2" not 8" US)		
		
Method	startEnvironment
		- write page margins, footer position and page size



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/06/12
FIX MINOR BUGS WITH DIFFERENT CONFIGURATIONS & INTEGRATE ELEMIR MODS

CLASS	oofBoxAdorner
Method	ctor
		- compare number to USHRT_MAX not ULONG_MAX
		
		
CLASS	oofRepTextStyle
Method	ctor		
		- assign positive font height, don't negate


CLASS	oofRepMacPrint, oofRepMacGUIPreviewPP
Method	startEnvironment
		- moved most of the setup to calcPageHeight
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/04
FIX CRASH IF PASS PRINTER RECORD INTO MAC REPORT

CLASS	oofRepMacPrint
Method	ctor
		- use HandToHand to copy parameter, was mistakenly BlockMoving on top of
		  unallocated memory previously
		  
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/07
FIX PROBLEMS WITH COMPLEX REPORTS AND MANY BREAK LEVELS

CLASS	oofRep
Method	DrawBreakList
		- check if band will fit and force page break (just like DrawBandList)
		
		
		  
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/07
FIX BUG WITH RTF EXPORT OF PAGE NUMBERS - FIXED NUMBER IN HEADER
CLASS	oofRepPageNoBlock_RTFRender
Method	draw
		- draw the RTF code for Current Page Number, instead of OOFRep 
		page number



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/19
MAKE WARNING-FREE WITH CODEWARRIOR 1.9.1 COMPILERS

CLASS	oofRect
Method	operator =(Rect)
		- take const Rect& not const Rect param
		
Method	copy ctor
		- take const oofRect& not oofRect& param


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/21
PRINT GRAPHS IN MONO

CLASS	oofRepSettings
- mPrintGraphsInMono added


Method	ctor, dtor, copy ctor
		- init, copy & delete mPrintGraphsInMono
		
Method	printGraphsInMono
		- added setter & getter		
		
		
CLASS	oofRepEnvironment
Method	isPrintingEnvironment
		- added default false
		
		
CLASS	oofRepMacPrint
Method	isPrintingEnvironment
		- added to return true


CLASS	oofRepDefaultSettings
Method	ctor
		- init mPrintGraphsInMono to true		
		
		
CLASS	oofRepGraphBand_MacRender
Method	draw
		- check if printing and so maybe print in mono
		

SCREEN	RepWindow
		- add Print in Black & White control 		
	
	
CLASS	oofRepWindow
- mPrintBWCheck added

Method	DoPrint
		- moved guts to PrintAsPreviewed()
		- check the mPrintBW checkbox and print using B&W if checked	
		
Method	CreateWindow
		- set the mPrintBW checkbox according to setting printGraphsInMono	


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/25
FIXING REPORT HEADERS & AVOIDING ORPHANS PLUS REMOVE LEAKS

CLASS	oofRep
Method	DrawViewBand
		- don't draw column headers

Method	draw
		- reset mNestedViewLevel
				
		
CLASS	oofRepViewBand_Render
- mDrawnColHeadersThisPage added

Method	ctor
		- init mDrawnColHeadersThisPage(false)		
		

CLASS	oofRepViewBand_WinRender
- mColHeaders added

Method	drawColumnHeaders		
		- add box logic like MacRender
		- delete [] Sizer (was memory leak!)

Method	draw	
		- delete [] Sizer (was memory leak!)

		
CLASS	oofRepViewBand_MacRender
- mColHeaders added

Method	finishConstruction
		- added to perform some operations once-off, not every line
		
Method	drawColumnHeaders		
Method	draw
Method	drawOverRun
		- move calculateWidths into finishConstruction		

		
CLASS	oofRepViewBand_*Render
Method	drawColumnHeaders
		- set 	mDrawnColHeadersThisPage	
		
		
		
CLASS	oofSizedTextArray
- added to contain array of OOF_Strings and oofTextSizers


CLASS	oofRepViewBand
Method	finishConstruction
		- call mRender->finishConstruction


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/28
FIXING REPORT BUGS

CLASS	oofRepWindow
Method	PrintAsPreviewed
		- don't call PrValidate as PrJobDialog does that anyway
		
Method	DoPrint
		- call PrJobDialog to ask if B&W should be printed
		- set global Mono setting as well as change any override		


CLASS	oofRepViewBand_MacRender
Method	startTable
		- added to reset mDrawnColHeaders as redrawing a report to print
		  doesn't call finishConstruction
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/08/28
BRAD'S FIXED WIDTH BLOCKS

CLASS	oofRepBlock
- mFixedWidth added

Method	fixedWidth
		- added accessors
		
Method	ctor
		- init mFixedWidth(0)		


CLASS	oofRepLayoutBand_MacRender
Method	draw
		- check for fixedWidth of blocks when moving across to next pos
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/01
FIX MINOR DRAW BUGS - MISSING ROWS ON NEXT PAGE, RIGHT-ALIGNED HEADERS
CLASS	oofRepViewBand_MacRender
Method	drawOverRun
		- pass unchanged height if overrun called (ie: called when we didn't fit
		  on current page)
		- use short for numRows as can go negative, for columns shorter than the
		 longest in the band
		 
		 
CLASS	oofRepViewBand_MacRender
Method	finishConstruction		 
		- set text face bold before calculating widths
		
		
CLASS	oofRepViewBand_MacRender
Method	draw, drawOverRun
		- offset box by 1
		
				
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/01
FIX CRASHES IN MAC PRINTING

CLASS	oofRepMacEnv
- mSavedPort added


CLASS	oofRepMacPrint, oofRepMacGUIPreviewPP
Method	calcPageHeight
		- init mSavedPort
		
Method	endEnvironment
		- restore the grafport
		
		
CLASS	oofRepWindow
Method	DoPrint		
		- preserve grafport



CLASS	oofRep
Method	draw
		- reset finishConstruction flag if change renderer type
		
		
				
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/02
IMPROVE REPORT PREVIEW WINDOW CONTROLS

SCREEN oofRepWindow.ppob
		- add first & last buttons & rename existing prev & next
		- put movement buttons on LHS of screen so still visible when narrow
		- anchor all buttons to LHS of screen so don't move when vary width


CLASS	oofRepWindow
- mFirstButton, mLastButton added

Method	UpdateMovementButtons
		- added to control enabled/disabled state

Method	FinishCreateSelf
		- init new buttons
		
Method	CreateWindow		
		- call UpdateMovementButtons
		
Method	ListenToMessage
		- call UpdateMovementButtons
		- added first & last buttons



CLASS	oofSizedTextArray
Method	dtor
		- uncomment (why??????????) the deletion of the contents of the array
				
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/02
GIVE APPLICATION CONTROL OVER MODALITY OF REPORT PREVIEW WINDOW

CLASS	oofRepSettings
- mModalPreviewWindow added

Method	modalPreviewWindow
		- setter & getter added
		
		
Method	ctor, copy ctor
		- init mModalPreviewWindow(0)
		
Method	dtor
		- delete mModalPreviewWindow
		
		
CLASS	oofRepDefaultSettings
Method	ctor
		- set default modalPreviewWindow(false)


CLASS	oofRepWindow
Method	CreateWindow
		- check modalPreviewWindow & set window attribute accordingly


SCREEN	oofRepWindow PPob
		- set initial attribute to modal so will come up in front of modal windows


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/02
FIX LEAK IN MAC PRINTING

CLASS	oofRepViewBand_MacRender
Method	draw		
		- use adopt() and NOT oper= with the strings manufactured by
		 CopyAsChars, since we were copying them into the body of the OOF_String
		 on the LHS and therefore leaking the generated strings
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/03
FIX MINOR COSMETIC BUGS IN MAC PRINTING

CLASS	oofRepViewBand_MacRender
Method	drawOverRun, draw
		- deduct the col header height when drawing the dividing lines
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/03
FIXING REPORT BUGS - OCCASIONAL CRASHES

CLASS	oofRepWindow
Method	PrintAsPreviewed
		- restore call to PrValidate before PrJobDialog as not sure if all
		 systems call it OK in PrJobDialog
		
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/09
RERUNNING REPORTS AND PROOFING AGAINST DATA CHANGES

CLASS	oofRepData
		- added to retain selection and record number around report runs
		
		
CLASS	oofRep
- mRepData added

Method	ctor
		- init mRepData(0)
		
Method	dtor
		- delete mRepData
		
Method	draw
		- set mRepData at end to be the current selection
		- if mRep data, use it for the report rather than the current sel.				
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/09
FIX BUG IN REPORT HEADERS - NOT DRAWN IF FIRST PAGE HAS OVERRUN, AND SOME WORDS DROPPED FROM BOTTOM OF OVERRUN COLUMN

CLASS	oofRepViewBand_MacRender
Method	drawOverRun
		- draw the column headers before drawing detail, was only drawing when
		  went over page break
		- only deduct the line heights drawn on page, not space they are drawn
		 in. Accumulated fractional rows were losing an entire row next page
		
		
CLASS	oofRepViewBand_RTFRender
Method	draw
		- draw the column headers before drawing detail


CLASS	oofRepViewBand_HTMLRender
Method	draw
		- draw the column headers before drawing detail




-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/10 
MINOR REPORT CRASHES - WEIRD KIDMAP VARIANTS
- CRASH WITH goto record 0 of 0 IN REPORTS WITHOUT DATA
- CRASH IN RTF EXPORT OF REPORTS WITH GRAPHS

CLASS	oofRepWindow
Method	RegisterClass
- add checkbox, in case application hasn't registered creator function


CLASS	oofRep
Method	draw		
- don't reset mFinishedConstruction for new renderer - causes crashes with graphs that are finished.


CLASS	oofRepData
- made subclass of dbSingleListener

Method	receiveMsg
		- added to clear mTable if the table disappears
		
Method	InitRepData
		- subscribesTo(inTable)
		
Method	useRepContext
		- only save record number if non-empty selection
		(yes, some KIDMAP reports really do report on an empty database,
		all the interesting stuff is in a header)
								
Method	restoreDataSelection
		- only gotoRecord if non-empty selection				


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/10 
FIX PROBLEMS WITH RTF EXPORT

CLASS	oofRepViewBand_RTFRender
Method	draw		
		- move the call to drawColumnHeaders in front of the output of the
		 'trowd' directive as that marks the start of a row - was creating RTF
		 files that crashed Word
		
		
CLASS	oofRep
Method	draw		
		- move the renderer creation after page sizing, in case renderer
		  creation needs to use page sizes


CLASS	oofRepViewBand
Method	finishConstruction
		- don't call on the renderer, it is more appropriate that it occur after
		renderer is created
		
Method	makeRender(const oofRepMacEnv&)
		- call finishConstruction, so we recalc column headers etc. each time
		the renderer is remade



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/11 
FIX BUG NOT DRAWING SOME GRAPHS IN RTF
CLASS	oofRepGraphBand_RTFRender
Method	draw
		- put \pard and \par around graph
		- (MAIN BUG) use double cast in shrinking calculation, was inadvertently
		  setting height to 0 due to integer truncation
		- output the picture height/width AFTER shrinking so the values used in
		  the graph are shown in the RTF





-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/16,17
INTEGRATION OF NEW STREAMS

change copyAsChars to copyString in
- oofRepFieldBlock_MacRender::draw
- oofRepFieldBlock_MacRender::width
- oofRepFieldBlock_RTFRender::draw
- oofRepViewBand_HTMLRender::draw
- oofRepViewBand_MacRender::draw
- oofRepViewBand_RTFRender::draw
- oofRepViewBand_WinRender::draw


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/25
FIX BUG WITH REPORTS WITH NO DATA

CLASS	oofRepData
Method	InitRepData
		- move subscribeTo inside the test of the inTable parameter as we were
		  trying to subscribe to a nill object




-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/25-26
FIX USE OF STREAMS THROUGHOUT
centralise the stream conversion logic in OOF_String

CLASS	oofRepTextBlock
Method	ctor(ostream&
		- directly pass the ostream& into the mText member
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/09/30
FIX BUG IN REPORT SAVING DATA CONTEXT
CLASS	oofRep
Method	draw
		- construct oofRepData BEFORE drawing the report so it saves the 
		  current record number, NOT after report iterates through all data
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/11/12
MINOR FIXES AND CODE MERGE MINE WITH ELEMIR CURRENT

FILE 	oofrpRTF.cpp
- copy Elemir's mod to make inclusion of iomanip vs iomanip.h conditional on OOF_USE_ANSI_STREAMS


CLASS	oofRepViewBand_WinRender
Method	drawColumnHeaders
		- create HD
		- use oofRect for box


CLASS	oofRepViewBand_WinRender
Method	draw		
		- use oofString
		
		
FILE	oofrpWin.h
- include oofdraw.h to get oofSizedTextArray
		


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/11/23
MERGE ELEMIR'S CODE, COMPILE UNDER CW PRO2 & VC4.1


CLASS	oofRepViewBand_WinRender
Method	finishConstruction		
		- change erroneous view()->count() to view().count()
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
OOFILE 1.3b4d13 public release
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

	
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
OOFILE 1.3b4d16 public release
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/01/04
MINOR CLEANUPS AS PART OF PP2MFC PRODUCT

FILE	oofPrnWn.h
- added include of oofRect.h


CLASS	oofRepViewBand_WinRender
Method	draw
		- rewrite to avoid the 'min' macro due to CodeWarrior conflicts


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/02/01
MINOR CLEANUPS AS PART OF PP2MFC PRODUCT


FILE	oofRect.h
- made #include math.h conditional on !OOF_PP2MFC


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
97/02/08
FIX COMPILER WARNINGS

CLASS	oofRepViewBand_MacRender
Method	draw, drawOverRun, drawColumnHeaders
		- use long, not long& local arg

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/11
ROLLED IN RICK'S CHANGES TO MAC ADORNERS

Overall Code Changes
--------------------

A new adorner system was implemented to work in concert with the existing report renderer. All classes are derived from the base oofAdorner and oofAdornerRender.

PICT block and band classes were created, with associated support classes for rendering in any environment. The Mac renderer is complete, while other environments will be completed later.

A major support class for the PICT classes is OOF_GWorldOwner. This manages the off screen buffer which holds the picture on Mac systems. It has been #ifdef'ed out so that it does not affect other platforms.


New Classes Created:

oofAdorner
|
|
----- oofShadingAdorner
|
----- oofBorderAdorner

oofAdornerRender
|
|
----- oofShadingAdorner_Render
|     |
|     |
|     ----- oofShadingAdorner_MacRender
|     |
|     ----- oofShadingAdorner_RTFRender
|     |
|     ----- oofShadingAdorner_HTMLRender
|     |
|     ----- oofShadingAdorner_TextRender
|     |
|     ----- oofShadingAdorner_WinRender      
|
----- oofBorderAdorner_Render
      |
      |
      ----- oofBorderAdorner_MacRender
      |
      ----- oofBorderAdorner_RTFRender
      |
      ----- oofBorderAdorner_HTMLRender
      |
      ----- oofBorderAdorner_TextRender
      |
      ----- oofBorderAdorner_WinRender      

OOF_GWorldOwner

oofRepRender
|
|
----- oofRepPictBand_Render
|     |
|     |
|     ----- oofRepPictBand_MacRender
|     |
|     ----- oofRepPictBand_RTFRender
|     |
|     ----- oofRepPictBand_HTMLRender
|     |
|     ----- oofRepPictBand_TextRender
|     |
|     ----- oofRepPictBand_WinRender      
|
----- oofPictBlock_Render
      |
      |
      ----- oofPictBlock_MacRender
      |
      ----- oofPictBlock_RTFRender
      |
      ----- oofPictBlock_HTMLRender
      |
      ----- oofPictBlock_TextRender
      |
      ----- oofPictBlock_WinRender    


OOF_mixAdornable     oofRepTextStylable
|                    |
|                    |
----------------------
|
|
oofRepDrawable
|
|
----- oofRepBand
|     |
|     |
|     ----- oofPictBand
|
|
----- oofRepBlock
      |
      |
      ----- oofPictBlock


(Inheritance rules were changed for oofRepBands and oofRepBlocks. Previously it inherited from oofRepTextStylable, oofRepDrawable, and OOF_mixAdornable. Now oofRepDrawable inherits oofRepTextStylable and OOF_mixAdornable.)



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/11
FIXES FOR POWERPLANT->MFC COMPATABILITY KIT & MFC COMPILE WITH CODEWARRIOR

CLASS	oofTextSizer
Method	CalculateWrapping
		- move an int decl (n) outside for loop as using ANSI rules is out of
		  scope at end of loop
		  
		  
FILE	
- add #include oofrect.h		  


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/12

All the adorner source code was farmed out to files individual to each platform. The previous 3 files: oofadorn.cpp, oofadorn.h and oofrep4.cpp have become:

oofadHTM.cpp
oofadHTM.h
oofadMac.h
oofadRTF.h
oofadTxt.h
oofadWin.h
oofadRTF.cpp
oofadTxt.cpp
oofadMac.cpp
oofadWin.cpp
oofadorn.cpp
oofadorn.h

All adorner files are in the util directory to avoid having to alter all the visual c projects (which require a mind-bendly stupid method of specifying every since include directory rather than search from the project's root directory).

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/12

Dummy declarations for makeRender have been moved from the file oofrep3.cpp to the mac and wins files. Making this file obsolete.

Finally, rolling in Rick's stuff, replaced content of old oofrep3.cpp with the settings classes from oofrep1.cpp.

(
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/19
RICK'S UNDOCUMENTED (AS YET!!!!) CHANGES FOR ADORNERS ON MAC & WIN

CLASS	oofAdorner subclasses
- comment out names of params in inline virtual methods to avoid warnings


CLASS	oofBandShadingAdorner
Method	percentage
		- removed 'void' in parameter list 
		

CLASS	oofAdornerRender
Method	drawcell (both versions)
		- removed cast to oofRepDrawable* of drawable in call to draw
		
Method	drawcell(both
		- moved from .h to .cpp file as they are being included in oofrep.h
		  before the definition of oofRepViewBand (Rick had hacked this by
		  casting the oofRepViewBand* param to an oofRepDrawable*)



CLASS	oofRepDrawable
Method	draw		  
		- don't copy adornerList
		- check adornCount before iterating adorners
		
		
CLASS	oofRepViewBand_MacRender
Method	draw
		- check that view has table before calling members of dbTable
		- don't copy adornerList

		  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/19
ELEMIR'S MINOR WINDOWS MODS

added files to enable doc/view report-writer
- oofrepMFC.cpp
- oofrepMFC.h
- oofRes.h


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/26

Bug Fix: oofRepViewBand_MacRender::draw()

view.colSizer()->calculateWidths(curRep->bodyWidth() -
						- (2*currSettings->bandIndenting())
						- colSepWidth,colSepWidth);

colSizer calculation has double -'s, making it add it instead!
Merely removing one of the - signs fixes the problem.

view.colSizer()->calculateWidths(curRep->bodyWidth()
						- (2*currSettings->bandIndenting())
						- colSepWidth,colSepWidth);

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/27

Bug Fix: 


Code which produced the problem:

		// view band for note
		theStrandView = new oofRepViewBand(*noteView);
		theStrandView->setBoxed();

This used the function setBoxed rather than placing a 'true' as 
parameter 2 in the constructor. The setBoxed function did not do it's 
job of attaching a borderAdorner. A special test is needed to make 
sure that the user can not call setBoxed multiple time (and therefore 
attach multiple adorners). Taking advantage of the fact that there 
isn't an unSetBoxed, if the internal flag mIsBoxed is true, that 
means that there has already been an adorner attached either through 
the constructor or through a call to setBoxed. This way setBoxed can 
be called multiple times but still safely only attach one adorner.

inline void 
oofRepViewBand::setBoxed()
{
	// Place a check in there to make sure they aren't trying to set it more than once.
	if( mIsBoxed==false ) {
		adorners() << new oofBorderAdorner( oofBorderAdorner::oneThin );
	}
	
	mIsBoxed=true;
}

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/27

Bug fix: oofBorderAdorner_MacRender::drawcell

The last cell's right border was being drawn 1 pixel too far to the right. 
Therefore push it back one pixel.

// For the last cell
// -1 to ensure it draws 'within' the table area
width -= 1;

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/27

oofRepViewBand_MacRender::drawColumnHeaders()

Bring drawColumnHeaders in line with changes made to the draw function:

//const bool isBoxed = mOwner->isBoxed();

>>>>>>>>>>>>>>>

unsigned long xPos=currSettings->leftMargin()+currSettings->bandIndenting();

>>>>>>>>>>>>>>>

const unsigned long adornCount = mOwner->adorners().count();
unsigned long cellY = 0;

if( adornCount ) {
	xPos+=colSepWidth/2;
}

>>>>>>>>>>>>>>>

//const unsigned long colWidth = view.colSizer()->width(i);

>>>>>>>>>>>>>>>

// Adorner information for the cell
unsigned long	cellWidth = view.colSizer()->width(i) + colSepWidth + 1;
unsigned long	cellHeight = rowDrawHeight+1;
int				cellHorizontalPos = xPos-(colSepWidth/2);
int				cellVerticalPos = curRep->currentVerticalPos()-1;

if( i==numFlds-1 ) {		// resize the last cell to right edge
	cellWidth = curRep->bodyWidth() - currSettings->bandIndenting() +
				currSettings->leftMargin() + (colSepWidth/2) - xPos;
}

::MoveTo(cellHorizontalPos, cellVerticalPos);

if (adornCount) {
	// call before adorners for cell
	mOwner->adorners().start();
	for( long ad=0; ad<adornCount; ad++ ) {
		oofAdorner* currentAdorner = mOwner->adorners().current();
		if( currentAdorner->drawWhen() == oofAdorner::drawBefore ) {
			currentAdorner->drawcell( i, cellY, mOwner, cellHeight, cellWidth );
		}
		mOwner->adorners().next();
	}
}

>>>>>>>>>>>>>>>

// Replaced colWidth with it's call

drawPos=xPos+view.colSizer()->width(i)-lengths[rownum];
...
drawPos=xPos+((view.colSizer()->width(i)-lengths[rownum])/2);
...
::Line(view.colSizer()->width(i),0); // Rule under the headings
...
xPos+=view.colSizer()->width(i)+colSepWidth;

>>>>>>>>>>>>>>>

::MoveTo(cellHorizontalPos, cellVerticalPos);
			
if (adornCount) {
	// call after adorners for cell
	mOwner->adorners().start();
	for( long ad=0; ad<adornCount; ad++ ) {
		oofAdorner* currentAdorner = mOwner->adorners().current();
		if( currentAdorner->drawWhen() == oofAdorner::drawAfter ) {
			currentAdorner->drawcell( i, cellY, mOwner, cellHeight, cellWidth );
		}
		mOwner->adorners().next();
	}
}

>>>>>>>>>>>>>>>

//if((isBoxed)&&(i<numFlds-1)){
//	MoveTo(xPos-(colSepWidth/2), curRep->currentVerticalPos());
//	Line(0,DrawHeight);
//}

>>>>>>>>>>>>>>>


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/02/27
FIX CONFLICT IN RESOURCE FILE NAMES

FILE	oofRes.h (in reports folder)
- renamed to oofRPRes.h


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/02
FIX FOR VC5 COMPILATION OF NEW REPORTS

CLASS	oofBorderAdorner
Method	ctor
		- remove oofBorderAdorner scope on BorderCode
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/02
RICK'S MINOR FORMATTING CHANGES

CLASS	oofRepLayoutBand_WinRender
Method	draw
		- Added support for centre aligning of blocks


CLASS	oofBandShadingAdorner
Method	drawCell(both)
		- removed
		
		
CLASS	oofBandShadingAdorner_MacRender
Method	draw		
		- implemented body (was empty)
		
		
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/03
FIX BUG IF USER WRITES BREAKS THAT DON'T SET BAND

CLASS	oofRepBreak
Method	finishConstruction
		- check mBand before calling mBand->finishConstruction()
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/03
RICK's MFC REPORT CHANGES

CLASS		oofRepWinGUIPreviewPP
Method		drawPageBorder
			- Changed the drawing code so that it implemented the style 
			  needed for Kidmap

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/03
RICK's MFC ADORNER CHANGES

FILE		oofadWin.cpp

#include "OOFExt.h"

			- Allows all windows code to be recognised by the compiler

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/03
RICK's MFC ADORNER CHANGES

CLASS		oofShadingAdorner_WinRender
Method		draw
		- Code written to shade under windows. Mainly it was copied 
		  from oofRepLine_WinRender code.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/03
RICK's MFC REPORT BUG FIX

CLASS		oofRepTextBlock_WinRender
Method		draw
		- Any text written leaves a white rect around itself when 
		  drawn over a shaded section of adorner. The fix is to set 
		  the background mix mode to transparent.

::SetBkMode( hdc, TRANSPARENT );

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/03
RICK's MFC REPORT CHANGES

CLASS		oofRepLineBand_WinRender
Method		draw
			- Added support for bandIndenting.
			- Added support for drawing in black instead of just grey.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/03
RICK's MFC REPORT CHANGES

CLASS		oofRepLayoutBand_WinRender
Method		draw
			- Added support for bandIndenting on the right and left align.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/04
RICK's MFC REPORT CHANGES

CLASS		oofRepViewBand_WinRender
Method		draw
		- Bring the windows renderer up to the same level as the mac.
		So that it recognises attached adorners
		Calls them
		Incorporates bandIndenting

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/04
RICK's MAC REPORT FIXES

CLASS		oofBorderAdorner_MacRender
Method		drawcell
			- Adjusted the height that the cells are drawn to so 
			  that the last cell isn't one pixel higher than all 
			  the others, as was previously the case.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/08
MERGED ELEMIR'S LATEST - ADD oofPrnWin files

CLASS	oofRepWinGUIPreviewPP 
- renamed oofRepWinGUIPreviewMFC

FILE	oofRect.h
- add guarded include of oof0.h



-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/09
RICK's MFC REPORT FIXES

CLASS		oofBorderAdorner_WinRender
Method		drawcell
			- Implement windows drawing code so that the adorner 
			  actually draws.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/09
RICK's MFC REPORT FIXES

CLASS		oofRepPictBlock
			- Correctly implemented the code to load the bitmaps


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/09
RICK's MFC REPORT FIXES

CLASS		oofRepPictBand
			- Copied across the working code from the pictBlock into 
			  the band class.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/16
RICK'S MAC REPORT FIXES

CLASS		oofRepPictBand/Block
Methods		constructors and class definitions
			- reinstated uses of the OOF_GWorldPtr class. For some reason 
			  they had been left out of the version of OOFile currently being 
			  used to implement new report writer features. Also, changes 
			  make to the pictBlock were not copied to the pictBand

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/17
RICK'S RTF MEMORY LEAK FIXES

CLASS		oofRepLineBand_RTFRender
Methods		draw
			- Memory being allocated to hold the picture before use 
			  wasn't being deallocated

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/20
RICK'S WINDOWS FIXES

CLASS		oofRepViewBand_WinRender
Methods		drawColumnHeaders
			- casting on parameters passed to CalculateWrapping to prevent 
			  warnings under Visual C++ 4.1

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/20
RICK'S WINDOWS FIXES

CLASS		oofRepWinEnv
Methods		heightOfTextStyle
			- casting on return type passed back to prevent warnings under 
			Visual C++ 4.1

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/24
RICK'S WINDOWS FIXES

CLASS		adorners
Methods		all
			- tidied up all the code for all platforms: removed commented out 
			code from previous designs that were superseeded for the current one.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/27
ELEMIR'S FIX TO REPORT PREVIEWS

CLASS	oofRepPageNoBlock_WinRender
Method	width
		- previously used DrawText for getting the text extent. This function
		  sets its own clipping region, stores the command into the metafile,
		  and it doesn't seem to restore the clipping region properly.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/27
RICK'S WINDOWS FIXES

CLASS		oofRepViewBand_WinRender
Methods		drawOverRun
			- basically a ported version from the Mac code. Previously the Windows 
			  report writer was missing it.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/27
RICK'S WINDOWS FIXES

CLASS		adorners (Windows)
Methods		all
			- the windows function headers in the derived class didn't match the 
			  base class' one. This it was not being called correctly. Fixed so 
			  that it now matches.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/30
RICK'S WINDOWS FIXES

CLASS		oofRepViewBand_WinRender
Methods		draw
			drawColumnHeaders
			drawOverRun
			- all updated to reflect improvements to the Mac viewBand

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/30
RICK'S MAC UPDATES

CLASS		oofBorderAdorner_MacRender
Methods		drawcell
			- implemented new system of drawing cells compatible with 
			  drawOverRun signal parameter


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/03/31
RICK'S WINDOWS UPDATES

CLASS		oofBorderAdorner_WinRender
Methods		drawcell
			- implemented new system of drawing cells compatible with 
			  drawOverRun signal parameter


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/05
RESTORE MISSING METHODS

CLASS		oofRepWinPrint
- all methods missing from oofPrnWn.cpp, copied from Elemir's 980316 release


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/07
ELEMIR'S LATEST FIXES TO DRAWING LOGIC

Use an IC instead of DC in
- oofRepWinGUIPreviewMFC::changeTextStyle
- oofRepWinEnv::heightOfTextStyle
- oofRepPageNoBlock_WinRender::width


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/08
FIX MAC BUG WITH ERR 2 WHEN PRINT COLOUR FROM PREVIEW WINDOW

CLASS	oofBorderAdorner_MacRender
Method	drawcell
		- only draw right and bottom lines when appropriate, so we are not drawing
		  lines on top of each other
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/17,20
MERGE ELEMIR 14/4 & 16/4 FIXES TO REMOVE RESOURCE LEAKS, ADD TOOLBAR TO PREVIEW


FILE	oofRPRes.rc
		- added resource file


FILE	oofRPRes.h
		- added IDR_PREVIEW_TOOLBAR, ID_REPORT_RTF, ID_REPORT_HTML
		- moved from source\reports\mswin\mfc up to mswin directory

FILE	source\reports\mswin\res\MToolBar.bmp
		- added file used by oofRPRes.rc
		

CLASS	oofRepWinEnv
Method	heightfTextStyle
		- don't use getCurrentDC
		
conditionally on OOFILE_USE_OLDMETAFILE, use old metafiles in:
- dbRepPICTs::Add
- oofRepWinGUIPreviewMFC::startPage
- oofRepWinGUIPreviewMFC::endPage	
- oofRepWindow::OnDraw	


CLASS	oofRepWindow
- mPageSetup, mRepDB added

Method	ctor
		- init mPageSetup(0)
		
Method	GetFileName
		- added

Method	OnEditCopy, OnReportRtf, OnReportHtml 
		- added with message maps
		
Method	OnDraw
		- only draw if picts in the database	
		
Method	OnFilePageSetup
		- recalc the size of the view			


CLASS	oofRepWinGUIPreviewMFC
- mCurrentFont, mCurrentFontDesc added

Method	ctor
		- set mCurrentFont to null
		
Method	dtor
		- call ::DeleteObject if have a current font

Method	start
		- set mFinished
		
Method	finish
		- clear mFinished
		
Method	changeTextStyle
		- don't change the DC font unless different	from mCurrentFont
		


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/22
MERGE ELEMIR FIXES 21/4 TO REPORT PREVIEW WINDOW

CLASS	oofRepWinGUIPreviewMFC
Method	startPage
		- don't SelectClipRgn or ExcludeClipRect
		
		
CLASS	oofRepWinPrint
Method	ctor
		- init mPrintGld with printDlg passed into ctor, not NULL		
		- clear the mDocInfo structure entirely before setting fields

Method	FillInPrintDlg
		- added
		
Method	print
		- moved chunk of code to FillInPrintDlg
		- if mPrintDlg, get the DC
		- always delete the DC, not just if PD null

Method	disablePrinting, getNumPages added
						
						
						
FUNC	oofAfxCreateReportView
		- returns pFrame (the created object) not TRUE
		
FUNC	oofAfxDoModalPreview
		- added
		
FUNC	oofAfxPrintReport
		- added
		
FUNC	oofAfxGetPaperSize
		- added
		
FUNC	oofAfxDoPageSetup
		- added														
		
CLASS	oofRepWindow
Method	ctor
		- get page setup details
		
Method	OnPreparePrinting
		- change the app's main wnd to our parent for call to DoPreparePrinting				
		
Method	OnFilePageSetup
		- don't OR in PS_MARGINS
		- get the device defaults before calling the page setup dialog


CLASS	CReportPreviewFrame, CModalPreviewFrame
		- added with toolbars created in OnCreate methods, cleared in OnClose			
		- renamed as oofRepPreviewFrame, oofRepModalPreviewFrame	


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/22
APPLY MAC GRAPH BAND FIXES TO WINDOWS

CLASS	oofRepGraphBand_WinRender
Method	draw
		- get graphWidth and graphHeight from mOwner rather than
		  making graph a square of the graph band height
		- check if printing and so maybe print in mono
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/23
MERGE MINOR FIXES TO MFC REPORT PREVIEW WINDOW

CLASS	oofRepWindow
Method	OnReportNext		
		- beep when hit the end

Method	OnUpdateReportNext, OnUpdateReportPrevious
		- don't disable param if at end

Method	OnReportPrevious				
		- beep when hit the start


		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/23
BRING WINDOWS R/W UP TO MAC STANDARD

CLASS	oofRepLayoutBand_WinRender
Method	draw
		- if fixedWidth specified on block, move across remainder

		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/28
INTEGRATE ELEMIR'S CHANGES TO MAKE MODAL MFC PREVIEW WINODW
DISALLOW SELECTION OF ITS PARENT FRAMEWINDOW

FUNC	oofAfxCreateReportView
		- pass in main window as 3rd param to LoadFrame


FUNC	oofAfxPrintReport
		- remove GlobalLock of devMode around printing loop

	
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/29
DRAW COLUMN HEADERS IN BOLD, ALIGNED, ON MFC
SAME AS MAC

CLASS	oofRepViewBand_WinRender
Method	drawColumnHeaders
		- add hack to always bold header text
		- copy Mac code to work out alignment, allow for natural alignment
		- copy Mac code to position as per alignment
		
Method	draw, drawOverRun	
		- copy Mac code to work out alignment, allow for natural alignment
		- copy Mac code to position as per alignment


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/04/30
FIX MFC REPORT WINDOW CRASHES WHEN EXIT, ENABLE CLOSE

CLASS	oofRepWindow
- added ON_UPDATE_COMMAND_UI(ID_APP_EXIT, OnUpdateFileExit)
- added ON_COMMAND(ID_FILE_CLOSE, OnFileClose)

Method	OnUpdateFileExit
		- added to always disable
		
Method	OnFileClose
		- added to send WM_CLOSE to parent		
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/07
CROSS-PLATFORM LINE ENDINGS & RECONCILE MAC/WIN CODE

CLASS	oofRepViewBand_WinRender
Method	draw		
		- don't loop removing CR's, Sizer has calculated lengths to ignore them
		- check draw length of line before trying to draw - may have invisible chars
		  (eg: CR) and just be zero length
		- create a sizedBody like Mac
		- comment out call to drawColumnHeaders before Mac-like logic that also
		  calls drawColumnHeaders (bad job of merging in past?)
		- pass sizedBody into drawOverrun
		- adorner calc cellVerticalPos now subtracts 1
		- use rowDrawHeight instead of DrawHeight
		  
Method	drawOverrun		
		- check draw length of line before trying to draw 
		- fix bug with numRows being unsigned, and possibly going negative

CLASS	oofRepViewBand_MacRender
Method	draw		
		- use same constants (eg: bandIndenting) as Win code
		- check draw length of line before trying to draw - may have invisible chars
		  (eg: CR) and just be zero length
		- don't call strlen on sizedBody.text(i) as can call that oofString's length()
		
Method	drawOverrun		
		- fix bug with numRows being unsigned, and possibly going negative
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/07
CROSS-PLATFORM LINE ENDINGS

use unsigned longs because of changes in oofTextSizer
- oofRepViewBand_WinRender::drawColumnHeaders		
- oofRepViewBand_WinRender::draw
- oofRepViewBand_WinRender::drawOverRun


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/10
DEBUGGING REPORT-WRITER

Check the bytes written so we don't call TextOut with 0 bytes
- oofRepViewBand_WinRender::draw
- oofRepFieldBlock_WinRender::draw
- oofRepTextBlock_WinRender::draw
- oofRepPageNoBlock_WinRender::draw
- oofRepViewBand_WinRender::drawColumnHeaders


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/11
PAGE MARGIN SETTINGS IN WINDOWS

CLASS	oofRepWindow
Method	ctor
		- always pass NULL into oofRepWinGUIPreviewMFC object as it will
		  then read margins from Windows settings anyway.
		  

CLASS	oofRepWinGUIPreviewMFC
Method	calcPageWidth		  
		- copy our mMargin settings to the local report's margins so standard
		  report logic will then make use of them
		  
Method	setPageSetup
		- transform mMargin otherwise entry of 25mm is like 2500		  
		  
		  
FUNC		oofAfxDoPageSetup
- pass in PSD_DEFAULTMINMARGINS to avoid the default argument of 
  PSD_MARGINS | PSD_INWININIINTLMEASURE which will show 0 as
  we are not passing in any margins


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/11
DISABLE PAGE MARGIN SETTINGS IN WINDOWS
(due to major side-effects, eg: graph band resizing, initial values)

CLASS	oofRepWinGUIPreviewMFC
Method	calcPageWidth		  
		- DO NOT copy our mMargin settings to the local report's margins
		  
		  
OR in the style PSD_DISABLEMARGINS in
- oofAfxDoPageSetup		  
- oofRepWindow::OnFilePageSetup


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/14
FIX PROBLEMS WITH METAFILE SIZES WHEN COPY

CLASS	oofRepWindow
Method	OnEditCopy
		- add call to get MetafileHeader for Enhanced Metafile
		  (NOTE this does not fit with optional use of old metafiles)		


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/14
MERGE ELEMIR'S NEW WINDOWS DRAWING - DON'T USE ENHANCED METAFILE

CLASS	oofCurrentDraw
- sInfoDC added


CLASS	oofTextDrawer
- added


CLASS	oofRepWinGUIPreviewMFC
Method	dtor
		- delete oofCurrentDraw's DC
		
Method	startPage
		- call oofCurrentDraw::get/setInfoDC and create an IC

Method	changeTextStyle
		- use new DC from oofCurrentDraw
				
CLASS	oofRepWindow
Method	OnEditCopy
		- wrap entire body in #ifndef OOFILE_USE_OLDMETAFILE
		
use oofTextDrawer for output and fonts in
- oofRepWinEnv::heightOfTextStyle
- oofRepPageNoBlock_WinRender::draw
		

use oofRepWinEnv::getTextExtent for measuring in		
- oofRepTextBlock_WinRender::width
- oofRepFieldBlock_WinRender::width
- oofRepPageNoBlock_WinRender::width

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/14
ADD PREVIEW'S OWN MENU

FILE	oofRPRes.h
- added IDR_PREVIEWFRAME


FILE	oofRPRes.rc
- added accelarators and menu for IDR_PREVIEWFRAME


CLASS	oofRepWinEnv
Method	getTextExtent
		- added


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/15-18
FIX ELEMIR'S NEW WINDOWS DRAWING - DON'T USE ENHANCED METAFILE

CLASS	oofRepFieldBlock_WinRender
Method	width, draw
		- use copyString instead of asChars


CLASS	oofRepPageNoBlock_WinRender
Method	draw, width
		- use OOF_String ctor that takes 3 params rather than a bunch of
		  concatenation that creates lots of temps


CLASS	oofRepWinEnv
Method	startEnvironment
		- added to reset coords as subsequent reports off page
		  (may have been unnecessary)


CLASS	oofRepWinGUIPreviewMFC
Method	dtor
		- call oofCurrentDraw::deleteInfoDC instead of calling deleteDC ourself
		  (was bug in that we didn't zero the static infoDC in oofCurrentDraw so
		   it was never recreated)
		  
Method	changeTextStyle		  
		- use oofTextDrawer::selectFont instead of SelectObject
		  (fixed major problems with graph bands drawing in random fonts)
				   
CLASS	oofTextSizer
Method	CalculateWrapping
		- use GetTextExtentExPoint to get width of string in one hit,
		  instead of totalling up sizes of characters (much more accurate
		  for proportional fonts). Later changed to use GetTabbedTextExtent,
		  it's the only such call supported under win32s.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/18
GRAPHS IN RTF

CLASS	oofRepGraphBand_RTFRender
Method	draw
		- copy logic mainly from oofRepPictBand_RTFRender
		
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/19
GRAPHS IN RTF - GET THEM IN FILE, NOT DRAWN ON SCREEN :-)

CLASS	oofRepGraphBand_RTFRender
Method	draw
		- El's fix to pass the Metafile into setCurrentDC 


		  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/19
FIX  NEW WINDOWS DRAWING - WITH STANDARD METAFILE
AND WIN32S COMPLIANT

CLASS	oofTextSizer
Method	CalculateWrapping
		- use getInfoDC not getCurrentDC to prevent crashes in measuring call
		


CLASS	oofTextDrawer
Method	getTextExtent		  
		- use GetTabbedTextExtent instead of GetTextExtentPoint32
		

CLASS	oofRepWinEnv
Method	getTextExtent		  
		- use GetTabbedTextExtent instead of GetTextExtentPoint32
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

New Files:

reports/oofrpTSV.cpp
reports/oofrpTSV.h
reports/oofrpCSV.cpp
reports/oofrpCSV.h
utils/oofadTSV.cpp
utils/oofadTSV.h
utils/oofadCSV.h
utils/oofadCSV.cpp


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofadorn.cpp
CLASS		oofAdorner
			- added makeRender( const oofRepCSVEnv& ) and
			  makeRender( const oofRepTSVEnv& )


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofadorn.h
CLASS		oofAdorner
			- added definitions for makeRender( const oofRepCSVEnv& )
			  and makeRender( const oofRepTSVEnv& ) for all
			  report class objects


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofGrphs.cpp
CLASS		oofGraph
			- New Method: dbView * oofGraph::getView()
			The text outputs CSV and TSV needed direct access to the
			view used to generate the graph. This is because it outputs
			the values in a table manner able to be interpretted by
			packages such as Excel.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofGrphs.cpp
CLASS		oofGraph
			- New Method: const char * oofGraph::getTitle()
			The text outputs CSV and TSV needed direct access to the
			title used with the graph.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofGrphs.h
CLASS		oofGraph
			- Added definitions of the functions
			dbView *getView()
			const char * getTitle()
			

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofrep.h
CLASS		ALL
			- Added declarations for oofRepCSVEnv / oofRepTSVEnv
			- Added declarations for
			makeRender( const oofRepCSVEnv& )
			makeRender( const oofRepTSVEnv& )
			for all report class objects


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofrep1.cpp
CLASS		oofRepDrawable
			- Added definitions for 
			makeRender( const oofRepCSVEnv& )
			makeRender( const oofRepTSVEnv& )
			

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofrep2.cpp
CLASS		oofRepStreamEnv
METHOD		canDraw
			- had "\pSave As?" where ? was a wierd character, replaced with elipsis


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRepPPWindow.cpp
			- Created a custom put file dialog hook function which is called
			from the PowerPlant report window to handle 'Save as...'
			Includes were added for CSV, TSV, oofDirectory, CustomPutFile(),
			and Dialog calls.
			A prototype was declared for the hook function at the top of the
			file.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRepPPWindow.cpp
CLASS		ListenToMessage
			- cases in ListenToMessage for print, saveas, and close events
			generated by buttons in the PowerPlant report window.
			Makes use of the custom put file dialog to detect which file
			format the user chose


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		RepWindow.PPob
			- Changed to include Print, Save As, and Close buttons and commands
			- Included resource dialog template for 'Save as...' dialog box

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRPRes.h
			- Changed to include a Print, Save As, and Close buttons
			- Save As Rtf and Save As Htm button removed


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRPRes.rc
			- Changed to include a Print, Save As, and Close buttons
			- Save As Rtf and Save As Htm button removed


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		MToolBar.bmp
			- Graphical pictures for Print, Save As, and Close buttons


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRepMFC.cpp
CLASS		oofRepPreviewFrame
METHOD		OnCreate
			- Only enabled docking along the bottom of the report window
			and made it the initial position


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRepMFC.cpp
CLASS		oofRepWindow
METHOD		OnReportSave
			- replaces OnReportRtf and OnReportHtml


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRepMFC.cpp
			MESSAGE_MAP
			- Updated to capture and call print, saveas and close
			commands


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/05/20
RICK'S REPORT CHANGES (CSV AND TSV SUPPORT)

FILE		oofRepMFC.cpp
CLASS		GetFileName
			- Changed the default filename to "untitled"
		  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/27
FIX BUGS IN DRAWING LONG REPORTS

CLASS	oofRepViewBand_WinRender
Method	drawOverRun		
		- add startRow into the calc of the text drawn!!!
		- also offset a couple of other references to lengths array
		- skip terminating CRLF on every line		
				
Method	draw
		- just use the string length to get the remaining len, 
		- skip terminating CRLF on every line		
		

		  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/28
INTEGRATE ELEMIR'S SOURCE TO PRINT STANDARD METAFILES

CLASS	oofRepWindow
Method	OnPrepareDC
		- added conditional body for standard metafile
		
Method	OnPrint
		- 				  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/28
FIX MISSING COL HEADERS IN PREVIEW WINDOWS REPORT 
AFTER CHANGE PAGE SETUP
CLASS	oofRepViewBand_WinRender
Method	startTable
		- added copy of Mac method to reset drawn col headers
		
		
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/29
FIX ADORNERS IN STANDARD METAFILE
AND CLEAR UP INCONCISTENCY IN NAMING, METHOD LOCN

CLASS	oofTextDrawer
- mX, mY removed

Method	moveToEx, resetCoordinates
		- moved to oofCurrentDraw as it is NOT just
		  about text
		  
		  
CLASS	oofCurrentDraw
- sX, sY added

Method	resetCoordinates, moveToEx
		- added from oofTextDrawer
		
Method	incX, incY, x, y
		- added to increment & return static members


CLASS	oofTextDrawer
Method	textOutCP
		- call oofCurrentDraw::incX instead of mX +=
		- call oofCurrentDraw::x, y intead of using mX, mY
		
				
use oofCurrentDraw::moveToEx instead of ::MoveToEx in					  
- oofBorderAdorner_WinRender::drawcell	
- oofShadingAdorner_WinRender::drawcell
- oofRepWinGUIPreviewMFC::startPage
- oofRepViewBand_WinRender::drawOverRun
- oofRepViewBand_WinRender::drawColumnHeaders
- oofRepViewBand_WinRender::draw	
- oofRepPictBlock_WinRender::draw
- oofRepPictBand_WinRender::draw


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/05/31
ROLL IN ELEMIR'S CHANGES TO RETURN TO APP 
AFTER PRINTING FROM PREVIEW

CLASS	oofRepWindow
Method	OnPreparePrinting
- don't re	set the app's main wind


FUNC		oofAfxDoModalPreview
- bring the app to the front on exit

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/06/01
ROLL IN ELEMIR'S CHANGES TO COPY CORRECT SIZE
TO CLIPBOARD IN WINDOWS

CLASS	oofRepWindow
Method	OnPrepareDC
		- call ReleaseDC on the dc object
		
Method	OnEditCopy
- add code to copy old metafile to clipboard (was just enhanced)		

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/06/01
MAKE WINDOWS RTF EXPORT SHOW GRAPHS

CLASS	oofRepGraphBand_RTFRender
Method	draw
		- did some purely empirical multiplying to get reasonable values
		  so the graph appears more-or-less correct, after experimentation
		  with saved graphs from MS Word showed them being written with
		  MM_ANISOTROPIC rather than MM_TEXT modes
		  (is this a side-effect of now using standard metafiles?)


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/06/04
FIX FOR LEXMARK PRINTERS AND OTHERS WITH WEIRD SETTINGS

CLASS	oofRepWindow
Method	ctor
		- pass NULL into oofRepWinGUIPreviewMFC object if page
		  size is zero, otherwise undo the change of 11/5
		  because there was a difference between the application
		  default settings (from null) and the those established
		  by the user in the Page Setup dialog.

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/06/21
INTEGRATE ELEMIR'S CHANGES (UP TO 19th) FOR B&W PRINTING
OF EMBEDDED GRAPHS

CLASS	oofRepWinPrint
Method	PrintPage
		- test OOFILE_USE_OLDMETAFILE and call appropriate variants of
		  SetMetaFileBits, Playxxxx and Deletexxx

Method	setMappingMode
		- added, taking a CDC

Method	isPrintingEnvironment
		- added Windows override to return true
				
				
FUNC	oofAfxPrintReport
		- add setting printDlg.hwndOwner = hwndPrtDlgOwner;				


CLASS	oofRepWindow
- mBlackAndWhitePrinting added

Maps added 	
	ON_COMMAND(ID_REPORT_BW, OnReportBW)
	ON_UPDATE_COMMAND_UI(ID_REPORT_BW, OnUpdateReportBW)
		
		
Method	ctor
		- init mBlackAndWhitePrinting(false)		
		
Method	CreateReportWindow
		- added ASSERT that a report is passed in
		
Method	OnPrepareDC
		- don't always set mapping mode to ANISOTROPIC, but
		  pass in the mode from the CDC param and use our new
		  setMappingMode			
		  
Method	OnPreparePrinting
		- check mBlackAndWhitePrinting and skip MFC prepare loop
		  if !pInfo->m_bPreview		  
		  
Method	OnPrint
		- update the mono print settings with false		  
		
Method	OnReportBW
		- added to toggle mBlackAndWhitePrinting
		
Method	OnUpdateReportBW				
		- added to set the checkbox
		
FUNC	oofAfxGetPaperSize
- removed


FILE	oofRpRes.h
- added ID_REPORT_BW


FILE	oofRpRes.rc
- added BW button on toolbar

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/06/22
CLEANUP ELEMIR'S CHANGES FOR B&W PRINTING
OF EMBEDDED GRAPHS

CLASS	oofRepWindow
Method	ctor
		- init mBlackAndWhitePrinting from oofRep::defaultSettings()->printGraphsInMono()
		  (El was always setting FALSE) (maybe irrelevant given
		  CreateReportWindow change below

Method	CreateReportWindow
		- call blackAndWhitePrinting with the setting from the inRepPtr
		  param, rather than hardcoded false


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
16/6/98
RICK'S WINDOWS FIXES

CLASS		oofShadingAdorner_WinRender
Methods		draw
- Previously the draw function filled a rectangle with light gray,
regardless of the colour settings. It now creates a custom HBRUSH to
draw the solid colour as in the mac. 

					
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
16/6/98
RICK'S WINDOWS FIXES

CLASS		oofShadingAdorner_WinRender
Methods		drawcell
- Previously the drawcell function filled a rectangle with light gray,
regardless of the colour settings. It now creates a custom HBRUSH to
draw the solid colour as in the mac. 

					
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
17/6/98
RICK'S WINDOWS FIXES

CLASS		oofBandShadingAdorner_WinAdorner
Methods		draw
		drawcell
- Implemented the band shading adorner for Windows. Previously it was
unimplemented. 


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
17/6/98
RICK'S WINDOWS FIXES

FILE		oofadWin.h
- Included the "windowsx.h" file for the DeleteBrush macro used to
implement the colour brushes in the Shading and BandShading adorners. 


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/06/22
UNDOCUMENTED CHANGES FOUND AT MERGE TIME

CLASS	oofBorderAdorner_WinRender
Method	drawcell
		- use oofCurrentDraw::MoveToEx, instead of ::MoveToEx
		  for all 4 lines
		  
		  

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
ATTEMPT TO DEBUG NT PRINTING
98/06/23

Use sizeof(PRINTDLG) etc. (the type) instead of actual variables
- oofRepWindow::OnFilePageSetup
- oofRepWindow::oofRepWindow
- oofRepWinGUIPreviewMFC::oofRepWinGUIPreviewMFC
- oofRepWinPrint::oofRepWinPrint
- oofRepWinPrint::print
- oofRepWinPrint::setMappingMode
- oofAfxDoPageSetup
- oofAfxPrintReport
- oofGraphWindow::setMappingMode


CLASS	oofCurrentDraw
Method	makeInfoDC
		- don't delete and recreate existing IC

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
98/06/22 (merged on 23/6)
HANDLING MISSING PAGE DIMENSIONS

FILE	oofPrnWn.h
- added macros INCHENTRY, MMENTRY

CLASS	oofRepWinPrint
struct	paperSizeLookup 
		- added
		
Method	getPaperSizeFromSymbolicValue
		- added		
		
Method	getPaperSize
		- if page.x or y is zero, try getPaperSizeFromSymbolicValue
		
			
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
IMPROVE DEFAULT REPORT APPEARANCE
98/06/23

CLASS	oofRepDefaultSettings
Method	ctor
		- set defaultTextStyle size down to 10 (was 12)
		
			
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
ELEMIR'S CHANGES TO VC5-COMPATABILITY
98/06/24

CLASS	oofRepWinPrint
Method	getPaperSizeFromSymbolicValue
		- remove extraneous comma in table

		  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 
ATTEMPT TO DEBUG NT PRINTING
98/06/25-28

CLASS	oofRepWinGUIPreviewMFC
Method	changeTextStyle
		- separate out some calcs so can look at temp values

Method	setPageSetup
		- don't double-transform mPaperHimetric unless page setup is
		  HiEnglish - NO DIFFERENCE
		- expand the LPtoDP logic to see intermediate values


ASSERT if null return from SelectObject in:
- oofRepWinEnv::heightOfTextStyle
- oofTextDrawer::getTextExtent
- oofTextDrawer::selectFont


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
FIX PAGE SIZE INTERPRETATION OF DEVMODE
(NOTE: I definitely implemented this on the 24th but the 
fix and notes seem to have been lost!!)
98/06/28

CLASS	oofRepWinPrint
Method	getPaperSize
		- don't assume symbolic page size only indicated by
		  zero dimensions. Check the dmField flags to see if
		  the length,width are valid as some drivers put non-zero
		  garbage in them if they don't update the field.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/06/28
NT PRINT HACK FIX TO FONTS

CLASS	oofRuntimeEnv
- added with runtimeEnv accessor and oofRuntimeEnvT enum


FILE	oof1.cpp
- added Windows-only includes"stdSDK.h" & "systype.h"


CLASS	oofTextDrawer
Method	createFontIndirect
		- added with runtime-sensitive adjustment


use oofTextDrawer::createFontIndirect in
- oofGeoLegend::calcCharHeight
- oofGeoLegend::setFontSize
- oofGeoText::calcCharHeight
- oofGeoText::setFontSize
- oofRepWinEnv::getTextExtent
- oofRepWinEnv::heightOfTextStyle
- oofRepWinGUIPreviewMFC::changeTextStyle


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/06/29
REPORT TITLE ALIGNMENT SLIGHTLY NON-CENTRERED

CLASS	oofRepLayoutBand_WinRender, oofRepLayoutBand_MacRender
Method	draw
		- fix alignment bug - left margin shouldn't be halved


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/06/28
COMPUTING OF PAGE SIZE UPDATED

CLASS	oofRepWinPrint

getPaperSize function now checks the dmFields field of DEVMODE structure
to get the correct page size and orientation.


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/06/29
STREAM OUTPUT AND FILE CLOSES

CLASS	oofRepStreamEnv
- mOwnsStream removed
- mOwnedofstream added

Method	dtor
		- if mOwnedofstream then close it before deleting
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/06/29
REPORT CLEANUP WITH BOUNDSCHECKER

CLASS	oofGeoColumn, oofGeoBar
Method	drawSelf
		- check oldBrush & oldPen non-null before SelectObject
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/07/06
PAGE OVERRUN WHEN ADORNERS ENABLED FIX

CLASS	oofRepViewBand
Method	makeRender(const oofRepWinEnv& env)

mRender->finishConstruction() call added after oofRepViewBand_WinRender
class instantiation.


CLASS	oofRepViewBand_WinRender
Method	finishConstruction

Initialization of mColHeaders member updated - implementation taken
from Mac source.


		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/07/12
CHANGE MFC PREVIEW TO HAVE REAL CHECKBOX FOR B&W PRINTING
(only works for report windows which use oofRepPreviewFrame)

FILE	MToolBa2.bmp 
- added

CLASS	oofRepPreviewFrame
- m_BWCheckBox added (has to be member, using local didn't work)

Method	OnCreate		
		- conditionally replace the BW item with a real checkbox


FILE	oofRPRes.rc
- in toolbar IDR_PREVIEW_TOOLBAR conditionally have a button vs separator
- conditionally include MToolBar.bmp or MToolBa2.bmp


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/07/12
CHANGE MFC PREVIEW TO ALWAYS APPEAR MAXIMISED

CLASS	oofRepPreviewFrame
Method	ActivateFrame
		- override parent to use WS_SHOWMAXIMIZED as default
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/07/12
BOTH PLATFORMS - REMEMBER B&W CHECKBOX EVEN IF DON'T PRINT

CLASS	oofRepWindow
Method	dtor
		- save the B&W checkbox setting back to oofRep::defaultSettings
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/07/12
IMPROVE win32s COMPATABILITY

CLASS	oofRepPreviewFrame
Method	OnCreate
		- check the OS version and don't enable FlyBys for win32s


		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/07/12
ATTEMPT TO IMPROVE WINDOWS RTF GRAPHS

CLASS	oofRepGraphBand_RTFRender
Method	draw
		- get the enhanced metafile size to set the rectangle in RTF

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/07/19
ATTEMPT TO IMPROVE WINDOWS RTF GRAPHS & RTF LINES


CLASS	oofRepGraphBand_RTFRender
Method	draw
		- go back to MM_TEXT mode and no scaling, and use standard
		  metafiles always regardless of platform
			
			
CLASS	oofRepLineBand_RTFRender
Method	draw
			- no mapping mode, scale rectangle to twips and also
			  write out goal and size in same dimension
				(works cleanly - only combination that does!)




-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
CHANGE PAGE DRAWING AND ADD ZOOMING CAPABILITY
98/07/26

CLASS	oofRepWinPrint
Method	setMappingMode
		- rename to setPrinterMappingMode.


CLASS	oofRepWindow
- sZoomType, mScaleFactor added
- add friend class oofZoomDlg

Method	ScalePage, GetTransformedPageSize, OnReportZoom, OnSize
		- added
		
Method	OnPrepareDC
		- set mapping mode for transformed page size

MsgMap	ON_COMMAND(ID_REPORT_ZOOM, ON_WM_SIZE
		- added
		

FILE	oofRepMFC.h
- add #include "oofRPRes.h"


CLASS	oofRepWIndow


CLASS	oofZoomDlg
- added		
				
				
FILE	oofRPRes.h
- IDD_OOF_ZOOMDLG, IDC_OOF_COMBO_ZOOM, ID_REPORT_ZOOM added	
			

FILE	oofRPRes.rc
- add button and stringtable for ID_REPORT_ZOOM
- add dialog IDD_OOF_ZOOMDLG


FILE	MToolBar.bmp
- added bitmap for zoom icon
- restored bitmap for BW button (lost when checkbox added)


FILE	MToolBa2.bmp
- added bitmap for zoom icon
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
OOFILE 1.3b4d18 public release
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09 - ELEMIR'S CHANGES FROM 98/07/31
Method name change.

CLASS	oofRepWinPrint
Method	setMappingMode

The name of this function has changed to setPrinterMappingMode.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09 - ELEMIR'S CHANGES FROM 98/07/31
ADD ABILITY TO SPECIFY ALTERNATE REPORTS FOR PAGE ORIENTATION
A special report for landscape orintation may be specified when printing
or previewing an OOFile report.

CLASS	global name space
Method	oofAfxCreateReportView, oofAfxDoModalPreview, oofAfxPrintReport

These functions accept a new parameter of type oofRep* that can contain
a pointer to the report that will be used when landscape mode is
selected. If the parameter is NULL, portrait report wil be used for both
modes.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09
FIX TSV INCORRECT COMMENTS

FILE	oofadTSV.cpp
		- Some of the comment headers incorrectly showed a RTF class rather
		  than the TSV class that it is.


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09
FIX WIDTH OF POPUP FILE TYPES IN MAC "SAVE AS"

FILE	oofRepPPWindow.cpp
FUNC	RepSaveDlgHook
		- added 'pascal' directive to return type
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09
ADD COLOUR AS ATTRIBUTE OF TEXT STYLES & CLEANUP COLOR METHODS
(ADAPTED RICK'S CHANGES FROM MERCATOR)

CLASS	oofColor
Method	set(eColor), set(RGBColor), set(COLORREF), 
		- added setters to match range of ctors
		
Method	set(unsigned int R, unsigned int G, unsigned int B)
		- made public

Method	setShortColor
		- renamed SetShortColor to reflect private convention
		
Method	ctor(const eColor)
		- moved guts to set(eColor)
		
		
CLASS	oofRepWinGUIPreviewMFC
Method	changeTextStyle		
		- set the foreground colour from the text style
		

FILE	oofrep.h
- add #include "oofcolor.h"

CLASS	oofRepTextStyle
- mColor added

Method	ctor
		- add color param, default Black
		
Method	fontName()
		- change return type to const oofString&

Method	color
		- added setter, getter

Methods	fontName(const oofString&),
		fontSize(unsigned short);
		leading(short);
		fontStyle(unsigned char);
		- added setters for existing attributes, to match getters
		
Method	extract
		- also dump the color
		

CLASS	oofRepTextStylable
Methods	ctor(fontName etc..,  textStyle(fontName etc..
		- add color param, default Black
		- change type of styleNum param to unsigned char to match oofRepTextStyle
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09
ALLOW USER TO DRAG TOOLBAR FROM BOTTOM OF WINDOWS PREVIEW

CLASS	oofRepPreviewFrame
Method	OnCreate
		- use style CBRS_ALIGN_ANY in EnableDocking
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09
DON'T RESIZE FONTS UNDER NT

CLASS	oofTextDrawer
Method	createFontIndirect
		- remove hack to create fonts scaled to 70% under NT
		  as new zoomed drawing code seems to work without it
		  (yes, I know this is not confidence inspiring and our
		  NT problems are still logged as a bug)


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09
REMOVE MEMORY LEAK IN WINDOWS REPORTS

CLASS	dbRepPICTS
Method	Add(both versions)
		- delete the buffer used to copy the Metafile
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/09
FIX CRASH WHEN RUN TWO GRAPHS IN ONE REPORT ON NT

CLASS	oofGeoLegend
Method	cleanupFont
		- call oofTextDrawer::selectFont instead of ::SelectObject
		  so the font is deselected from both the current DC and the IC
		  used for measurement		

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/08/12
RESTORE MISSING MAC PREVIEW WINDOW FEATURES

Copied PPob back from Mercator's copy of the Mac RepWindow.PPob which had
not been updated from their changes to add a Save As button replacing Save as
RTF & HTML individual buttons. 

Also copied set of DITL, MENU and DLOG resources for a custom PutFile.


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/09/02
TPS MERGE

CLASS	oofRepGraphBand
Method	graphHeight(unsigned long), 
		graphWidth(unsigned long)
		fixedHeight( unsigned long)
		- added simple setters
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/09/03
MERGE ELEMIR'S FIXES TO FONT STYLES AT TOP OF PAGE

CLASS	oofRepWinGUIPreviewMFC
Method	endPage
		- clear the current style to force a reload
		
		
CLASS	oofRepWinGUIPreviewMFC
Method	changeTextStyle		
		- handle NULL style, clearing the font
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/09/03
MERGE ELEMIR'S FIXES TO REPORT PREVIEW GETTING WRONG PAGE SIZE 

CLASS	oofRepWinPrint
Method	getPaperSize
		- don't unlock global structures before copying dimensions
		
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/09/03
FIX WINDOWS REPORTS - STILL USING asChars
(which will cause asserts on other than dbChar or dbText fields)

replace asChars with copyString in
- oofRepFieldBlock_WinRender::draw
		
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/04
ADD SOME CONSTS AND SIMPLER BAND CONSTRUCTION

CLASS	oofRepBandList
Method	operator<<(const oofRepBand&
		- added so can specify inline classes
		
		
CLASS	oofRepBand (and all subclasses), oofRepBlock and all subclasses
Method	clone
		- made const
		

CLASS	oofRepTextStyle
Method	extract
		- made const
		
								
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/04
REMOVE COMPILER WARNINGS

CLASS	oofColor
Method	extract
		- added
		
CLASS	oofPattern
- mPatType made cross platform (was just Windows)

Method	patternType (both)
		- made cross platform (was just Windows)
		
stream extractors added to call the appropriate extract method
- operator<<(ostream&, const oofColor&		
- operator<<(ostream&, const oofColor*		
- operator<<(ostream&, const oofPattern&		
- operator<<(ostream&, const oofPattern&		
								
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/01-02
MULTI REPORT PROCESSING

CLASS	oofRepMulti
- added subclass of oofRep with draw, appendReport and operator<< methods


CLASS	oofRepSection
- added subclass of oofRep with draw method


CLASS	oofRep
- mReferences added
- mStartingPageNumber added

Method	startingPageNumber
	- inline setter/getter added

Method	pageNumber()
	- made const

Method	copy ctor
	- added

Method	ctor
	- startingPageNumber default param added
	- init mReferences

Method	dtor
	- decrement mReferences
	- made virtual

Method	draw
	- set mPageNumber from mStartingPageNumber


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/02
MULTI REPORT PROCESSING - ENHANCE SAMPLE TO TEST

CLASS	CSampleReports
Method	DoStudentListReport
		- duplicate the report and append it twice to an oofRepMulti
		
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/02
MULTI REPORT PROCESSING - OUTPUT RTF AS SECTIONS

CLASS	oofRepEnvironment
Method	drawSectionBreak
		- added to call drawPageBreak by default
		

CLASS	oofRepRTFEnv
Method	startEnvironment		
		- call drawSectionBreak 
		
Method	drawSectionBreak
		- added with bunch of calls previously in startEnvironment
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/04
MULTI REPORT PROCESSING - DEBUG DRAWING ASSERTIONS & OVERWRITES

CLASS	oofRepSection
Method	ctor(oofRep&)
		- add default params for mPageBreak and mResetPageNo and set those members
		  (were being randomly initialised)
		  
		  
Method	finishConstruction, makeRender
		- call BecomeCurrent at top so anything we call that relies on this section
		  being the current report won't be getting wrong values
		  
		  		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/05
PAGE NUMBER RESETTING AND FIX SECTIONS IN RTF

CLASS	oofRepRTFEnv
Method	drawSectionBreak
		- output extra paragraph as can't start section at end of table,
		  must be non-table paragraph
		- use \sect instead of \sectd to force section break (not reset)
		
Method	startEnvironment
		- have own code for initial section, can't call drawSectionBreak


		  
		  		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/05
FIX BUG - MAC STREAM REPORTS (RTF) NOT ACCESSIBLE UNTIL APP EXIT

CLASS	oofRepWindow
Method	ListenToMessage				
		- close and delete the streams
		
		  		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/06
VC41 TESTING OF NEW MULTI REPORTS

CLASS	oofRepMulti
method	draw		
	- replace 2nd use of 'i' in for loop with 'j'

		
		  		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/07
FIX BUG IN WINDOWS FIELD POSITION

CLASS	oofRepFieldBlock_WinRender
Method	draw
	- use oofRepTextDrawer instead of API call, so coordinates used
	  and adjusted.
	  
	  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/07
ADD WAY TO SEE IF MULTIPLE REPORT HAS ANY SECTIONS

CLASS	oofRepMulti
Method	count
	- added to return mSections.count()
	
	
	  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/07
NEW DRAWING UNDER WINDOWS

CLASS	oofRect
Method	ctor(POINT, POINT)
	ctor(POINT, SIZE)
	ctor(const tagRECT&)
	ctor(const LPRECT)
	- added only for Windows to make more interchangeable with CRect
	
	
class	oofRepWinGUIPreviewMFC
- mBuildingPage added

Method	startPage
	- create an oofRepPage and track in mBuildingPage
	
Method	endPage
	- mPages.appendPage(mBuildingPage)
	
Method	drawPage
	- added to draw page from oofRepPageList


CLASS	oofRepWinPrint
- mRepDB removed, don't need to hang onto RAM connection
- mPICTS renamed to mPrintingPICTs to avoid confusion with parent member

Method	ctor
	- use local temp dbConnect_RAM instead of mRepDB

Method	PrintPage
	- instead of playing metafile, use DrawPage


CLASS	oofRepWindow
- mRepDB removed, don't need to hang onto RAM connection

Method	ctor
	- use local temp dbConnect_RAM instead of mRepDB

Method	OnDraw, OnPrint
	- instead of playing metafile, use drawPage
	
	
CLASS	oofTextDrawer
Method	textOutCP	
	- call oofWinTextDE::recordElement
	
Method	textOutCP(HDC, const oofString&, int textSize)
	- added variant to take oofString ref
	
Method	textOut(HDC, const oofString&)
	- added to provide central point to call recordElement
	
	
Call textOutCP(HDC, const oofString&, int textSize) in:	
- oofRepFieldBlock_WinRender::draw
- oofRepPageNoBlock_WinRender::draw
- oofRepTextBlock_WinRender::draw


- oofRepViewBand_WinRender::drawColumnHeaders
- oofRepViewBand_WinRender::draw
- oofRepViewBand_WinRender::drawOverRun


CLASS	oofDE
- added abstract base, stores coordinates


CLASS	oofTextDE
- added abstract, stores text


CLASS	oofWinTextDE
- added concrete with drawing methods, static factory


FILE	oofdraw.h
- added #include "oofstr.h"


file	oofrep.h
- added #include "oofRect.h"


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/07
DRAWING WINDOWS REPORTS WITHOUT METAFILES - TEXT STYLES

CLASS	oofRepTextStyle
Method	ctor(const LOGFONT& lf) 
	- removed as not used in our samples and doesn't init
	  members such as mLeading properly
	  
Method	operator==
	- added
	

CLASS	oofRepWinGUIPreviewMFC
- mCurrentTextStyle added
- mCurrentFontDesc removed

Method	dtor
	- delete mCurrentTextStyle
	
Method	changeTextStyle
	- move setting to drawWithTextStyle
	- compare incoming style using oofRepTextStyle to compare
	itself, not Windows font comparison
	- call oofTextStyleDE::recordElement
	
Method	drawWithTextStyle
	- added
	

CLASS	oofTextStyleDE
- added to contain a style


CLASS	oofPositionedDE
- added with x, y from oofDE


CLASS	oofTextDE
- made subclass of oofPositionedDE, not oofDE


FILE	oofrep.h
- add #include "oofdraw.h" to get oofDE definition


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/08
DRAWING WINDOWS REPORTS WITHOUT METAFILES - GRAPHS

CLASS	oofSizedDE
- added subclass of oofPositionedDE


CLASS	oofGraphDE
- added


CLASS	oofRepGraphBand_WinRender
Method	draw
	- add oofGraphDE::recordElement
	

FILE 	oofdraw.h
- add #include "oofarray.h"

FILE 	oofrpwin.h
- add #include "oofrect.h"


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/08
DRAWING WINDOWS REPORTS WITHOUT METAFILES:
REMOVE INAPPROPRIATELY CENTRALIZED RECORDING

CLASS	oofTextDrawer
Method	textOut(both variants)
	- remove oofWinTextDE::recordElement call
	
add oofWinTextDE::recordElement call to
- oofRepFieldBlock_WinRender::draw
- oofRepPageNoBlock_WinRender::draw
- oofRepTextBlock_WinRender::draw
- oofRepViewBand_WinRender::draw
- oofRepViewBand_WinRender::drawOverRun
- oofRepViewBand_WinRender::drawColumnHeaders


CLASS	oofWinTextDE, oofWinTextStyleDE
- moved to oofrpwin.h/.cpp


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/09
DRAWING WINDOWS REPORTS WITHOUT METAFILES - LINES AND SHADE

CLASS	oofWinLineDE
- added


CLASS	oofWinShadeDE
- added

call oofWinLineDE::recordElement in:
- oofBorderAdorner_WinRender::drawcell

call oofWinShadeDE::recordElement in:
- oofBandShadingAdorner_WinRender::drawcell
- oofBandShadingAdorner_WinRender::draw
- oofRepLineBand_WinRender::draw
- oofShadingAdorner_WinRender::draw
- oofShadingAdorner_WinRender::drawcell


FILE	oofadwin.cpp
- add #include "oofrpwin.h" to get above DE declarations


FILE	oofrpwin.cpp
- added #include "windowsx.h" to get DeleteBrush macro


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/09
FIX BUG - NEW CODE PRINTS ALL ON ONE PAGE

CLASS	oofRepWinPrint
Method	PrintPage
	- uncomment EndPage accidentally removed earlier
	

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/09
DRAWING WINDOWS REPORTS WITHOUT METAFILES - PAGE BORDERS

CLASS	oofRepWinGUIPreviewMFC
Method	drawPageBorder
		- call oofWinRectDE::recordElement
		
CLASS	oofWinRectDE		
- added


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/09
COMPILE LATEST ON MAC

CLASS	oofTextDE
Method	ctor(...LPCSTR
		- use const char* for the param to avoid Macintosh error
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/13
FIX WINDOWS PRINT BUGS - SHRUNK COLOUR PRINT

CLASS	oofRepWindow
Method	OnPreparePrinting
		- for colour printing, still call oofAfxPrintReport
				
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/13
REMOVE METAFILE GENERATION IN WINDOWS REPORTS


CLASS	dbRepPICTS
- removed (from Windows source)



CLASS	oofRepWindow
- mPICTs removed
- mCurrentPageIndex added

Method	OnPrepareDC
		- remove #ifdef OOF_USE_OLD_METAFILES
		  so our normal drawing has all their scaling

Method	OnDraw
		- use mCurrentPageIndex instead of mPICTs->recordNumber()

Method	ctor
		- init mCurrentPageIndex(0)
		
Method	OnPreparePrinting
		- use mEnv->getNumPages() instead of mPICTS->count()

Method	OnBeginPrinting
		- use mCurrentPageIndex instead of mPICTs->recordNumber()
		
Method	OnFilePageSetup		
		- use mCurrentPageIndex instead of mPICTs->recordNumber()
		- set mCurrentPageIndex instead of mPICTs->gotoRecord()

Method	OnEndPrinting
		- set mCurrentPageIndex instead of mPICTs->gotoRecord()

Method	OnReportFirst
		- set mCurrentPageIndex instead of mPICTs->first()

Method	OnReportLast
		- set mCurrentPageIndex instead of mPICTs->last()

Method	OnReportNext
		- set mCurrentPageIndex instead of mPICTs->next()

Method	OnReportPrevious
		- set mCurrentPageIndex instead of mPICTs->prev()


CLASS	oofRepWinGUIPreviewMFC
- mPICTs removed
- mhdcRef removed
- mhdc removed

Method	finish
		- remove cleanup of mhdcRef
		
Method	setPageSetup
		- remove transformation logic based on mhdcRef
		
Method	startPage
		- remove logic to create the metafile & set as current DC
		- don't call oofCurrentDraw::moveToEx to init mhdc
		
Method	drawWithTextStyle
		- use oofCurrentDraw::getCurrentDC instead of mhdc
		
Method	setPicts
		- removed

Method	getNumPages
		- added in terms of mPages

Method	endPage
		- remove Metafile closing logic
		
Method	drawPage		
		- call getNumPages() instead of mPICTs->count
		

CLASS	oofRepWinPrint
- mPrintingPicts removed

Method	getNumPages
		- removed (new version in parent class)
		
Method	print
		- call getNumPages() instead of mPrintingPICTs->count
		

Method	FillInPrintDlg
		- call getNumPages() instead of mPrintingPICTs->count
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/13
REMOVE WINDOWS RESOURCE LEAKS

CLASS	oofRepWinGUIPreviewMFC
- mCurrentFont removed

Method	drawWithTextStyle
		- don't set mCurrentFont
		
Method	dtor
		- don't DeleteObject on mCurrentFont
		
		
CLASS	oofRepGraphBand
Method	finishConstruction		
		- set the text style to the default for the report
		
		
CLASS	oofRepWinGUIPreviewMFC
Method	endPage		
		- only append a page if mBuildingPage is not nill 
		  (was getting incorrect total pages)
		
Method	drawPage
		- call cleanupFont
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/14
FIX OVERPRINTED PAGES ON WIN95

CLASS	oofRepWinPrint
Method	PrintPage		
		- include ::StartPage that was commented out
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/14
FIX FONT ISSUES NEEDING DC BEFORE ACTUAL DRAWING LOOP

CLASS	oofRepWinGUIPreviewMFC
Method	drawWithTextStyle
		- add ASSERT(dc) so in debug mode we catch the 
		  times when oofCurrentDraw hasn't yet got a DC
		  
Method	drawPage
		- if non-zero DC is current, release it
		
Method	start
		- set a temp display DC
		
		
TESTING ONLY - DIDN'T WORK, CAME UP WITH BLANK SCREEN		
oofRepWindow::CreateReportWindow
- remove start/draw/finish

oofAfxPrintReport
- remove draw/finish

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/15
FIX PREPASS OVERWRITE ON WINDOWS

comment out drawing calls in 
- oofBandShadingAdorner_WinRender::draw
- oofBandShadingAdorner_WinRender::drawcell
- oofBorderAdorner_WinRender::drawcell
- oofRepFieldBlock_WinRender::draw
- oofRepGraphBand_WinRender::draw
- oofRepLineBand_WinRender::draw
- oofRepPageNoBlock_WinRender::draw
- oofRepTextBlock_WinRender::draw
- oofRepViewBand_WinRender::draw
- oofRepViewBand_WinRender::drawColumnHeaders
- oofRepViewBand_WinRender::drawOverRun
- oofRepWinGUIPreviewMFC::drawPageBorder
- oofShadingAdorner_WinRender::draw
- oofShadingAdorner_WinRender::drawcell

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/15
FIX INABILITY TO PRINT LAST PAGE IF TELL WINDOWS PAGE RANGE

oofRepWinPrint::print
- don't subtract 1 from getNumPages() when working out last page


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/16
FIX TEXT DRAWING OVER SCREEN IN WIN REPORT PREPARATION

CLASS	oofRepViewBand_WinRender
Method	drawOverRun
		- remove a rogue textOut which wasnt comment out before


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/16
FIX TEXT DRAWING OVER WIN SCREEN IN REPORT PREPARATION

CLASS	oofRepWinGUIPreviewMFC
Method	drawPage
- call makeInfODC


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/16
FIX TEXT DRAWING IN WRONG POSITION IN WIN REPORTS

compensate for the advance in the commented-out textOutCP
by an explicit incX call in:
- oofRepFieldBlock_WinRender::draw
- oofRepPageNoBlock_WinRender::draw
- oofRepTextBlock_WinRender::draw


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/24-30
ELIMINATE REPORT MEMORY & RESOURCE LEAKS

CLASS	oofShadingAdorner_WinRender
Method	draw
		- remove CreateSolidBrush as don't need now recording
		

CLASS	oofRep
- mSettings marked as // owned in declaration

Method	dtor
		- delete mSettings
		
		
CLASS	oofRepDefaultSettings
Method	ctor
		- don't increment oofRepSettings ref count as init to 1
		  so was never deleting
		

CLASS	oofRepWindow
Method	ctor
		- don't get the current DC


CLASS	oofRepViewBand_WinRender
Method	drawColumnHeaders
		- delete local buffer


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/30
MAKE WINDOWS VIEW HEADERS DRAWING LIKE MAC

CLASS	oofRepViewBand_WinRender
Method	drawColumnHeaders
		- exit at top if not drawing, rather than large if() block
		- don't calculate cellY
		- don't calculate view widths if adornCount
		- replace Sizer[i] with mColHeaders
		- change char height calcs to match our draw() method, removing
		  assumptions of fixed descent
		- replaced Text[i] with mColHeaders.text(i)
		
FUNC	oofAfxPrintReport
		- delete the printing environment if cancel printing dialog


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/10/30, 11/02
SAMPLE REPORTS - REMOVE LEAKS & MAKE EASIER TO ADD NEW REPORTS

CLASS	CSampleBase
- mReports removed

Method	dtor
	- add deletes of mData
	- remove delete of mReports items

Method	ctor
		- removed calls to DoXX routines
		
Method	makeReport
		- call DoXXX routines to create reports
		
CLASS	CMainFrame
Method	OnReports
		- make while loop not recursive
		- delete sampleBase
		
		
CLASS	CSampleDlg
Method	OnPrintRep
		- delete report after printing
		

CLASS	ReportData
- added mTempProgressData instead of local var leaked
  in various report methods (used for temp graph data)
  
Method	allocTempProgressData
		- added to allocate mTempProgressData
		
Method	populateTempProgressData
		- added to generate data in mTempProgressData
		
		
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/02
FIX FAILURE TO DELETE oofRepViewBand_WinRender

CLASS	oofRepRender
Method	dtor
		- added empty virtual dtor, as wasn't calling subclass dtor!
		(CLASSIC, STUPID BLOODY MISTAKE!!!)
		

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/02
FIX LEAK OF GRAPHS IN REPORTS

CLASS	oofRepGraphBand
Method	dtor
		- delete mGraphPtr
		
Method	copy ctor
		- added to clone mGraphPtr
		
		(CLASSIC, STUPID BLOODY MISTAKE!!!)
		

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/18
EXTEND FIELD BLOCKS TO ALLOW BRACKETING TEXT

CLASS	oofRepTextBlock
- mText made protected, not private

Method	text
		- made virtual
		- return concrete oofString rather than reference
		
Method	ctor(ostream&
		- removed as ability to construct an oofString from a stream 
		  serves the same purpose and simplifies the subclasses
		  

CLASS	oofRepBracketedTextBlock
- added pure virtual to act as base for subclasses that supply
  middle text of three pieces we concatenate
  
  
CLASS	oofRepPageNoBlock
- mTrailingtext, mLeadingText, removed with their getters

Method	MiddleText
		- added	returning currentReport->pageNumber()
		
Method	ctor(const oofString&, oofRepTextStyle)
		- added
		
Method	ctor(const oofString&, const oofString&, oofRepTextStyle)
		- added to allow complex string construction bracketing
		  page number (eg: from ostreams)
		  
Method	width
		- removed
		
Method	all makeRenders
		- removed				  
  
  
CLASS	oofRepFieldBlock
Method	MiddleText
		- added	returning mField->copyString()
		
Method	ctor(const oofString&, dbField*, oofRepTextStyle)
		- added
		
Method	ctor(const oofString&, dbField*, const oofString&, oofRepTextStyle)
		- added 
		  
Method	width
		- removed
		
Method	all makeRenders
		- removed				  
		
Method	field
		- removed
		

CLASSES REMOVED
- oofRepFieldBlock_Render
- oofRepFieldBlock_TextRender
- oofRepFieldBlock_CSVRender
- oofRepFieldBlock_TSVRender
- oofRepFieldBlock_RTFRender
- oofRepFieldBlock_HTMLRender
- oofRepFieldBlock_WinRender
- oofRepFieldBlock_MacRender
- oofRepFieldBlock_Render
- oofRepFieldBlock_TextRender
- oofRepFieldBlock_CSVRender
- oofRepFieldBlock_TSVRender
- oofRepFieldBlock_RTFRender
- oofRepFieldBlock_HTMLRender
- oofRepFieldBlock_WinRender
- oofRepFieldBlock_MacRender


FUNC	twips
- removed multiple declarations from oofrpRTF.h, oofrpTSV.h etc.
- removed imp. from oofrpRTF.cpp
- added decl and inline imp in oofrep.h
						
						
								

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/18
ADD TESTING OF MULTIPLE REPORTS TO SAMPLE REPORTS

CLASS	CSampleBase
Method	makeReport
		- add case 4 to call DoMultiReport
		
Method	DoMultiReport
		- added to combine first 3
		
Method	ctor
		- add descriptions for 5th report 


RSRC	Dialog SampleReports
		- changed list to DropDown style so can click on titles
		- resized list drop down area so room for more titles
										

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/18
OOF23 - FIX PASSING MULTI REPORT INTO ANOTHER MULTI REPORT
CLASS	oofRep
Method	isMultiReport
		- added return false						
					
						
CLASS	oofRepMulti
Method	dtor
		- removed assertion that sections be non nil
		
Method	isMultiReport
		- added return true						
						
Method	orphanSection
		- added
		
Method	appendReport
		- check isMultiReport and loop calling orphanSection
		  to adopt sections from incoming multi report
		  
		  										

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/18
ADD TESTING OF PICTURE BLOCKS/BANDS TO SAMPLE REPORTS

CLASS	CSampleBase
Method	makeReport
		- add case 5 to call DoPictReport
		
Method	DoMultiReport
		- added to combine first 3
		
Method	ctor
		- add descriptions for 5th report 

		  
		  										

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/18
OOF32 - FIX FAILURE OF WINDOWS TO DRAW PICT BANDS/BLOCKS

CLASS	oofWinPictDE		
- added subclass of oofSizedDE


CLASS	oofWinPictBlock_WinRender, oofWinPictBand_WinRender
Method	draw
		- create an oofWinPictDE instead of drawing


CLASS	oofSizedDE
Method	height, width
		- added simple inline calcs
				
	

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/30
FIX WINDOWS PRECOMPILED HEADER GENERATION

FILE		oofpch_r.h, .cpp created

Add #include "oofpch_r.h" at top of all files in directories:
- reports

some files in utils (not covered by graph precompiled header)


FILE	stdoof.h
- deleted, replace with oofpch_g.h if was #included

FILE	oofext.h
- deleted, replace with oof0.h if was #included

				
	
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/11/30
BUILD ALL VC4 PROJECTS

remove all #include "oofile.h" as that's a user-configurable file and causes errors if 
it includes ctree stuff that's not shipped to report-writer only customers.

CLASS	oofRepPage
- sCurrentPage moved from oofprnwn.cpp to oofrep2.cpp


FILE	oofrepMFC.cpp
- add #include "oofram.h"

				
	
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/03
NEW PICTURE HANDLING


CLASS	oofRepPictBand, oofRepPictBlock
- mHeight, mWidth, mGWorldPtr removed
- mPict added
- made subclass of OOF_mixPictOwner

Method	ctor
		- take an oofPict as adopted pointer
		
Method	dtor
		- delete the mPict member
		
Method	fixedHeight, width
		- forward to OOF_mixPictOwner height, width methods		
		
				
CLASS	oofPict
- added with platform-specific loading (resource on Mac, bitmap on Win)



CLASS	OOF_mixPictOwner
- added 

				
	
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/05
CLEANUPS FOR VC COMPILES - UNNECESSARY RECOMPILATION
(maybe just VC bugs)

FILE	oofrpwin.cpp
- remove #includes of oof3.h, oofrep.h & oofrpwin.h as all included in 
  precompilation file oofpch_r.h 
  


FILE	oof4.cpp
- remove guarded #includes
  - oofios.h
  - oof2.h
  - oof4.h
  - oofexcep.h
  - oofquery.h
  - oofrel.h    

				
	
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/06
MAKE NEW PICTURES WORK ON MAC

FILE	oofdraw.h
- add #include ooffiles.h


CLASS	OOF_mixGWorldOwner
- moved to oofdraw from oofrep.h/cpp for Mac compile of oofPict


CLASS	oofPict
- mResID added for Mac only

Method	ctor(res ID)
		- moved contents to Load
		- init mResID
		
Method	Load
		- added for Mac to load from resource or file
		
Method	ReadPict
		- added to read from file				
		
Method	draw
		- added to perform drawing previously done by renderes
				

CLASSes	oofRepPictBand_MacRender, oofRepPictBlock_MacRender
Method	draw		
		- ask the oofPict to draw itself
		
		
CLASS	oofCurrentDraw
- made totally hidden for Mac - not used at all and only methods visible on Mac
  were ctor and dtor anyway		
		

FUNC	DrawBitmapScaled
		- fix bug where height, width not set for Win drawing if bitmap exactly
		  same size as drawing rect
		  
		  		

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/07
BRING NEW SAMPLE REPORTS FROM WIN TO MAC

FILE	CSampleBase.* 
		- copy entire contents to Mac (this file should stay xplat)
		- add #ifdef _MSC_VER around #include stdafx.h
		

FILE	database.*
		- copy entire contents to Mac
		- add #ifdef _MSC_VER around #include stdafx.h
		
		
		
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/08
COMPLETE MIXING PICT AND TEXT BLOCKS IN LAYOUT

CLASS	oofRepLayoutBand_MacRender
Method	draw		
		- don't get the font size
		- don't add fi.ascent into the vertical pos


CLASS	oofRepTextBlock_MacRender
Method	draw		
		- move down by the font ascent height and back up again when finished.		
		
		
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/08
ENHANCE SAMPLE REPORTS TO TEST LAYOUT BANDS

CLASS	CSampleBase
Method	DoPictureTest
		- put two pict blocks on layout band, with small text between
		  instead of text at rhs, to show right alignment of pictures
		  with centred text
		  

Method	DoStudentReport
		- add an extra line of text in the page header layout to test the newline
		on the date		  


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/18
OOF39 - FIX WINDOWS BUG WITH OCCASIONAL TEXT DRAWING 2ND PAGES

CLASS	oofRepViewBand_WinRender
Method	drawOverRun
		- was wrongly comparing actualRow with 0-based numRows so could retrieve
		  false length setting by going past end of index. Compare against rows for 
		  field instead of numRows.
		- renamed numRows to numRowsThisPage to avoid similar mistakes
		

CLASS	oofRepViewBand_MacRender		
Method	drawOverRun
		- renamed numRows to numRowsThisPage to avoid similar mistakes
		  
		  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/18
OOF38 - FIX WINDOWS BUG WITH PAGE SETUP LEAVING OLD PAGES

CLASS	oofRepWinGUIPreviewMFC
Method	ctor
		- init mPaperRect to nil
		
		
Method	setPageSetup
		- compare incoming paper rect and don't react if same
		- delete all the cached pages if change		
		
		
CLASS	oofRepPageList
Method	deleteAll
		- added
		
Method	dtor
		- use deleteAll
						
		  
		  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/20
CHANGE PARAM NAMES TO REFLECT OWNERSHIP

CLASS	oofRepTextStylable (and all subclasses)
Method	ctor (all of them!!!)
		- change param name of oofRepTextStyle* to adoptedStyle to show
		  in the class decls that the incoming style will be owned by the class
		  

CLASS	oofRepSettings
Method	defaultTextStyle(oofRepTextStyle*)
		- add name adoptedStyle in decl
		
				  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
98/12/27
FIX TO INCORRECT NUMBER OF PAGES APPEARING IN MFC PRINT DIALOG
WHEN PRINT WITHOUT PREVIEW
(Mercator fix - see Bruno)

FILE	oofRepMFC.cpp
FUNC	oofAfxPrintReport
		- add call to oofRepWinPrint::getPaperSize to get the paper size
		  into the page setup dialog before passing it into the oofRepWinPrint ctor
		
		  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/01/15
FIX HEAVY RESOURCE CONSUMPTION WITH GRAPHS IN WIN95

CLASS	oofPen, OOF_PenInfo, OOF_PensDict
- added


CLASS	oofBrush, OOF_BrushInfo, OOF_BrushesDict
- added


CLASS	oofDrawStyle
- mPen changed from HPEN to oofPen

Method	ctor(all)
		- call oofPen::createPen instead of ::CreatePen
		
Method	dtor
		- removed DeleteObject for Windows
		
Method	copy ctor, operator=
		- just copy the oofPen				

Method	setForeColor
		- removed
		

CLASS	oofPattern
- mBrush changed from HBRUSH to oofBrush		

Method	ctor(const oofPattern)		
		- removed
		
Method	dtor
		- removed		

Method	CopyPattern
		- removed
		
Method	set(ePattern)
		- use factory oofBrush::createBrush to assign new value to mPattern		
		
Method	patternType(ePattern)
		- call set, don't just assign to mPatType

Method	MacPattern
		- renamed to macPattern & made public
		- change param from const ePattern& to just ePattern

Method	WinPattern
		- renamed to winPattern & made public
		- change param from const ePattern& to just ePattern
						
Method	winPattern(const oofColor&)
		- added public static to parallel creation from ePattern
								
		
		  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/11
FIX FAILURE TO SET FONT SIZE AND NAME IN IC
(would affect report wrapping if non-default font sizes)

CLASS	oofTextDrawer
Method	selectFont
		- allow for null DC parameter
		
Method	setFontSize
		- still call selectFont with null DC
				
CLASS	oofRepGUIPreviewMFC
Method	drawWithTextStyle
		- still call selectFont with null DC
		
				
CLASS	oofRepTextStyle								
Method	ctor
		- set mLogFont.lfCharSet to DEFAULT_CHARSET instead of
		  leaving at default ANSI
		
		  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/11
FIX WINDOWS NT REPORT SCALING WITH SCREEN RESOLUTION
USE 72dpi INTERNALLY

FUNC	pts2logical, himetric2pts, hienglish2pts added

CLASS	oofRepWinGUIPreviewMFC
- mPaperHimetric removed

Method	getPageRectHImetric
		- removed
		
Method	setPageSetup
		- rewrote to use himetric2pts
		
Method	getPageRect
		- renamed pageRectPts to remind us always in pts
		
don't multiply font sizes by LOGPIXELSY/72 - use them directly, in 
- oofRepWinGUIPreviewMFC::drawWithTextStyle						
- oofRepWinEnv::heightOfTextStyle
- oofRepWinEnv::getTextExtent
- oofWinTextStyleDE::draw
- oofTextDrawer::setFontSize
- oofTextDrawer::calcCharHeight


CLASS	oofCurrentDraw
Method	makeDC72dpiLogical
		- added to retrieve actual device values and scale to 
		get 72dpi logical, rather than assuming 96dpi
		
Method	setCurrentDC, makeInfoDC
		- call makeDC72dpiLogical
		


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/16
REFINE WINDOWS BEHAVIOUR - FORCE ZOOMING AND 
IMPLEMENT INTERNAL COMPENSATION FOR ZOOM

CLASS	oofRepWindow
Method	ctor
		- force zoom method to FitWidth
		
		
CLASS	oofRepWinGUIPreviewMFC
Method	drawPage
		- zoom according to difference between pageRectPts and
		  incoming rect (which is scaled by the window's zoom factor)
		  		
		


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/16
MAKE GRAPH BANDS AUTO-LIMIT THEMSELVES TO REPORT HEIGHT

CLASS	oofRepGraphBand
Method	AdjustGraphToBandHeight
		- added to check current report
		
Method	ctor
		- moved calcs to limit graph dimensions to AdjustGraphToBandHeight
		
Method	finishConstruction
		- call AdjustGraphToBandHeight
		
								  		
CLASS	oofRep
Method	bodyHeight
		- added simple inline		


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/16
FIX SCROLLBAR HEIGHT CALCS IN WINDOWS

CLASS	oofRepWindow
Method	AdjustScrollSize
		- added with compensation for our 72dpi measurement
		
Method	OnFilePageSetup, OnInitialUpdate, OnSize, ScalePage
		- call AdjustScrollSize instead of inline calc		


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/18
HACK TO IMPROVE LAYOUT RENDERING IN WINDOWS NT

CLASS	oofRepLayoutBand_WinRender
Method	draw
		- add extra space after sequentially drawn text blocks
		- 99/02/23 refine the extra space by basing on block width		  
		
		  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/24
FIX PROBLEMS WITH MULTIPLE BANDS AND GRAPH SIZING

CLASS	oofRepBandList
- enum keepTogetherT added
- mKeepTogether added
- mMinHeight, mFixedHeight added

Method	ctor
		- add param to set mKeepTogether with default eDefaultTogether
		- init mFixedHeight to ULONG_MAX to indicate not yet calc
		
Method	operator=
		- copy mKeepTogether, mMinHeight, mFixedHeight
		
Method	finishConstruction
		- calculate mKeepTogether, mMinHeight, mFixedHeight
		
Method	fixedHeight
		- only calc height if not yet calc
		
Method	minHeight
		- added getter				
		
Method	keepTogether
		- added getter/setter pair		
		
		

CLASS	oofRepBand
Method	minHeight
		- added default to return fixedHeight()

Method	drawSquished
		- added virtual just calls draw()
				

CLASS	oofRepGraphBand
- mMinSizePercent, mMinHeight added

Method	ctor
		- init mMinSizePercent(kkUseDefaultScalePercent)
		
Method	copy ctor
		- copy mMinSizePercent
				
Method	fixedHeight
		- made non inline as it's virtual

Method	minHeight
		- added getter

Method	AdjustGraphToBandHeight
		- also set mMinHeight if it is too large

Method	drawSquished
		- added to reduce height whilst drawing

Method	finishConstruction
		- calculate mMinHeight based on graphBandMinSizePercent	applied to
		  original size of graph (eg: if specify too large for page, min size
		  might be 50% of large graph, say 70% of page body height).					
		

CLASS	oofRep
Method	drawBandList
		- check keepTogether() and use minHeight() to decide if entire list fits



CLASS	oofRepSettings
- mGraphBandMinSizePercent

Method	graphBandMinSizePercent
		- added setter/getter						
		

CLASS	oofRepDefaultSettings
Method	ctor
		- init graphBandMinSizePercent(50)				
		  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/24
FIX PROBLEMS WITH NT PREVIEW SCALING & SCROLLBARS


CLASS	oofRepWindow
Method	AdjustScrollSize
		- divide by logpixels and multiply by 72 
		  (was scaling down when should have been up)
		- HACK - don't adjust vertical as can't scroll entire report,
		  although horizontal now OK with FitWidth zooming
		  
		  
		  
CLASS	oofRepWinGUIPreviewMFC
Method	drawPage
		- scale the inwidth to 72dpi pts before working out the scale
		  factor between it and the page rectangle. Was left in device 96dpi
		  so scaling too much.
	  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/26
FIX BUG IF CHANGE PAGE SETUP SO FEWER PAGES

CLASS	oofRepWindow
Method	OnFilePageSetup
		- adjust nPage before setting current page so retains
		  approx same position in range.


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/02/26
PREVENT WINDOWS GRAPH BAND SPURIOUS PAGE BREAKS

CLASS	oofRepGraphBand_WinRender
Method	draw
		- don't page break if we don't fit - highlevel logic in 
		  oofRep::drawBandList now handles this
		  

CLASS	oofRep
Method	drawBandList
		- correct algorithm for dividing up space, was creating too
		  big an amount to reduce by
		- return early if empty list
		  
		  
CLASS	oofRepGraphBand
- mDrawingHeight, mSavedGrHgt, mSavedGrWid added

Method	draw
		- added override so can call RestoreDimensions before parent draw
		
Method	drawingHeight
		- added getter for mDrawingHeight				  		  

Method	RestoreDimensions
		- added to restore from mHeight and mSaved*
		
Method	AdjustGraphToBandHeight
		- adjust mDrawingHeight, not mHeight
		
Method	ctor
		- init 		mSavedGrHgt, mSavedGrWid to parameter height & width
		
Method 	copy ctor
		- copy mSavedGrHgt, mSavedGrWid


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/03/02
FIX FAILURE TO PRINT ON 360 DPI PRINTER WITH WIN95

CLASS	oofRepWinGUIPreviewMFC
Method	drawPage
		- change scaling factor down to 10 not 100 as that violates
	    16bit range on Win95
				


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/03/04
IMPROVE BAND DRAWING AND GRAPH APPEARANCE

CLASS	oofRep
Method	DrawBandList
		- if bandlist big enough to jump to next page, check to make sure it
		  is squished to fit - wasn't coping if entire list was > body Height
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/03/18
ADD VERSION DEFINES TO ALL OOFILE PACKAGES

FILE	oofrep.h
- add OOFVERS_REP


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/08
MERGE XML REPORTING WITH MAIN CODE BODY

CLASS	oofAdorner
Method	makeRender(const oofRepXMLEnv&)
		- added


FILE	oofadorn.h
- add forward decl oofRepXMLEnv


FILE	oofrep.h
- added #include "oofsize.h"
- added #include "oofidmk.h"
- add forward decl oofRepXMLEnv


FILE	oofrpXML.cpp, .h
- added to 'reports' dir


FILE	oofadXML.cpp, .h
- added to 'utils' dir


CLASS	oofRep
- enum reportStateT added lots of states
- mClosedState, mDrawNestedTables added

Method	state
		- added setter/getter

Method	drawNestedTables
		- added setter/getter

Method	drawPageHeaders, drawFirstPageHeaders
		- set mState = eInPageHeader
		- set mClosedState = eLeftHeader at end

Method	drawPageFooters, drawFirstPageFooters
		- set mState = eInPageFooter
		- set mClosedState = eLeftFooter at end

			
				
CLASS	oofRepTextStyle
- mAlignment, mCssStyleID added

Method	ctor
		- added colAlign param
		
Method	ctor(fontName, fontSize, colAlign,...)
		- added so have quicker way to enter alignment
		
Method	ctor(CSSID)
		- added stub to load from a CSS string
		

CLASS	oofRepDrawable
Method	makeRender(oofRepXMLEnv)
		- added

		
CLASS	oofRepSpaceBand												
Method	makeRender(oofRepXMLEnv)
		- added
		
		
CLASS	oofRepGraphBand												
Method	makeRender(oofRepXMLEnv)
		- added
		
		
CLASS	oofRepLineBand												
Method	makeRender(oofRepXMLEnv)
		- added
		
		
CLASS	oofRepLayoutBand												
Method	makeRender(oofRepXMLEnv)
		- added
		
		
CLASS	oofRepViewBand												
Method	makeRender(oofRepXMLEnv)
		- added
		
		
CLASS	oofRepTextBlock											
Method	makeRender(oofRepXMLEnv)
		- added
		
		
CLASS	oofRepPictBlock										
Method	makeRender(oofRepXMLEnv)
		- added
		
		
CLASS	oofRepPictBand												
Method	makeRender(oofRepXMLEnv)
		- added


FILE	oofrep2.cpp
- added #include <UDesktop.h>


FILE	oofRepPPWindow.cpp
- added #include "oofrpXML.h"


CLASS	oofRepWindow
Method	ListenToMessage
		- moved Rick's crap inline code for SavE out to DoSaveAs
		
Method	DoSaveAs
		- added with code prev in ListenToMessage
		- XML target added		
		
FUNC	RepSaveDlgHook
		- insert case 2 XML		
		
RSRC	popup MENU for DLOG 601
		- insert case 2 XML
		- rename 'Hypertext' as 'Web page'
		

FILE	oofXMLP.cpp, .h
- files added and renamed oofriXML.* to reflect input of report via XML
  (considered oofrbXML for "build" but sounds too much like oofrpXML
   and oofroXML for "open" looks too similar)
   

CLASS	oofRepState
- renamed to OOF_XMLrepParserState to reflect internal use
- copied from oofrpst.h and .cpp to oofriXML.* files


CLASS	xmlRepParser
- renamed OOF_XMLrepParser to reflect internal use

Method	doSpaceBand
		- renamed to BuildSpaceBand
		
Method	doCloseTable
		- renamed to CloseTable
		
Method	doLineBand
		- renamed to BuildLineBand

Method	doFinnishLayout
		- renamed to FinishLayout


FILE	oofrpst.h
- moved kBlah constants to oofriXML.cpp and made enums eBlah


CLASS	oofSettings2css
- renamed to oofGraphSettings2CSS
- moved to oofrpXML.h, cpp


CLASS	oofRepStyle2css
- renamed to oofRepTextStyle2CSS
- moved to oofrpXML.h, cpp
						

FILE	 oofcss.h
- moved #define kCSSIndenting to a const char* in oofrpXML.cpp						


CLASS	oofCSSTxt2Style
- renamed to oofCSS2RepTextStyle
- moved to oofriXML.h, cpp


CLASS	oofCSSTxt2Settings
- renamed to oofCSS2GraphSettings
- moved to oofriXML.h, cpp


FILE	oofIdmk.*
- renamed to oofidfct.* and copied to 'core'


CLASS	oofIDMaker
- renamed to oofIDfactory


CLASS	oofTagMaker
- renamed to OOF_tagMaker
- moved to oofrpXML.cpp



GENERIC REPLACE
replace CssStyle in any case with CSSstyle as it is more readable


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/09
DEBUG XML REPORTING & CLEANUP SOURCE

CLASS	OOF_XMLrepParser
- mCurrentTable renamed mTablesStack
- mBuildState made pointer
- mOldStyle removed

Method	ctor
		- create mBuildState
		
Method	dtor
		- added to delete mBuildState

Method	startElement
		- removed unused cases 'br' and 'report'
		- expect 'space' for space band, not 'SpaceBand'

Method	endElement
		- when finish footers other than first page, call clearInFooter
		  not clearInHeader
		- 'br' changed to 'BR'
		- check mLastBlock before assuming can call moveDownAfter for 'BR'
		- removed unused 'spaceband' case
		  
Method	BuildSpaceBand
		- moved cases for appending to AppendBandDependingOnState
		
Method	FinishLayout
		- use AppendBandDependingOnState

Method	 BuildLineBand
		- use AppendBandDependingOnState		

Method	AppendBandDependingOnState
		- added common method as same rules apply for appending other bands
		  to headers or footers regardless of type
		  

CLASS	oofCSS2RepTextStyle
Method	findAlignment		  
		- changed 'index' from int to unsigned long so accumulate
		  reliably on all platforms. 
		- renamed 'index' to hashedIndex
		- remove lots of direct returns from inside case
	
		
CLASS	oofRepXMLEnv
Method	preprocessesPageHeadersAndFooters		
		- return true


Method	startEnvironment
		- append '\n' instead of "\n" to XMLLayout
		- use direct mOut<< for initial report tag output rather than
		  insert in front of mXMLLayout as it is NOT part of layout
		- call oofRep::drawFirstPageHeaders, footers etc. to make sure they
		  are processed (later will process in finishConstruction when we add
		  data processing)
		
Method	endEnvironment
		- use direct mOut << more than appends to mXMLLayout as easier
		  to see whats being written and no point appending just to write
		  out a few lines later
		  

CLASS	oofRep
- enum eBeforeReport renamed to eNotInDrawable to reflect its use to indicate
  either outside report or between drawing objects such as pageHeaders and body
  
Method	closedState()
		- change return type from pointer to reference
		
		
CLASS	OOF_repState2XMLelement
Method	whereAmI
		- change closedState param type from pointer to reference,
		  to avoid derefs all through body
		- renamed param from closedAState to ioClosedState to follow
		  convention for output params
		- renamed theResult to outTag to be clearer what it does
		

CLASS	oofIDfactory
- mNumberLevels removed as not used

Method	ctor
		- moved some inits out of body into init list
		- change mLevels init cells & expansion from 4,4 to 100, 1000
		
Method	enterLevel, incrementID
- made inline	


CLASS	oofRepLayoutBand_XMLRender
Method	draw
		- append '\n' instead of "\n" to XMLLayout
		- append a <BR> line to layout if block.moveDownAfter()


CLASS	oofRepViewBand_XMLRender
Method	draw
		- append '\n' instead of "\n" to XMLLayout

Method	startTableWrapper		
		- append '\n' instead of "\n" to XMLLayout
		

CLASS	oofRepLineBand_XMLRender
Method	draw
		- append \n


CLASS	oofRepTextBlock_XMLRender
Method	draw
		- don't pass indent string to closing tag
		- don't surround content with single space
		- remove call to mkBreakTag, now handled for all block types in Layout render
		
		
CLASS	OOF_tagMaker
- mScrapString removed
- made all methods static

Method	mkLineTag
		- don't output ID
		- use local scrapString

Method	mkSpaceTag
		- don't output ID
		- output 'space' not 'SpaceBand'
		- use local scrapString
		- made const
		
Method	mkBreakTag
		- output 'BR' not 'br'

Method	mkOpenGraphTag
		- use local scrapString
		- made const
		

FILE	oofrixml.h
- add #include "oofGeos.h"


FILE	oofrixml.cpp
- add #include "oofSting.h"


CLASS	oofRepTextStyle2CSS
- mScrapString removed, just use local


CLASS	oofGraphSettings2CSS
- mScrapString removed, just use local

Method	makePosStateString
		- renamed MakePosStateString because it's private

Method	emitCSSstyle
		- made const
		- take const oofGraphSettings* param instead of oofGraphSettings&

				
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/09
COPE WITH DIFFERENT TABLE RENDERING AND NEED TO WRAP HEADERS/FOOTERS 

CLASS	oofRepViewBand_Render
Method	startTable, endTable
		- renamed as startTableBody, endTableBody
		  
Method	startTableWrapper, endTableWrapper
		- added empty base methods for overriding
		  
		  
CLASS	oofRepViewBand_MacRender, 
		oofRepViewBand_RTFRender
		oofRepViewBand_CSVRender
		oofRepViewBand_TSVRender
		oofRepViewBand_HTMLRender
Method	startTable, endTable
		- renamed as startTableBody, endTableBody

		
CLASS	oofRepViewBand_XMLRender, 
Method	startTable, endTable
		- renamed as startTableWrapper, endTableWrapper


CLASS	oofRep
- mDrawNestedTables removed

Method	drawNestedTables
		- removed both accessors
		
Method	DrawViewBand
		- invoke the new wrapper methods		
		
		
CLASS	oofRepViewBand
Method	startTableWrapper, endTableWrapper
		- added to dispatch to renderer
		
		
CLASS	oofRepXMLEnv
Method	startEnvironment, endEnvironment
		- don't call oofRep::drawNestedTables
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/11
DON'T PUT SPACES AROUND ATTRIBUTE = 

Remove spaces around = sign when writing attributes such as height, ID
- oofRepGraphBand_XMLRender::draw
- OOF_tagMaker::makeOpeningTag
- OOF_tagMaker::mkOpenGraphTag
- OOF_tagMaker::mkOpenTableTag
- OOF_tagMaker::mkSpaceTag
- OOF_tagMaker::mkLineTag
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/11
MINOR DEBUGGING - COMPLEX REPORT LAYOUT & CONSISTENCY
		
CLASS	OOF_tagMaker
Method	mkOpenGraphTag, mkOpenTableTag
		- rename Source attribute to source
		
Method	mkCloseGraphTag
		- output 'graph' not 'graphBand'
		- use oofString ctor(oofString&, const char*) to directly return type

Method	makeOpeningTag
		- only include ID= if pass in ID string with some content
		
Method	mkCloseTableTag, mkBreakTag
		- use oofString ctor(oofString&, const char*) to directly return type


CLASS	oofRep
Method	drawFirstPageHeaders
		drawPageHeaders
		drawFirstPageFooters
		drawPageFooters
		- only do state transition and call drawBandList if anything in band


CLASS	oofRepLayoutBand_XMLRender
Method	draw		
		- emit CSS style string for layout band


CLASS	oofRepTextStyle2CSS
Method	ctor
		- removed 
		
Method	emitCSSstyle		
		- change param to const oofRepTextStyle& as no need for non-const


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/11
AVOID EXTRA CSS STYLES AND ID ATTRIBUTES FOR INLINES

CLASS	oofRepLayoutBand_XMLRender
Method	draw		
		- emit CSS style string for layout band
		- remove output of CSS styles for blocks - they decide themselves
		

CLASS	oofRepTextBlock_XMLRender
Method	draw
		- decide if will output ID and CSS style based on different style
		  from current layout


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/11
MOVE XML REPORT LAYOUT & CSS PARSING OUT OF DRAW

CLASS	oofRep
Method	draw
		- move the startEnvironment just before drawing code
		- move the finishConstruction before makeRender calls
		- add environment::makeRender call
		- set the state variable around making renderers
		- only make renderers for headers etc. if have any
		

CLASS	oofRepViewBand
Method	makeRender(oofRepXMLenv&)
		- don't call finishConstruction
		- call finishViewRender
		- don't make renderers for breaks (yet)
		- 
		

CLASS	oofRepLayoutBand		
Method	makeRender(oofRepXMLenv&)
		- call finishViewRender
		
		
Move draw() code into end of ctor for classes:		
- oofRepTextBlock_XMLRender		
- oofRepGraphBand_XMLRender
- oofRepSpaceBand_XMLRender
- oofRepLineBand_XMLRender


CLASS	oofRepViewBand_XMLRender
Method	startTableWrapper
		- moved into end of ctor
		
Method	endTableWrapper
		- renamed finishViewRender	
			
		
			
CLASS	oofRepBand
Method	finishConstruction
		- removed empty method
		
		
CLASS	oofRepDrawable
Method	finishConstruction
		- added empty method


CLASS	oofRepRender
Method	finishConstruction
		- added empty virtual
				
						
move call to adorners().makeRender() until after main render created in
- oofRepViewBand::makeRender(const oofRepXMLEnv& env) 
- oofRepSpaceBand::makeRender(const oofRepXMLEnv& env) 
- oofRepGraphBand::makeRender(const oofRepXMLEnv& env) 
- oofRepLineBand::makeRender(const oofRepXMLEnv& env) 
- oofRepPictBand::makeRender(const oofRepXMLEnv& env) 
- oofRepTextBlock::makeRender(const oofRepXMLEnv& env) 
- oofRepPictBlock::makeRender(const oofRepXMLEnv& env) 




CLASS	oofRepXMLEnv
Method	startEnvironment
		- moved output of <report> and pi to endEnvironment
		- removed draw() calls used to add pageHeader/footer layouts & styles
		- moved other setup to makeRender
		
Method	makeRender
		- added to setup before processing in makeRender for layout + CSS
		
		
CLASS	oofRepEnvironment
Method	makeRender
		- added empty virtual				


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/12,14
CUSTOM DRAWING FOR VIEW COLUMNS

CLASS	oofRepViewBand_MacRender
Method	draw
		- call calculateWrapping on custom Draw
		- calc DrawHeight allowing for custom draw height
		- pass hasCustomDrawers flag to drawOverRun
		
Method	drawOverRun
		- takes hasCustomDrawers flag
		- uses custom drawers if available and adjusts height to 
		  suit them as well as row-based drawing alongside
		  		
		
CLASS	oofRepViewBand
- mCustomDrawers added

Method	customDrawer
		- added accessors
		- 990414 debug - change > to >= comparison of col>=count()
				
		
CLASS	oofRepCustomViewDrawer
- base added				


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/15
FIX BUG IN MAC OS 8.5 - LINEFEEDS BEING DRAWN AT ENDS OF WRAPPED TEXT

CLASS	oofRepViewBand_MacRender
Method	draw
Method	drawOverRun
		- before drawing, loop to truncate draw length avoiding any trailing
		  LF or CR characters which previously didn't draw.
		  
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

99/04/20

COMPILE UNDER VC5



CLASS	oofRepViewBand_WinRender

Method	draw, drawOverRun

		- add chars() calls to end of sizedBody.text(i)

		  to avoid ambiguities





FILE	oofrpxml.h

- add forward decl of oofIDfactory

  (was coming from precompiled header on Mac)





FILE	oofrpxml.cpp

- remove includes that use old iostreams (.h style headers)

	- #include <stdio.h>

	- #include <iostream.h>

	- #include <fstream.h>



put oofString:: in front of static call to quoteString and 

encodeEntity (I can't understand why CodeWarrior compiles this!)

- oofRepViewBand_XMLRender::drawColumnHeaders

- OOF_tagMaker::mkOpenTableTag

- OOF_tagMaker::mkOpenGraphTag

- oofRepTextBlock_XMLRender::oofRepTextBlock_XMLRender







PROJ	OOFRpLib

- add files oofadXML.cpp, oofrpXML.cpp



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/21
CUSTOM DRAWING FOR VIEW COLUMNS IN MFC

CLASS	oofRepViewBand_WinRender
Method	draw
		- call calculateWrapping on custom Draw
		- calc DrawHeight allowing for custom draw height
		- pass hasCustomDrawers flag to drawOverRun
		- call oofRepCustomViewDrawer::makeDrawDE
		
Method	drawOverRun
		- takes hasCustomDrawers flag
		- uses custom drawers if available and adjusts height to 
		  suit them as well as row-based drawing alongside
		- call oofRepCustomViewDrawer::makeDrawDE
		
		  		
CLASS	oofRepCustomViewDrawer
Method	makeDrawDE
		- added pure virtual factory
		

CLASS	oofRepWinGUIPreviewMFC
Method	changeTextStyle
			- only append another element if constructing a page, so this method
			  can now be called during replay (probably by some user code)
			  
			  
CLASS	oofDE
- moved it and subclass definitions from oofdraw.h into oofrep.h
 as it is solely used for report drawing and shouldn't be in the generic file

Method	appendElement
		- added

use oofDE::appendElement in:
- oofGraphDE::recordElement
- oofWinLineDE::recordElement
- oofWinPictDE::recordElement
- oofWinRectDE::recordElement
- oofWinShadeDE::recordElement
- oofWinTextDE::recordElement
- oofWinTextStyleDE::recordElement


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/26-27
XML DATA OUTPUT WHEN SAVING REPORTS

CLASS	oofRepViewBand_XMLRender
Method	startTableWrapper
		endTableWrapper
		- added to output table name open and close tags
		
Method	draw
		- draw one record's fields		

Method	drawColumnHeaders
		- commented out body of function as we don't use it yet
		  (and probably never will - col headers being specified in layout)		
		
CLASS	oofIDfactory
Method	makeOpeningTag, makeClosingTag
		- remove decls of unimplemented methods
		
Method	getIDString
		- renamed to getIDstring to match case standards		
		
Method	getQuotedIDString
		- renamed to getQuotedIDstring to match case standards		

Method	IncrementID
		- renamed to incrementID to match public/private standards
				

CLASS	OOF_tagMaker
change all methods to the following form:
- all string params as const char*, not concrete oofString
- indentString precedes ID string and is optional=0
- ID string is optional=0

change order of params to makeOpeningTag
- oofRepXMLEnv::makeRender
- oofRepLayoutBand_XMLRender::oofRepLayoutBand_XMLRender(oofRepLayoutBand* b)				
- oofRepTextBlock_XMLRender::oofRepTextBlock_XMLRender(oofRepTextBlock* b) 
- oofRepXMLEnv::startEnvironment

don't pass in null indent string to makeClosingTag:
- oofRepTextBlock_XMLRender::oofRepTextBlock_XMLRender(oofRepTextBlock* b)

change order of params to mkOpenTableTag
- oofRepViewBand_XMLRender::oofRepViewBand_XMLRender(oofRepViewBand* b)

change order of params to mkLineTag
- oofRepLineBand_XMLRender::oofRepLineBand_XMLRender(oofRepLineBand* b) : 


change order of params to mkSpaceTag
- oofRepSpaceBand_XMLRender::oofRepSpaceBand_XMLRender(oofRepSpaceBand* b)

change order of params to mkOpenGraphTag
- oofRepGraphBand_XMLRender::oofRepGraphBand_XMLRender(oofRepGraphBand* b)


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/28
CLEANUP PRAGMAS AND VC5 COMPILE

remove MWERKS unused pragmas and just remove param name in:
- oofRepCSVEnv::changeTextStyle
- oofRepCSVEnv::heightOfTextStyle
- oofRepTSVEnv::changeTextStyle
- oofRepTSVEnv::heightOfTextStyle
- oofRepRTFEnv::changeTextStyle
- oofRepRTFEnv::heightOfTextStyle
- oofRepHTMLEnv::changeTextStyle
- oofRepHTMLEnv::heightOfTextStyle


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/28
FIX CRASH WHEN PRINT IN WINDOWS

CLASS	oofTextDrawer
Method	selectFont
		- remove assertion that sFont==prevIC or prevDCfont
		  (don't know why this is occurring, but it appears they get
		  changed behind the scenes, maybe by the print dialog)


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/28
FIX VERY MINOR MEMORY LEAKS

CLASS	oofRepData
Method	useRepContext
		- delete the old mSavedSelection
		

CLASS	oofRepWindow
Method	AdjustScrollSize
		- release the temp DC
				

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/04/28
ENABLE SAVE AS XML UNDER WINDOWS

CLASS	oofRepWindow
Method	OnReportSave
		- add case for XML
		

FILE	oofRepMFC.cpp
- add #include oofrpXML.h


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/02
SIMPLIFY USE OF MULTI REPORTS CONTAINING SINGLE REPORT

CLASS	oofRepWindow
Method	CreateWindow (in oofRepPPWindow.cpp)
		- check if adopted report is multi-report and replace with base
		  class if so.
		  
		  
CLASS	oofRepWindow
Method	CreateReportWindow (in oofRepMFC.cpp)
		- check if adopted report is multi-report and replace with base
		  class if so, for main report and optional landscape version


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/03
FINISH XML OUTPUT OF REPORTS & DATA

Write \r\n instead of endl so expat can parse XML files we produce, in:
- oofRepXMLEnv::startEnvironment
- oofRepXMLEnv::endEnvironment


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/04
MINOR BUGS IN REPORTS

CLASS	oofRepSettings
Method	ctor(oofRepSettings*)
		- add init for mBorderType(0), mBandIndenting(0)
		- in body, copy-paste error calling functions for the above

Method	copy ctor
		- added to just copy pointers and inc ref count.


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/04-05
WRITE DATABASE SCHEMA AND CRLF TERMINATION ON FILES
		
CLASS	oofRepXMLEnv
- mSchema added

Method	ctor
		- pass true up to parent oofRepStreamEnv so opens file
		  in binary mode and preserves \r\n on Mac

Method	getSchemaString
		- added getter

Method	startEnvironment
		- write mSchema and close <Schema> tag		
		

CLASS	oofTagMaker
Method	makeOpeningTag
		- added optional param emptyTag and output closure of empty tag
		  if it's set
		  

CLASS	oofRepViewBand_XMLRender
Method	startTableWrapper
		- don't create mWriter
		
Method	ctor
		- create mWriter & call startSchema on it		
		
Method	finishViewRender		  
		- close the schema


CLASS	oofXMLwriter
Method	ctor
		- only create record tags if defined OOF_WRITE_XML_RECORD_TAGS

Method	writeRecord		
		- only write record tags if defined OOF_WRITE_XML_RECORD_TAGS

Method	schemaHeader
		- added to write preamble to <Schema>

Method	startSchema
		- added to write start of an ElementType and fields within

Method	endSchema
		- added to write close of ElementType
		
Method	dataType2Attributes
		- added static to return string like dt:dt="int"
		
		
FILE	oofrpXML.cpp
- add test of __option(mpwc_newline) to ensure correct compile options		
- general replace of \n with \r\n


CLASS	oofRepStreamEnv
Method	ctor(const char*)
		- added 2nd param bool openBinary=false
		- if openBinary, open file with ios::binary mode
		

CLASS	oofRepWindow
Method	DoSaveAs
		- open output file in ios::binary mode for XML output
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/04-08
OPENING REPORTS IN PREVIEW WINDOW & READING FROM XML

CLASS	oofRepWindow
- mOpenedReportDB added

Method	ctor
		- init mOpenedReportDB(0)
		
Method	dtor
		- delete mOpenedReportDB
				
Method	ObeyCommand
		- added cases for cmd_Open calling DoOpen
		- added case for cmd_SaveAs calling DoSaveAs (currently triggered from button)

Method	FindCommandStatus
		- added cases for cmd_Open  (conditional on OOF_READ_REPORTS) and cmd_SaveAs

Method	DoOpen
		- added to open file and parse report
		
Method	ReflowReport
		- added to reflow report after page setup, opening or editing
		
Method	DoPageSetup
		- moved logic for recreating pages and redrawing report into ReflowReport
					
					
FILE	oofRepPPWindow.cpp
- added #include <UClassicDialogs.h>
- added optional #include "oofriXML.h"


CLASS	OOF_XMLrepParser
- mTheCurrentReport removed
- mMultiRep added

Method	parseFile
		- added to call parser
		
Method	getTheReport
		- renamed orphanReport
		- set mReport to 0		
		
Method	ctor
		- init mReport(0)
		- init mDepth(0)
		
Method	dtor
		- add assert(mReport==0)
		
Method	startElement
		- add case for <report> that creates oofRep or oofRepMulti
		- add case for <section> that creates oofRepSection								
		- inc mDepth

Method	endElement
		- add case for <report> that closes oofRep or oofRepMulti
		- add case for <section> that appends section to multi report
		- dec mDepth

Method	charData										
		- handle CR, LR or CRLF lines


CLASS	OOF_XMLrepParserState
Method	clearInGrapgBand		
		- renamed to clearInGraphBand
		

FILE	oofriXML.cpp
- enum xmlRepParseStateT
		- redefined using hex constants to make non-overlapping bits clearer
		- renamed eInLayout to eInLayoutBand
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/06
PROG CONTROL OVER XML SAVED DOC NAME

CLASS	oofRepXMLsettings
- added to provide user overrideable policy on naming, temp database etc.


CLASS	oofRepWindow
Method	DoSaveAs
		- use oofRepXMLsettings to make the XML environment, name file etc.
		- move the XML choice up to top
		- remove stupid behaviour that ignored user-entered suffix
		  in favour of that from the popup menu so if user types blah.rtf
		  it will preserve the type, rather than writing XML into the file
		  and therefore matching the Windows behaviour!		

Method	DoOpen
		- use oofRepXMLsettings::saveReportDocMacFileType()


CLASS	oofRepSettings
- mXMLsettings added

Method	XMLsettings
		- added getter, setter
		
Method	ctor
		- init mXMLsettings(0)
		
Method	dtor
		- delete mXMLsettings
		
Method	ctor(oofRepSettings*)
		- clone rhs settings
		

CLASS	oofRepDefaultSettings
Method	ctor
		- make a oofRepXMLsettings object for XMLsettings
												
												
FILE	oofRepPPWindow.cpp
FUNC	RepSaveDlgHook
		- use XMLsettings to find the XML file suffix
		- assume the topmost is the XML, moving RTF to 2nd place
		
		
FILE	oofRepWindow.ppob
MENU	601		
		- swap the RTF and XML top 2 items
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/09
PROG CONTROL OVER XML SAVED DOC NAME IN WINDOWS

CLASS	oofRepWindow
Method	OnReportSave
		- use oofRepXMLsettings to make the XML environment, name file etc.
		- move the XML choice up to top
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/09
OPENING REPORTS IN MFC PREVIEW WINDOW & READING FROM XML
					
FILE	oofRepMFC.cpp
- added optional #include "oofriXML.h"

CLASS	oofRepWindow
- add message map entry ID_FILE_SAVE_AS linking to OnReportSave
- add optional message map entry ID_FILE_OPEN linking to OnFileOpen

Method	OnFileOpen
		- added conditionally
		
Method	ReflowReport		
		- added to reflow report after page setup, opening or editing
		
Method	OnFilePageSetup
		- moved logic for recreating pages and redrawing report into ReflowReport


CLASS	oofRepWinGUIPreviewMFC
Method	setPageSetup
		- remove mPages.deleteAll (into ReflowReport)
		
				- move the XML choice up to top
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/09
READING IN REPORTS - REFACTOR PARSER INTO NESTED PARSERS

CLASS	OOF_XMLrepLayoutParser
- created with most methods and logic from original OOF_XMLrepParser
  as subclass of expatppNesting
  
  
CLASS	OOF_XMLrepStyleParser
- created subclass of expatppNesting just to grab style charData (for now)
  
  
CLASS	OOF_XMLrepParser
Method	startElement
		- create OOF_XMLrepLayoutParser for <layout> tag
		- create OOF_XMLrepStyleParser for <style> tag
  

CLASS	OOF_XMLrepParserState
- changed to friend of OOF_XMLrepLayoutParser

Methods	clear/setInStyle, clear/setInStyleRule
		- removed 
		
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/10
COPE WITH CUSTOM CONTENT, LIKE RTF, IN OTHER RENDERERS

CLASS	oofRepCustomViewDrawer
Method	plainText
		- added virtual default imp that just copies the field content
		

CLASS	oofRepViewBand_HTMLRender
CLASS	oofRepViewBand_TSVRender
CLASS	oofRepViewBand_CSVRender
Method	draw		
		- use oofRepCustomViewDrawer::plainText to convert content
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/10
IMPROVE HTML RENDERING

CLASS	oofRepViewBand_HTMLRender
Method	drawColumnHeaders	
		- call calculateWidths to get percentages divided up for cols	
		
Method	draw
		- output the calculated width, not always 50%
		- use the colSizer to get alignment and write alignment tags in 
		the TR table definition
		- indent the table tags

Method	startTableBody
		- if indentLeve>0 wrap the table in a <TR>
		- indent the table tags

Method	endTableBody
		- don't write the <p tag we left half-written
		- if indentLeve>0 wrap the table in a <TR>
		- indent the table tags
				

CLASS	oofRepHTMLEnv
Method	startEnvironment
		- write the DOCTYPE SGML header
		- put newlines between header tags to make more readable
		

CLASS	oofRep
Method	nestedIndentLevel
		- added inline getter for mNestedIndentLevel		
		
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/11
DEBUGGING READING AND WRITING XML REPORTS

CLASS	oofRepWindow
Method	DoOpen
		- display alert if parseFile failed
		
Method	ReflowReport
		- don't delete mPICTS, just deleteAll()		


CLASS	OOF_XMLrepParser
- mDB added

Method	ctor(both)
		- init mDB(0)
		
Method	startElement		
		- create oofXMLschemaParser or oofXMLdataParser as appropriate
		- create dbConnect in mDB
		

CLASS	OOF_XMLrepLayoutParser
- mCurrentDbTableName removed

Method	dtor
		- make assertion check if XML returned error code as we may be returning
		  early so our other checks for completeness shouldn't be applied

Method	CloseTable
		- delete the top level band from the stack - it was being left on 
		  the stack and so deleted there!
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/11
CONNECTING VIEW BANDS TO DATABASE

CLASS	OOF_XMLrepLayoutParser
- mDB added

Method	ctor
		- pass in the dbConnect as a 2nd param
		
Method	startElement
		- when we create dbView for table, lookup database table in currentlyConstructing
		dbconnection.
		
		
CLASS	OOF_XMLrepParser
Method	endElement
		- moved the database creation here for </schema>

		
Method	startElement
		- pass mDB into the OOF_XMLrepLayoutParsers				
		
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/11
FIX DRAWING NESTED TABLES TO XML

CLASS	oofRepViewBand_XMLRender
Method	endTableWrapper
		- don't delete mWriter - we may draw another table if nested
		
Method	dtor
		- added to delete mWriter

Method	copy ctor
		- added private to emphasise we can't be copied
		  (this is a precaution when you have a pointer member, to avoid double refs)
		  		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/12
PARSING NESTED TABLES

CLASS	OOF_XMLrepLayoutParser
Method	CloseTable
		- don't assert if level>1 and not in header or footer as nested 
		  table can be attached in a break

		  
enum	xmlRepParseStateT
- eInHeaderBreak, eInFooterBreak added		

class OOF_XMLrepParserState
removed decls of undefined methods
- set(unsigned int);
- setIn();
- clearIn();
- setIndbRecord();	
- setInschema();
- setIndbstring();
- setIndbdate();	
- clearIndbRecord();
- clearInschema();
- clearIndbstring();
- clearIndbdate();

removed unused methods
- setInGraphBand();
- clearInGraphBand();
- setInViewBand();
- clearInViewBand();
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/13
HANDLE BREAKS

CLASS	oofRepViewBand
Method	makeRender(const oofRepXMLEnv&)
		- wrap header & footer breaks in header/footer state changes
		- output <breaks> around the header and footer breaks
		
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/14
FIX GRAPH WRITING & READING WITH XML

CLASS	oofRepGraphBand_XMLRender
Method	ctor
		- write out band height as well as graph height
		- remove extra '/>\r\n' at end of attrib string
		- write schema for graph's view
		

CLASS	OOF_XMLrepLayoutParser
Method	BuildGraphBand
		- added

Method	startElement
		- call BuildGraphBand


FILE	oofriXML.cpp
- added #include "oofGrphs.h"



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/14
DEBUG REPORT OUTPUT & READING

CLASS	oofXMLwriter
Method	fieldtype2Attributes
		- use fieldType() not nativeType() so dbText not seen as charField
		- and dateTime fields distinguished
		- write 'date', 'time' and 'dateTime' instead of ui4 and ui2, so we
		  can recreate schemae for dbDate, dbTime and dbDateTime
		  
Method	schemaHeader
		- add dataType defs for 'date', 'dateTime' and 'time'
		
		
CLASS	oofXMLschemaParser
Method	endElement
		- add cases for dbDate, dbTime and dbDateTime 

Method	attributes2fieldtype		
		- parse 'date', 'time' and 'dateTime' 


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/14
UNDO WORK TO OUTPUT \r\n SO FILES ARE AGAIN TEXT FILES
(under mistaken assumption it was necessary to make expat work)

CLASS	oofRepWindow
Method	DoSaveAs
		- create ofstream with default type, not binary
		
FILE	oofxml.cpp
- replace \r\n with \n
		
		
FILE	oofrpXML.cpp
- replace \r\n with \n
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/16
STATE TRANSITIONS IN MULTIPLE AND COMPLEX REPORTS -> VISITORS

CLASS	oofRepVisitor
- added with pure virtual visitBand to override


CLASS	OOF_repMakeRenderVisitor
- added to call oofRepEnv::makeRenderDispatch on each band


CLASS	OOF_repFinishConstructionVisitor
- added to call oofRepEnv::finishConstruction on each band


CLASS	oofRepSchemaVisitor
		- added base that defines pure virtual VisitView
		

CLASS	oofRepBand
Method	view
		- added default virtual returing 0

Method	isLayoutBand
		- added default virtual returning false


CLASS	oofRepLayoutBand
Method	isLayoutBand
		- added override returning true

Method	makeRender(all)
		- remove calls to mBlocks.makeRender


CLASS	oofRepViewBand
Method	finishConstruction
		- removed

Method	makeRender(all )		
		- Don't call function on headers, footers, breaks etc.,
		  leaving that to the visitor
		  
Method	view
		- made virtual, returning dbView* and non-inline		  


CLASS	oofRepGraphBand
Method	view
		- added to directly return graph's view
		

CLASS	oofRep
- enum reportStateT removed
- mState, mClosedState removed

Method	state, closedState
		- removed setter/getter pairs
		
Method	draw
		- use OOF_repMakeRenderVisitor & OOF_repFinishConstructionVisitor

Method	DrawViewBand
		- don't set state variables as we go into headers etc.

Method	BecomeCurrent
		- made public, renamed becomeCurrent (so can call from visitors)


CLASS	oofRepSection
Method	makeRender
		- removed

Method	finishConstruction
		- removed
				

CLASS	oofRepMulti
Method	draw
		- use OOF_repMakeRenderVisitor & OOF_repFinishConstructionVisitor
		- add call to inEnv.makeRender()


CLASS	oofAdornerList
		oofRepBlockList
		oofRepBandList
		oofRepBreakList
Method	makeRender
		- removed


CLASS	oofRepBandList
Method	finishConstruction
		- don't call finishConstruction on bands in list (visitor does that)


CLASS	oofRepBreakList
Method	finishConstruction
		- removed

remove call to adorners().makeRender(env) from all environments:
- oofRep*Band::makeRender


	
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/16-17
USE VISITOR FOR XML SCHEMA, LAYOUT AND STYLE GENERATION

CLASS	OOF_repState2XMLelement
- removed		


CLASS	OOF_XMLlayoutVisitor
- added


CLASS	OOF_XMLschemaVisitor
- added


CLASS	oofRepXMLenv
- mRepPosition removed

Method	getRepPosition
		- removed
		

CLASS	oofRepRender
Method	describeLayout()
		- added empty virtual default
		
CLASS	OOF_repSchemaVisitor
- added to provide abstract base for visiting all schemae now and in future


CLASS	oofRepViewBand_XMLRender
Method	finishViewRender
		- removed


CLASS	oofRepViewBand
Method	makeRender(const oofRepXMLEnv		
		- remove call to finishViewRender
		
		
CLASS	oofRepLayoutBand
Method	makeRender(const oofRepXMLEnv& env) 
		- remove call to finishLayoutRender


CLASS	oofRepTextStyle2CSS
- make all methods static
- mFontSize, mLeading, mStyle & mLineHeight removed as they are used
  only as local variables


CLASS	oofRepXMLEnv
- mCSSstyles, mSchema, mXMLLayout & mCSSstyleP removed
- mSectionNumber added

Method	getSchemaString
		getCSSstylesString
		getXMLLayOutString
		getCSSstyleParser
		ctor()
		- removed

Method	ctor(const char*)
		- don't pass true to oofRepStreamEnv
				
Method	makeRender
		- removed (output moved to startEnvironment)

Method	startSection
		- added to close <section> and call StartReport
		
Method	StartReport
		- added to write style and layout elements for a report
		  or oofRepSection				


CLASS	oofRepEnvironment
Method	startSection
		- added default empty virtual
		
		
CLASS	oofRepSection
Method	drawSection
		- call oofRepEnvironment::startSection before drawSectionBreak
				

CLASS	oofRepDrawable
- mID added

Method	ID
		- added setter/getter for mID

Method	describeLayout
		- added forwarder to mRender
				
		
CLASS	oofRepMulti
Method	draw
		- call becomeCurrent() before start/endEnvironment()



CLASS	oofRepViewBand_XMLRender
Method	ctor
		- reduce to just creating mWriter 
		  (moving layout stuff to OOF_XMLlayoutVisitor::VisitViewBand)
		  
Method	endTableWrapper
		- remove calls to set report state
		

CLASS	oofRepLayoutBand_XMLRender
Method	ctor
		- reduce to just inline forwarder to parent ctor
		  (moved layout stuff to OOF_XMLlayoutVisitor::VisitLayoutBand)

Method	finishLayoutRender				  
		- removed
		  (moved layout stuff to OOF_XMLlayoutVisitor::VisitLayoutBand)

Method	draw
		- removed empty method		
		

CLASS	oofRepLineBand_XMLRender
Method	ctor
		- reduce to just inline forwarder to parent ctor
		- moved layout stuff to describeLayout

Method	draw
		- removed empty method		

Method	describeLayout
		- added
		

CLASS	oofRepSpaceBand_XMLRender
Method	ctor
		- reduce to just inline forwarder to parent ctor
		- moved layout stuff to describeLayout

Method	draw
		- removed empty method		


Method	describeLayout
		- added
		

CLASS	oofRepGraphBand_XMLRender
Method	ctor
		- reduce to just inline forwarder to parent ctor
		- moved layout stuff to describeLayout

Method	draw
		- removed empty method		

Method	describeLayout
		- added
		

CLASS	oofRepPictBand_XMLRender
Method	draw
		- removed empty method		
		

CLASS	oofRepPictBlock_XMLRender
Method	draw
		- removed empty method		
		

CLASS	oofRepGraphBand_XMLRender
Method	ctor
		- reduce to just inline forwarder to parent ctor
		- moved layout stuff to describeLayout

Method	draw
		- removed empty method		

Method	describeLayout
		- added

	
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/17
USE REPLACEABLE VIEW IN VIEW BAND

CLASS	oofRepViewBand
- mView changed from dbView to dbView*

Method	dtor
		- delete mView
		
Method	copy ctor
		- added to copy mView
		
Method	ctor(dbView*,...)
		- added to adopt a view 						
		
Method	ctor(dbView&,...
		- init mView by cloning incoming view
		- moved body to FinishConstruction
		
Method	FinishConstruction
		- added
		- iterate customDrawers, zeroing pointers
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/18
REPORT DEBUGGING

CLASS	oofXMLwriter
Method	writeRecord
		- write extra linefeed after record to make easier to read XML by eye


CLASS	OOF_repXMLstyleVisitor
- mSetThisIDanyway added

Method	VisitDrawable
		- set ID on drawable if mSetThisIDanyway
		
Method	VisitViewBandBody
		- overrode to set mSetThisIDanyway
		

CLASS	OOF_repXMLschemaVisitor
Method	VisitViewBandBody
		- added to avoid double-processing the view's dbView		
		
		
CLASS	oofRepData
Method	useRepContext
		- make sure mSavedRecNo is inside the range of record numbers in the 
		  selection - possible to have iterated off the end earlier!
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/18
REPORTS ABLE TO RERUN XML REPORTS (ie: save twice in a row)

CLASS	oofRepXMLEnv
Method	startEnvironment
		- call mIdentities.reset() so ID's follow same sequence
		

CLASS	oofRepDrawable
Method	ID(const oofString&)
		- enhance assert to cope with attempt to set same ID if already set
		
				  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/19
FIX WINDOWS BUG WITH CUSTOM VIEW DRAWERS STUFFING UP STYLES ON NEXT TEXT

CLASS	oofRepWinGUIPreviewMFC
Method	changeTextStyle
		- record the element even if the text style has NOT changed
		  as we can't tell in here if we are being called to guard against
		  a custom drawer. This optimisation is useful elsewhere but leaves
		  us vulnerable to non-OOFILE code changing the font state.

		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/18-21
REPORT PARSING DEBUGGING

CLASS	OOF_repXMLschemaVisitor
Method	VisitViewBand
		- copy oofRepVisitor method and keep the view headers & footers
		  outside the schema, so they are not nested as related tables
		  
Method	VisitViewBandBody
		- removed as don't need to hide any more		  
		
		
CLASS	oofRepViewBand_XMLRender
Method	startTableWrapper		
		- renamed startTableBody so will be invoked inside headers
		
Method	endTableWrapper		
		- renamed endTableBody so will be invoked inside footers
		
		
CLASS	OOF_XMLrepParserState
Method	saveOldState
		- don't set state = eInTable as that's a gross assumption 
		  about caller context and buggy anyway (wipes out footer
		  or header state)
		- add bool clearNew param=false
		- only clear state if param set

Method	set*, clear*
		- removed all set and clear specific setters
		
Method	set(unsigned int)
		clear(unsigned int)
		- added generic setters because their use is clear from the param

Method	restoreOldState
		- added asserts to guard against popping too many off
		
		
CLASS	OOF_XMLrepLayoutParser
- mCurrentBreakBand, mCurrentBreakNewPageEveryTime added

Method	startElement
		- order if statements according to frequency of use of elements
		- add footerBreak and headerBreak elements
		- add "break" clause
		- call BuildTable

Method	BuildTable
		- added to build tables nested	
		
Method	BuildGraphBand
		- call GetDatabaseInContext rather than assuming dbTable
		  is top-level table			
		
Method	GetDatabaseInContext
		- added to isolate logic to find a dbTable in main connection
		  or related depending on being in break

Method	endElement
		- add "break" clause calling BuildBreak

Method	AppendBandDependingOnState
		- added case for eInFooterBreak|eInHeaderBreak assigning the band to 
		  mCurrentBreakBand

Method	BuildBreak
		- added to construct a break for the current band	
		
Method	CloseTable
		- only call restoreOldState if >top level
		
Method	BuildLineBand
		BuildSpaceBand
		- cope with ID being there or not before 'height'
		- guard assumptions with assert		
					  

CLASS	OOF_repXMLlayoutVisitor
Method	VisitBreakList
		- output nested <break> tags 


FILE	oofriXML.cpp
- add #include "oofrel.h"		

		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/18-21
WRITE GRAPH SETTINGS

CLASS	oofGraphSettings2CSS
- made all methods static


CLASS	OOF_repXMLstyleVisitor
Method	VisitDrawable
		- added hack using dynamic_cast to write settings for graph bands
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/23
DELAYED LOADING OF STYLES & OTHER SETTINGS

CLASS	oofRepTextStyle
- mCSSstyleID removed

Method	ctor(oofString)
		- removed
		
Method	clone
		- made virtual
		
Method	dtor
		- added empty virtual

Method	Invariant
		- added
		
Method	ctor()
		- added protected only so subclass can default
		
Method	fontName, fontSize getters
		- assert(Invariant())										
	


CLASS	OOF_XMLrepParser
- mStyleString, mTextStyleCompleter, mGraphSettingsCompleter & mID added

Method	ctor
		- init 		mTextStyleCompleter, mGraphSettingsCompleter(0)
		
Method	startElement
		- pass mStyleString into the style parser
		- set mID from 1st attribute of <report> or <section>
		- create mTextStyleCompleter, mGraphSettingsCompleter in <layout>

Method	endElement
		- call FinishReport
		
Method	FinishReport
		- added to complete styles with mTextStyleCompleter & mGraphSettingsCompleter				
		
		
CLASS	OOF_XMLrepLayoutParser
- mCurrentStyle removed

Method	BuildGraphBand
		- set mCurrentCSSID from attributes
		- create a oofPromisedGraphSettings to restore graph settings
		
Method	BuildTable
		- create an oofPromisedRepTextStyle
		
Method	startElement
		- for <layout> set mCurrentCSSID & create an oofPromisedRepTextStyle
		- for <box> set mCurrentCSSID & create an oofPromisedRepTextStyle
		  (was unconditionally setting mCurrentCSSID which could be a bug
		   if no ID, then atts[1] could point anywhere!)
		
Method	charData
		- only set text style in block if CSS ID not empty
		- create an oofPromisedRepTextStyle instead of oofRepTextStyle			

Method	BuildLineBand
		BuildSpaceBand
		- clear mCurrentCSSID
				
		
CLASS	oofCSS2ReportSettings
Method	parseSettingsText
		- create a oofPromisedRepTextStyle instead of oofRepTextStyle					
		
		
CLASS	OOF_XMLrepStyleParser
- mCallerString added

Method	ctor
		- take an oofString& to the parent & clear it
				

CLASS	oofRepXMLEnv
Method	startSection		
		- write out the ID for the section
		
Method	startEnvironment
		- write hardcoded ID='1' for the main report
		
CLASS	oofReportSettings2CSS
		- added		
		
				
all the following added hidden in oofriXML.cpp
----------------------------------------------
added classes
- oofCSS2ReportSettings
- oofRepPromiseCompleter
- oofGraphSettingsCompleter
- oofRepTextStyleCompleter
- OOF_mixPromise
- oofPromisedRepTextStyle
- oofPromisedGraphSettings
- OOF_repXMLstyleCleanupVisitor


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/25
ALIGN BLOCKS IN XML REPORTS

CLASS	oofRepTextBlock_XMLRender
Method	describeLayout
		- write "align" attribute if centred or right-aligned
		
		
CLASS	OOF_XMLrepLayoutParser
- mCurrentBlockAlign added

Method	charData
		- set block alignment
		
Method	BuildBlock
		- added to set block alignment
		
Method	startElement
		- moved <inline> handling into BuildBlock
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/25-26
READ & WRITE COLUMN DETAILS IN XML REPORTS

CLASS	dbView
Method	getHeading(int)
		- add param returnOnlyCustom so can just get the overriden
		  headings
		  

FILE	oofsize.h
- add #include "oof3.h"

		  
CLASS	 oofColSizer
Method	naturalAlignmentForField
		- added utility


CLASS	OOF_repXMLlayoutVisitor
Method	WriteColumns
		- added to write headers, custom drawers, alignment, widths
		
Method	VisitViewBand
		- call WriteColums		


CLASS	OOF_XMLrepLayoutParser
- mCurrentColNumber added

Method	saveOldState
		- change default clearNew=true
		
Method	BuildTable
		- renamed to OpenTable to match CloseTable
				
Method	OpenColumn
		- added to read mCurrentColNumber, alignment attributes
		
Method	startElement
		- call OpenColumn for <column>
		
Method	endElement
		- clear mCurrentColNumber
						
Method	CurrentViewBand
		- added
		
use CurrentViewBand instead of inline lookup code in:
- GetDatabaseInContext
- BuildBreak
- AppendBandDependingOnState
- CloseTable

		
CLASS	oofTagMaker
Method	makeSimpleBoundedElement

use oofTagMaker::makeSimpleBoundedElement in:
- oofRepTextBlock_XMLRender::describeLayout
- oofXMLwriter::writeRecord		

use oofColSizer::naturalAlignmentForField instead of local switch in:
- oofRepViewBand_MacRender::draw
- oofRepViewBand_MacRender::drawColumnHeaders
- oofRepViewBand_MacRender::drawOverRun
- oofRepViewBand_HTMLRender::draw
- oofRepViewBand_RTFRender::draw
- oofRepViewBand_RTFRender::drawColumnHeaders
- oofRepViewBand_WinRender::drawColumnHeaders
- oofRepViewBand_WinRender::draw
- oofRepViewBand_WinRender::drawOverRun


FILE	oofriXML.cpp
enum xmlRepParseStateT
- added eInWidth, eInCustomCode	


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/26
FIX BUGS READING "Student Notes" SAMPLE BACK FROM XML

CLASS	OOF_XMLrepLayoutParser
Method	AppendBandDependingOnState
		- don't try to append based on switch statement if in break,
		  add if statement to handle breaks regardless of other states
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/26-30
ADD READING/WRITING CUSTOM CODE
(see also main OOFILE_Code_Changes for generic)

FILE	oofadorn.h
- add #include "oofxml.h"


CLASS	oofAdorner
- made subclass of oofSerializable


CLASS	oofRepBreak
- made subclass of oofSerializable


CLASS	oofRepCustomViewDrawer
		- made subclass of oofSerializable (as mixin)


FILE	oofadorn.cpp
add constants before serialization routines:
- kShadingAdorner_serializationMask		  
- kBandShadingAdorner_serializationMask		  
- kBorderAdorner_serializationMask		  


FILE	oofadorn.h
- added #include "oofxml.h"


CLASS	oofRepBreak
- made member vars protected, not private, to simplify serialization
		

CLASS	OOF_repXMLlayoutVisitor
Method	WriteColumns
		- call oofTagMaker::makeSerializableElement
		

CLASS	oofXMLserializableParser
- added


CLASS	oofXMLrepLayoutParser
- mCurrentSerializable added

Method	startElement
		- if encounter <customDrawer> inside a column, create a oofXMLserializableParser

Method	OpenColumn
		- clear mCurrentSerializable
		
don't emit a newline at the end of a CSS style in case want to embed without it
- oofGraphSettings2CSS::emitCSSstyle
- oofReportSettings2CSS::emitCSSstyle
- oofRepTextStyle2CSS::emitCSSstyle


CLASS	OOF_repXMLstyleVisitor
Method	VisitDrawable
		- draw newline after an emitCSSstyle call


CLASS	OOF_repXMLlayoutVisitor
Method	VisitAdornerList
		- write <adorners> tags if any
		
Method	VisitAdorner
		- call oofTagMaker::makeSerializableElement to save the Adorner
				

FILE	oofrep3.cpp
- add oofSerializableFactory::sFactories so it precedes the oofRepDefaultSettings
ctor (static init order bug leaving it in oofxml.cpp)

				
CLASS	oofRepDefaultSettings
Method	ctor
		- register base adorners listed below


added serialization support methods for standard classes
- oofShadingAdorner::signature
- oofShadingAdorner::serialize
- oofShadingAdorner::registerSerializable
- oofShadingAdorner::makeAdorner
- oofBandShadingAdorner::signature
- oofBandShadingAdorner::serialize
- oofBandShadingAdorner::registerSerializable
- oofBandShadingAdorner::makeAdorner
- oofBorderAdorner::signature
- oofBorderAdorner::serialize
- oofBorderAdorner::registerSerializable
- oofBorderAdorner::makeAdorner
- oofRepBreakEveryRecord::signature
- oofRepBreakEveryRecord::serialize
- oofRepBreakEveryRecord::registerSerializable
- oofRepBreakEveryRecord::makeAdorner


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/26-29
DEBUG REPORTS

CLASS	oofRepWindow (in oofRepMFC.cpp)
- mOpenedReportDB added

Method	ctor
		- init mOpenedReportDB(0)
		
Method	dtor
		- delete mOpenedReportDB

MAP		ID_FILE_OPEN incorrectly mapped to OnFileClose, now OnFileOpen
				

CLASS	OOF_repXMLlayoutVisitor
Method	WriteColumns
		- change sprintf string to have % escaped by % instead of backslash
		  ie: "%lu\%" changed to "%lu%%"
		  
		  
CLASS	oofRep
Method	drawPageHeaders
		drawFirstPageHeaders
		- move the drawing of page borders outside the conditional logic -
		  they are drawn regardless of if there are any headers
		  

CLASS	oofCSS2ReportSettings
Method	parseSettingsText
		- change delims string to have escaped \ (was just a \ by itself)


CLASS	oofCSS2RepTextStyle
Method	FindFontColour
		- rewrite way string constant defined
		

CLASS	oofColor
- mRed, mGreen, mBlue added for non Mac or Windows platforms

Method	set(unsigned int, unsigned int, unsigned int)
		- set mRed, mGreen, mBlue for non Mac or Windows platforms

Method	SetShortColor
		- call set(int, int, int) for non Mac or Windows platforms

Method	red, green, blue
		- added platform-specific getters
		
Method	extract
		- rewrote as platform-neutral using red, green, blue getter methods
		  

CLASS	OOF_XMLrepLayoutParser
Method	dtor
		- change asserts so don't make XML codes if !mParser
		  (which is the case when cleanly exit nested parser)

		  
guard all calls to strcmp by checking atts[N] argument first, in:
- OOF_XMLrepParser::startElement
- OOF_XMLrepLayoutParser::OpenTable
- OOF_XMLrepLayoutParser::startElement
- OOF_XMLrepLayoutParser::OpenColumn


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/30-31
READ & WRITE ADORNERS

CLASS	oofAdornerList
Method	adopt
		- added to simplify creation of lists and transfer of adorners


CLASS	OOF_mixAdornable
Method	hasAdorners
		- added
		

CLASS	OOF_repXMLstyleVisitor
- mAdornersEncountered added

Method	adornersEncountered
		- inline getter added
		
Method	VisitDrawable
		- write ID if inDrawable->hasAdorners		
		- update mAdornersEncountered
		
		
oofRepXMLEnv::StartReport
		- check if style visitor encountered adorners and use a
		  OOF_repXMLadornerVisitor to write <adorners> element if so


CLASS	OOF_repXMLadornerVisitor
- added very like OOF_repXMLstyleVisitor	  		


CLASS	OOF_XMLrepAdornerParser
- added very like OOF_XMLrepStyleParser


CLASS	OOF_repXMLlayoutVisitor
Method	VisitAdornerList
		VisitAdorner
		- removed unused empty method


CLASS	oofRepVisitor
Method	VisitAdornerList
		- only Enter/Leave Level if adorners to visit (minor optimisation)
		

CLASS	OOF_adornerHolder
- added to be place-holder


CLASS	OOF_repXMLadornerLinkVisitor
- added like OOF_repXMLstyleCleanupVisitor

		
CLASS	OOF_XMLrepParser
- mAdornerDict added

Method	ctor
		- init mAdornerDict to say owns contents, with 10 slots to start

Method	startElement
		- for <adorners> create a OOF_XMLrepAdornerParser
		
Method	FinishReport
		- create a 	OOF_repXMLadornerLinkVisitor to link the adorners in
		  mAdornerDict with drawables in the report	

		  
CLASS	OOF_XMLrepLayoutParser
Method	charData
		- set the block ID		  

Method	BuildGraphBand
		BuildLineBand
		BuildSpaceBand
		OpenTable
		OpenLayout
		- set the band ID		  
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/31
DEBUG REPORTS - TEXT STYLES NOT READ IN PROPERLY UNDER WINDOWS

CLASS	oofRepTextStyle
Method	ctor()
		- for Windows, init mLogFont to 0
		
Method	ctor(other than default)
		- move Windows-specific mLogFont init to finishConstruction
		
Method	invariant
		- for Windows, check that mLogFont size is!=0		
	
Method	finishConstruction
		- added to allow independent completion


CLASS	oofCSS2RepTextStyle
Method	parseStyleText
		- call finishConstruction after setting font characteristics
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/31
DEBUG REPORTS - READ & WRITE REPORT SETTINGS

CLASS 	oofCSS2ReportSettings
Method	parseSettingsText
		- compose case constants with constant addition instead of precomputed
		  (by hand) hash values, for maintability
		- correct setting bottomMargin (was setting blockVertSep)
		- reordered settings in order of oofRepSettings decl to ease maint.
		- add missing settings: drawHeadingsDownToLevel & graphBandMinSizePercent
		- added comments for settings deliberately skipped
		- parse "rpModalPreviewWindow" instead of "rPmodalPreviewWindow"
		- use same oofString::between search as in text styles
		  (just for consistency, Dave's C-style logic worked in this case)
		- delete parseBuffer - was leaking
		  

CLASS	oofRepXMLEnv
Method	StartReport
		- write out the report settings & default text style
		- take report ID as param
		
Method	startEnvironment
		- pass constant "1" to StartReport		
		
Method	startSection
		- pass report ID to StartReport		


CLASS 	oofReportSettings2CSS
Method	emitCSSstyle
		- reordered settings in order of oofRepSettings decl to ease maint.
		- add missing settings: drawHeadingsDownToLevel & graphBandMinSizePercent
		- added comments for settings deliberately skipped
		- consistently write "rpModalPreviewWindow" (differed by value)


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/31
DEBUG REPORTS - READ GRAPH SETTINGS & DRAW GRAPHS OK AFTER READING

CLASS	oofCSS2GraphSettings
Method	parseSettingsText
		- use same oofString::between search as in text styles
		  because incorrectly calculating length of parseBuffer.
		- use parseBoolString instead of dbBool::str2bool
		- set hasXAxisTicks (was setting hasTitle for that parsed value)
		- add cases for intTickLabelMask & realTickLabelMask

Method	parseBoolString
		- restore a cleaned-up version of David's original which uses
		  dbBool::char2bool instead of hashing for bool translation
		  (because of original murky code & 0 comments had not realised
		   that original was skipping the leading tag: as well as translating
		   the bool value)
		   

CLASS	oofGraphSettings2CSS
Method	emitCSSstyle
		- write separating ; after has3DEffect: true
		- for hasYLabel write "hasYLabel" (was copy-paste error "hasXLabel")
		- don't write YAxisHeight twice
		- put single quotes around intTickLabelMask & realTickLabelMask
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/05/31
DEBUG REPORTS - GRAPHS GOING ONTO NEXT PAGE

CLASS	oofRepGraphBand
Method	AdjustGraphToBandHeight		   
		- also adjust mDrawingHeight if mDrawingHeight>inHeight even though
		
		
CLASS	OOF_repFinishConstructionVisitor
Method	VisitBandList
		- visit bands before finishConstruction on list as whole, so bands
		  like graph band can calc min height (was left at default so
		  min height calc for enter band list implied couldn't squish)


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/01
READ & WRITE  REPORTS - BAND KEEP TOGETHER PROPERTY

CLASS	OOF_repXMLlayoutVisitor
Method	VisitViewHeaders
		VisitViewFooters
		- write attribute keepTogether='false' 
		
		
CLASS	OOF_XMLrepLayoutParser
Method	OpenHeaderOrFooter
		- added to also set state indicating !keepTogether
		
Method	startElement
		- use OpenHeaderOrFooter
		
Method	CurrentBandListDependingOnState
		- added		
		
Method	AppendBandDependingOnState
		- moved switch logic to CurrentBandListDependingOnState
		
				

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/01
READ & WRITE REPORTS - PAGE NUMBER BLOCKS

CLASS	OOF_XMLrepLayoutParser
Method	charData
		- search for ^P to indicate page number and create oofRepPageNoBlock 
		  or oofRepTextBlock depending on result


CLASS	oofRepPageNoBlock
Method	makeRender(const oofRepXMLEnv&
		- added to make a oofRepPageNoBlock_XMLRender


CLASS	oofRepPageNoBlock_XMLRender
- added to write block with "^P" in it


CLASS	oofRepBracketedTextBlock
Method	leadingText
		trailingText
		- added simple inline getters
		
				

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/01
DEBUGGING REPORTS - WINDOWS TEST READ & WRITE

CLASS	oofRepTextStyle
Method	finishConstruction
		- check the invariant() AFTER completing the Windows mLogFont
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/01
DEBUGGING REPORTS

CLASS	oofRep
Method	DrawBandList
		- if a band is too high for the entire body space, squish it
		  rather than jumping to the next page


CLASS	oofCSS2RepTextStyle
Method	FindFontColour
		- was comparing too many chars (my bug in trying to cleanup code, 
		  remember that sizeof a char array includes the null!

Method	FindAlignment		
		- improve hash calc so the clearer version calcs the right value
		  (was repeating one character)
		  

CLASS	oofPromisedGraphSettings
Method	receiveMsg
		- forward other messages to parent, so delete self when broadcaster
		  goes away
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/01
DEBUG PROBLEMS WITH COLOUR AND CUSTOM DRAWERS

CLASS	oofWinTextStyleDE
Method	safeChangeStyle
		- added static with the guts from draw() so we have a method
		  that others can use at replay time instead of using the
		  environment because that may have been destroyed
		  
Method	draw
		- moved all logic to safeChangeStyle		  
		- add setting colour
		

CLASS	oofRepMacGUIPreviewPP
Method	changeTextStyle		
		- call RGBForeColor (realised we weren't setting color on Mac)
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/01-02
WRITE & READ GRAPH OVERLAYS

CLASS	oofRepDrawable
Method	view
		- add index param default to 0
		
		
CLASS	oofRepViewBand
Method	view
		- add index param (ignored)
		
		
CLASS	oofRepGraphBand
Method	view
		- add index param, returning overlay view if possible for 1

Method	originalGraphHeight
		originalGraphWidth
		numOverlaid
		- added getters
				
		
CLASS	oofRepGraphBand_XMLRender
Method	draw
		- call oofRepGraphBand::overlayView & write database if a view


CLASS	oofRepSchemaVisitor
Method	VisitDrawable
		- loop calling view() assuming drawables can have >1 band		
		

CLASS	oofRepGraphBand_XMLRender
Method	describeLayout
		- write the numOverlaid attribute if >0
		- write the originalGraphHeight & width
		- write the overlaySource attribute if have overlay view


CLASS	OOF_XMLrepLayoutParser
Method	GetDatabaseInContext
		- pass in extra param for the att to look for, default "source"

Method	BuildGraphBand
		- check for optional numOverlaid and overlaySource attributes
		  and pass them into stackedBar and ordinalStackedBar graphs
		  
		  				

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/02
WRITE & READ GRAPH TITLES

CLASS	oofRepGraphBand_XMLRender
Method	describeLayout
		- write the title


CLASS	OOF_XMLrepLayoutParser
Method	BuildGraphBand
		- read the graph title

			
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
OOFILE 1.3b4d20 public release
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/06/08
COPE WITH MAC PRINTER NOT INIT - RETURNS 0 PRINT INFO

CLASS	oofRep
Method	draw
		- exit calcPageHeight returns 0
		

CLASS	oofRepMacGUIPreviewPP
Method	calcPageHeight
		- display alert and return 0 cleanly if CreatePrintRecord 
		  returns nil handle (was returning 0 by accident before, after
		  a few nil dereferences!)
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/07/04
ADD TRIVIAL SETTER FOR USERS SERIALISING ADORNERS

CLASS	oofBorderAdorner
Method	borderType
		- added simple inline setter
		
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/07/11
FIX FAILURE TO WRITE XML SCHEMA FOR STANDALONE FIELD IF NO TABLE IN VIEW
(KIDMAP Students Note report)


CLASS	dbView
- mOverrideName added

Method	name
		- add simple setter, getter that can default to table name


CLASS	oofXMLwriter
Method	CalcNames
		- use dbView::name and throw exception if not named because the 
		  XML won't work


CLASS	OOF_repXMLschemaVisitor
Method	UniquifyTables		
		- if no table on the view and it lacks a name, set it!
		- loop all fields on view and set names for any lacking
		

CLASS	OOF_repXMLlayoutVisitor
Method	VisitViewBand
		- get name from dbView::name instead of dbTable::tableName
		
		
CLASS	oofRepGraphBand_XMLRender
Method	describeLayout
		- get name from dbView::name instead of dbTable::tableName
		  for main and overlay view
		  
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/07/13
BUG WITH WRITING REPORTS WITH CENTRED BLOCKS


CLASS	OOF_XMLrepLayoutParser
Method	BuildBlock
		- was not clearing mCurrentCSSID if the block had an attribute
		  other than ID, so blocks mistakenly assigned an ID which was
		  used elsewhere already (usually the layout band enclosing the
		  block). Changed to clear the ID if atts[0] is not "ID".
		  


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/07/24
MERGE GRAPH STATE DUMP FROM DAVID 

CLASS	oofRepGraphBand_MacRender
Method	draw
		- conditionally on OOF_DEBUG_GRAPHS, call oofGraph::describe()
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/08/15,20
SUPPORT USER-OVERRIDEN HEADINGS IN XML REPORTS WITH EMPTY STRINGS
(ie: user trying to hide heading)

CLASS	OOF_repXMLlayoutVisitor
Method	WriteColumns
		- pass bool into getHeading, to test if overriden
		

CLASS	OOF_repXMLlayoutVisitor
Method	VisitViewBand
		- use oofXMLwriter::encodeName instead of legalName() 
		

CLASS	oofRepGraphBand_XMLRender
Method	describeLayout		
		- use oofXMLwriter::encodeName instead of legalName() 


CLASS	OOF_XMLrepLayoutParser
Method	GetDatabaseInContext
		- add call to translate names with oofXMLwriter::decodeName
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/09/02
SET FILE TYPE OF XML REPORTS

CLASS	oofRepWindow  _Macintosh
Method	DoSaveAs
		- after writing XML file, use oofFileRef::setFileType

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/09/30
COMPILE UNDER CODEWARRIOR PRO 5.2

conditionally use std::ios_base::fmtflags instead of long for flags variable in:
- oofRepLineBand_RTFRender::draw
- oofRepPictBand_RTFRender::draw
- oofRepGraphBand_RTFRender::draw

		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/10/25
REPORT EDITING BASE & MAC EDIT DIALOG

CLASS	oofRepSettings
- mReportEditor added

Method	reportEditor
		- added getter, setter
		
Method	ctor
		- init mReportEditor(0)
		
Method	dtor
		- delete mReportEditor
		
Method	ctor(oofRepSettings*)
		- clone rhs mReportEditor


CLASS	oofRepEditor
- added




-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/02,06
EDITING REPORTS - EDITING ENVIRONMENT SUBCLASSING

CLASS	oofRepWindow (Mac)
Method	CreateWindow
		- move most processing to CreatePreviewContent to make it easier
		  to subclass
		- depending on setting reportEditor(), create editable environment

Method	DoPageSetup
		- just call pageSetup on GUI environment rather than recreating
		

CLASS	oofRepMacEnv
Method	PageSetup
		- renamed to pageSetup to reflect public access

Method	pageSetup
		- added setter code from oofRepMacGUIPreviewPP	ctor	  
		  

CLASS	oofRepMacGUIPreviewPP
Method	ctor
		- init mPICTS(0)
		- moved other init to finishConstruction so can call if create
		  subclass rather than requiring subclass ctor to forward params
		  
Method	finishConstruction
		- added 2nd half of construction
		- move pageSetup handle duplication to parent class
				  
Method	PageSetup
		- removed inline getter which was copy of (non-virtual) in parent

Method	Offset
		- renamed to printableAreaOffset to reflect purpose & access
		  (public method)


FILE	oofRepPPWindow.cpp
- add #include "oofrepedit.h"


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/04
FIX BUG WITH WINDOWS PRINT AFTER PREVIEW NOT DRAWING COLUMN HEADERS
(Mercator bug WK199910280003)


CLASS	oofRepViewBand_WinRender
Method	startTable
		- renamed to startTableBody so it overrides parent method
		  and is invoked to reset the flag
		  
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/06-09
EDITING REPORTS - CREATION OF RENDER MAPPERS

CLASS	oofRepRenderDecorator
- added light wrapper


CLASS	oofRepRedirectingRender
- added to redirect most draws


CLASS	oofRepLayoutRedirectingRender
- added to redirect Layout band rendering


CLASS	oofRepViewRedirectingRender
- added to redirect View band rendering


CLASS	oofRepDrawable
Method	makeRender(const oofRepEditingEnv&)
		- added to just invoke normal parent makeRender for GUI
		

CLASS	oofRepViewBand
CLASS	oofRepLayoutBand
CLASS	oofRepTextBlock
Method	makeRender(const oofRepEditingEnv&)
		- added to make a drawing render object then pass into an oofRepRenderDecorator
		  from an overrideable factory from oofRepEditor
		

CLASS	oofRepEditingEnv
- added as conditional subclass of oofRepMacGUIPreviewPP or oofRepWinGUIPreviewMFC


FILE	oofrep.h
- added forward decl of oofRepEditingEnv



FILE	oofrep1.cpp
- added #include "oofrepedit.h"

		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/13-15
EDITING REPORTS - EDIT LINKING

CLASS	oofRepCustomViewDrawer
- made subclass of oofRepCustomDrawer



CLASS	oofRepViewBand
Method	hasCustomViewDrawers
		- added to check count
		

CLASS	oofRepViewEditLink
		oofRepLayoutEditLink
		oofRepEditLink
		- added
		

********* 99/11/16 START ROLL IN DAVID FIXES		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/09/02 FIXES TO TSV AND CSV OUPUT TO PREVENT CRASH IF USE WITHOUT PREVIEW

CLASS	oofRepSettings
Method describe
		- added it
		
CLASS		oofRepCSVEnv
Method  	startEnvironment
			- removed 	oofRep::currentReport()->drawPageHeaders
		
Method  	endEnvironment
			- removed 	oofRep::currentReport()->drawPageFooters	

Method		preprocessesPageHeadersAndFooters	
			changed to return false instead of true
			
			
CLASS		oofRepTSVEnv
Method  	startEnvironment
			- removed 	oofRep::currentReport()->drawPageHeaders
		
Method  	endEnvironment
			- removed 	oofRep::currentReport()->drawPageFooters	

Method		preprocessesPageHeadersAndFooters	
			changed to return false instead of true


CLASS	oofRepViewBand
Method	makeRender(const oofRepTSVEnv& env) 
		- call finishConstruction
		

CLASS	oofRepViewBand_TSVRender
Method	finishConstruction
		- added to init column headers
		
				
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/10/25
FIXES TO PREVENT INTERMITENT SORTS

CLASS 	oofRepViewBand_XMLRender
Method	finishConstruction
		- added it

CLASS 	oofRepViewBand
Method 	makeRender(const oofRepXMLEnv& inEnv) 
		- added call to finishConstruction
 

********* 99/11/16 END ROLL IN DAVID FIXES		
CLASS	oofRepRTFEnv
Method	startEnvironment
		- IGNORED David temp comment out drawPageHeaders, footers
		
Method	preprocessesPageHeadersAndFooters
		- IGNORED David change to return false
				

CLASS	oofRepViewBand_TSVRender
Method	finishConstruction
		- moved simple method up to base oofRepViewBand_Render

		
CLASS	oofRepViewBand
Method	makeRender(oofRepHTMLEnv&
		makeRender(oofRepCSVEnv&
		makeRender(oofRepTextEnv&
		- call finishConstruction
		
				
FILE	oofrep.h
- change OOFVERS_REP to 0x01305d01	// Version 1.3.0b5d01		
		  
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/18
EDITING REPORTS - CREATION OF EDIT LINKS

CLASS	oofRepDrawable
Method	makeEditLink
		- added default returning NULL
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/21
EDITING REPORTS - VIEW BAND WRAPPING - REFACTOR TO DELEGATE BETTER

CLASS	OOF_mixViewRender
- added


CLASS	oofRepViewBand_Render
- made also subclass of OOF_mixViewRender	

Method	startTableBody
		startTableWrapper
		endtableBody
		endTableWrapper
		-  moved to OOF_mixRenderDecorator		

Method	finishClone
		- added
		

CLASS	oofRepViewRedirectingRender
- made subclass of oofRepRenderDecorator and OOF_mixViewRender


CLASS	oofRepViewBand
- mTableExtraRender added

Method	ctor(both)
		- init mTableExtraRender(0)
		
Method	copy ctor
		- call mTableExtraRender->finishClone on the rhs 		

use mTableExtraRender instead of cast mRender in methods		
- 	drawColumnHeaders
- endTableBody
- endTableWrapper
- startTableBody
- startTableWrapper

set mTableExtra in
- makeRender(const oofRepWinEnv&
- makeRender(const oofRepMacEnv&
- makeRender(const oofRepRTFEnv&
- makeRender(const oofRepHTMLEnv&
- makeRender(const oofRepXMLEnv&
- makeRender(const oofRepCSVEnv&
- makeRender(const oofRepTSVEnv&
- makeRender(const oofRepTextEnv&


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/21
COMPILE CONSOLE SAMPLE ON MAC

FILE	oofRepMac.h
- replace	#include <UPrintingMgr.h> with   #include <Printing.h>


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/21
EDITING REPORTS - VIEW BAND EDITING - FINISH GENERATION OF COORDINATE MAPS

CLASS	oofRepViewRedirectingRender
Method	ViewBand
		- added getter

Method	startTableBody
		- check if topmost band and pass false to willCloneView param
		  when calling makeViewEditLink
		  
		
CLASS	oofRepViewBand_Render
Method	viewBand
		- added getter		


CLASS	oofRepRedirectingRender
- mEditLink added

Method	ctor
		- init mEditLink(0)

Method	dtor
		- added to delete mEditLink
				

CLASS	oofRepEditor
- mDefaultInteractor added

Method	makeViewEditLink
		- add bool flag parameter willCloneView
		
Method	addSenseArea
		- added to add simple rectangle

Method	ctor
		- init mDefaultInteractor(new oofRepInteractorSimpleClickStrategy)
		
Method	dtor
		- delete mDefaultInteractor
								

CLASS	oofRepRender
Method	leftDrawMargin
		- added virtual so wrappers can perform location calcs
		
Method	width
		- added virtual with default returning report body width less indents
		
		
CLASS	oofRepRenderDecorator
Method	leftDrawMargin
		- added forwarding override
		
		
CLASS	oofRepInteractorStrategy
- added pure abstract

CLASS	oofRepInteractorSimpleClickStrategy
		- added empty implementation
		
		
CLASS	OOF_InteractionArea
		- added simple structure
		
		
CLASS	OOF_InteractionAreas
		- added array of OOF_InteractionArea						
		

FILE	oofrepedit.h
- added forward decl of oofRepInteractorStrategy


CLASS	oofRepEditingEnv
Method	makeRenderDispatch
		- added copies of oofRepMacEnv because using inherited one breaks
		  the smart shuffle - was never invoking our makeRender!
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/21
EDITING REPORTS - REMOVE DOWNCASTS FOR RENDERERS

CLASS	oofRepDrawable
Method	width
		- added virtual calling render
		
		
CLASS	oofRepRender
Method	width
		- added virtual with default returning 0
		
		
CLASS	oofRepRenderDecorator
Method	width
		- added forwarding override
		
		
CLASS	oofRepTextBlock
Method	width
		- move the method up to oofRepDrawable
		
		
CLASS	oofRepBlock
Method	width
		- remove pure virtual
		
		

CLASS	oofRepPictBlock_Render
Method	width
		- remove pure virtual
		
		
CLASS	oofRepTextBlock_Render
Method	width
		- remove pure virtual
		
remove unused dummy width methods from classes
- oofRepPictBlock_CSVRender
- oofRepPictBlock_HTMLRender
- oofRepTextBlock_HTMLRender
- oofRepPictBlock_RTFRender
- oofRepTextBlock_RTFRender
- oofRepPictBlock_TSVRender
- oofRepTextBlock_TSVRender
- oofRepPictBlock_XMLRender
- oofRepTextBlock_XMLRender


made old width() methods const in classes:
- oofRepPictBlock_MacRender
- oofRepTextBlock_MacRender
- oofRepPictBlock_WinRender
- oofRepTextBlock_WinRender


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/22
EDITING REPORTS - HANDLE VIEW OVERRUNS

CLASS	oofRepViewBand_WinRender
CLASS	oofRepViewBand_MacRender
Method	drawOverRun
		- renamed to DrawContinuingOverPage to better show function
		- made protected - it will never be a public call
		- call oofRepEnv::splitBandOverPage  && resumeBandOverPage
		

CLASS	oofRepEnvironment
Method	splitBandOverPage,resumeBandOverPage
		- add empty virtual defaults
		

CLASS	oofRepEditingEnvironment
Method	splitBandOverPage,resumeBandOverPage
		- add overrides to tell mEditor
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/22
EDITING REPORTS - MULTIPLE PAGE MAPPING & MOVE PAGE MAPS TO ENVIRONMENT

CLASS	oofRepEditor
- mAreas moved to oofRepEditingEnv

Method	makeDefaultRenderWrapper
		makeLayoutRenderWrapper
		makeViewRenderWrapper
		- pass in oofRepEditingEnv param so don't use this as render param

Method	addInteractionArea
		- moved to oofRepEditingEnv
				

CLASS	oofRepEditingEnv
- mSavedSplitArea added
- mPages added
- mAreas removed

Method	ctor
		- init mSavedSplitArea(0), mPages(0)
		
Method	dtor
		- add assert(!mSavedSplitArea)
		
Method	startEnvironment
		- added to wrap deleting old areas, create new mPages
		- call mPages->addPage() so we've created a current 1st page to map
		
Method	endEnvironment
		- added for symmetry, check not halfway through split of band

Method	drawPageBreak
		- call mPages->addPage() so we've created a current page to map

Method	splitBandOverPage
		- use mPages->currentPage() instead of mAreas

Method	addInteractionArea
		- use mPages->currentPage() instead of mAreas


CLASS	oofRepRedirectingRender
- mEditor removed

Method	ctor(in all subclasses too
		- remove 1st param

Method	editingEnv
		- added simple getter to cast current report's environment
		
Method	editor
		- added simple getter to retrieve editor from editingEnv()
		

CLASS	oofRepViewRedirectingRender
Method	startTableBody
		- use editor() to get oofRepEditor to make the link
		
Method	draw
		- use editingEnv() to get oofRepEditingEnv to addInteractionArea		


CLASS	OOF_InteractionPages
- added


CLASS	OOF_InteractionAreas
- renamed to OOF_InteractionPageAreas to make it clearer just one page



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/24
FIX FAILURE TO DRAW RTF HEADERS FOR MULTIPLE REPORTS

CLASS	oofRepRTFEnv
- mSectionNumber added

Method	drawSectionBreak
		- moved most logic to startSection
		- removed method
		
Method	startEnvironment
		- removed drawing of page headers & footers (duplicate of startSection code)
		- if single report, call startSection
		- init mSectionNumber
				
				
				
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/11/27-29 - 12/02
ADD EDITING DIALOG TO REPORTS

FILE	RepWindow.PPob
- add dialog 29011 CellEditor


FILE	oofrepeditMac.cpp
- add cmd constants for edit dialog



CLASS	OOF_mixRepCellEditor
- added base providing default implementation for most cell editor actions
  (with chance to make this cross-platform later)
  
  
CLASS	oofRepEditDialog
- added example of edit dialog


CLASS	oofRepEditor
- remove typedef baseGUIenvT

Method	makeEditingEnvironment
		- change return type to oofRepEditingEnv*
		
Method	defaultInteractor
		- added simple getter		
		
Method	startEditing
		- added factory to create edit dialog		



CLASS	oofRepEditingEnv
Method	startMonitoringWindowInteractions
		- added to create attachment to preview pane to get clicks

Method	addInteractionArea
		- use extra params oofRepInteractorStrategy* inInteractor, inWidth, inHeight		
		  forwarding to OOF_InteractionPageAreas

Method	singleClick
		- added to lookup area and forward the click
				
		
CLASS	oofRepWindow
Method	ctor(LStreaim*)
		- init 	mPICTView(0),
		  mFirstButton(0),
		  mPrevButton(0),
		  mNextButton(0),
		  mLastButton(0),
		  mPrintBWCheck(0)
		
Method	CreatePreviewContent
		- use local var so aware of subclassed oofRepEditingEnv
		  return from makeEditingEnvironment
		- pass mPICTView through to startMonitoringWindowInteractions
		
				
FILE	oofrepedit.h
- add forward decl for oofRepEditingEnv


FILE	oofrepeditMac.cpp
- added #include "oofrepeditx.h"


CLASS	OOF_InteractionPageAreas
Method	addInteractionArea
		- take extra params oofRepInteractorStrategy* inInteractor, inWidth, inHeight
		- set new variables in OOF_InteractionArea
		
		
CLASS	OOF_InteractionArea
- mInteractionStrategy, width, height added		


CLASS	oofRepMacGUIPreviewPP
- mCommander added

Method	parentCommander
		- added getter, setter


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/03
IMPLEMENT RECONCILING PAGE POSITION TO ARRAY OF CELLS

CLASS	OOF_InteractionArea
- mRow, mCol added


CLASS	OOF_InteractionPageAreas
Method	addInteractionArea
		- set OOF_InteractionArea.mRow, mCol
		


CLASS	oofRepEditLink
- mCurrentCol, mCurrentRow added

Method	getCurrentCoords, setCurrentCoords
		- added inline getter/setter pair
				
				
CLASS	OOF_mixRepCellEditor
- mCellCol, mCellRow removed

Method	GoToAnotherCell		
		- use oofRepEditLink coords


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/07
BUILDING WINDOWS VERSION - COPE WITH HIDING MFC


CLASS	oofRepDrawable
Method	makeRender(const oofRepEditingEnv& 
		- moved to oofrepedit.cpp, was in oofrep1.cpp
		

FILE	oofRepPWindow.cpp
- changed #include "oofrepedit.h" to #include "oofrepeditx.h"		



CLASS	oofRepEditor
- removed unused Mac-specific mWindowEventMonitor


FILE	oofrep1.cpp, oofrep2.cpp
- remove unneeded #include "oofrepedit.h"


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/08
INTEGRATE DAVID RTF FIXES FOR SECTIONS AND PAGE HEADER & FOOTER INCLUSION & SIZE

GENERAL CHANGE 
- added #ifndef CONSOLE_PROJECT hiding includes & oofRepEditingEnv


CLASS	oofRepPageNoBlock
Method	makeRender(oofRepRTFEnv
		- restored since 98/11/18 so we have unique rendering of page numbers in RTF
		  rather than drawing literal text


CLASS	oofRepPageNoBlock_Render
		- restored since 98/11/18
		
Method	width
		- removed old redundant method after restoring class
		
		
CLASS	oofRepMulti
Method	draw
		- move the finishing of construction before the making of renderers
		

CLASS	oofRepDrawable
Method	draw		
		- change assert(mRender) into a return if !mRender
		
		
CLASS	oofRepRTFEnv
Method	drawPageBreak		
		- remove opening { before \\page
		
Method	startSection
		- bracket the pgnstart pgnrestart directives in {}
		- bracket headers and footers slightly differently, closing them here
		- write titlepg and headerf and footerf if have 1st page headers or footers
		
Method	startEnvironment
		- write margt and margb without trailing hyphen, so doesn't force size

Method	endEnvironment
		- write extra closing \\sect}
		

CLASS	oofRepLineBand_RTFRender
Method	draw
		- also write pichgoal to guarantee height behaves on Mac
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/08
DEBUGGING PRINTING WITH EDITING INTEGRATED

CLASS	oofRepRedirectingRender
Method	editRedirectionActive		
		- added, just testing if environment is printing environment


CLASS	oofRepViewRedirectingRender
Method	startTableBody
		- check editRedirectionActive before doing any wrapping activity
		- also call wrapped method

Method	draw
		- check editRedirectionActive before doing any wrapping activity
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/08
POLISHING MAC EDITING DEMO

CLASS	oofRepEditDialog
Method	UpdateLocationDisplay
		- added empty method
		
		
CLASS	oofRepEditDialog
Method	LoadCellEditField
		- complete empty method to copy the string
		
Method	AttemptSaveCellEditField	
		- completed empty method to write data to database	
		
		
CLASS	oofRepEditLink (and all subclasses)
Method	setCellText		
		- move string param to 1st param, so row & col can default
		
Method	getCellText		
		-  row & col default to -1 so they can use mCurrentRow and mCurrentCol


CLASS	oofRepEditor
Method	startEditing
		- set the edit coords based on the area selected



CLASS	OOF_InteractionArea
Method	ctor
		- init mRow, mCol(-1)
		
Method	matchesCoords
		- renamed to matchesPageLocation
		

CLASS	OOF_mixRepCellEditor
Method	FinishCreationByLinkingDataModel
		- call LoadCellEditField et al to load the initial value!


		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/08
RECONCILING PAGE POSITION TO ARRAY OF CELLS

CLASS	oofRepViewRedirectingRender
Method	addInteractionArea
		- add required params row and col passed onto page
		

CLASS	OOF_InteractionPageAreas		
Method	addInteractionArea
		- add required params row and col set in OOF_InteractionArea
		

CLASS	oofRepViewRedirectingRender
Method	draw
		- pass the row and col to oofRepViewRedirectingRender::addInteractionArea


CLASS	oofRepEditingEnv
Method	addInteractionArea(const OOF_InteractionArea&);
		- added to simply copy

Method	resumeBandOverPage
		- call the copying version of addInteractionArea
				

CLASS	OOF_InteractionPageAreas
Method	addInteractionArea(const OOF_InteractionArea&);
		- added to simply copy
		
			
	

use dbView::recordNumber in
- oofRepViewBand_MacRender::draw
- oofRepViewBand_MacRender::DrawContinuingOverPage		
- oofRepViewBand_WinRender::draw
- oofRepViewBand_WinRender::DrawContinuingOverPage


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/09
SEPARATE OUT DEMO CELL EDITOR SO USERS NOT FORCED TO LINK LGADIALOG ETC.

CLASS	oofRepEditDialog
- renamed to CRepEditDialog		
- moved out to CSampleRepEdit.cpp so users don't have to link LGADialog etc.


CLASS	oofRepEditor
Method	startEditing
		- moved out to CSampleRepEdit.cpp as it has to know the actual edit dialog
		  (needs overrriding)


FILE	oofrepedit.h
- forward declare oofRepViewBand_Render, oofRepLayoutBand_Render



PPob	CellEditor
- moved to file CSampleRep.PPob


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/11
FIX INCORRECT DETECTION OF CLICK ON PREVIEW WINDOW

CLASS	OOF_InteractionPageAreas
Method	findAreaBelowAndRightOf
		- save the LAST item that matches, don't break on the first
		

CLASS	OOF_InteractionArea
Method	matchesPageLocation
		- reverse sense of test - XY incoming should be below and right
		  of area XY.
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/14
FIX CRASHES WITH EDITING NESTED VIEWS

CLASS	oofRepEditor
Method	makeViewEditLink
		- pass true into dbView::clone to make it clone the table as well
		  and so hang onto the data selection
		- reverse the order of cloning - was always avoiding!
		
		
CLASS	oofRepViewRedirectingRender
Method	startTableBody		
		- compare nested level against oofRep::kBodyViewLevel
		
		
CLASS	oofRep
- kBodyViewLevel enum constant added to avoid mistakenly comparing to 0
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/14
COMPLETE SAVING FROM EDITING

CLASS	oofRepViewEditLink
Method	setCellText
		- added body to set cells
		

CLASS	oofRepWindow  (Mac)
Method	ReflowReport
		- save current page number and try to reappear on that page


CLASS	oofRepEditor
Method	makeViewEditLink
		- ignore willCloneView param and never clone so we can update the 
		  database (in bufferForever mode)


CLASS	oofRepViewRedirectingRender
Method	startTableBody		
		- remove assert as it may trigger


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/15
PREVENT ASSERTIONS WHEN GO TO RIGHT OR BOTTOM EDGE IN EDIT DIALOG

CLASS	OOF_mixRepCellEditor
Method	GoToAnotherCell		
		- subtract 1 from num cols or rows being compared
		- fix silly copy-and-paste bugs in eGoDown with col variables instead of row
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/15
TRIGGERING PAGE REFLOWS AFTER EDITING

CLASS	oofRepWindow
- cmdRefresh added

Method	ObeyCommand	
		- add case for cmdRefresh
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/15-16
AVOIDING CLONING IN VIEWS - USE EDIT CHANGES IN DIALOG WHEN REDRAWING


CLASS	oofRepEditLink
Method	enterLink, leaveLink
		- added pair of empty virtuals


CLASS	oofRepViewEditLink
- mView removed
- mSelection added

Method	View
		- always return drawable's view
		
Method	dtor
		- delete mSelection
		
Method	ctor
		- take bool flag indicating are editing selection
		- clone selection as appropriate, sometimes from base table
		- set the buffer forever mode on our view

Method	enterLink
		- added to possibly set view selection
		
								
CLASS	oofRepEditor
Method	makeViewEditLink
		- renamed 2nd param to editingSubSelection as much more descriptive of
		  circumstance than of how to react
		- pass bool flag down to edit link so this method becomes just trivial
		  factory
		
		
CLASS	OOF_mixRepCellEditor
Method	LoadAndUpdate()
		- added to combine several virtuals in a Template Method pattern

Method	FinishCreationByLinkingDataModel
		- use LoadAndUpdate instead of several calls
		- add call to oofRepEditLink::enterLink

Method	GoToAnotherCell
		- use LoadAndUpdate instead of several calls		
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/16-17
FIX FAILURE TO REDRAW EDITED VALUES

CLASS	oofRep
Method	draw
		- temporarily comment out useRepContext and init of mRepContext as that
		  prevents edited data being displayed in Reflow'd report


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/17
WIDEN THE SCOPE OF BUFFERING REPORT CHANGES

CLASS	OOF_repBufferSettingVisitor
- added simple view visitor


CLASS	oofRep
Method	draw
		- use a OOF_repBufferSettingVisitor to set all tables to bufferForever
		
Method	dtor		
		- use a OOF_repBufferSettingVisitor to reset save modes to defaults

Method	reportAllowsEditing
		- added simple inline query
		

CLASS	oofRepViewBand
Method	view
		- don't always return mView, now return NULL if >0 param		
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/15-19
FIX CHANGE BUFFERING ON CURRENT RECORDS AND NESTED RELATED RECORDS

CLASS	OOF_repBufferSettingVisitor
Method	VisitView
		- iterate all fields to see if any related ones need their tables
		  also modifying
		  
		  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/20
WRAP RTF CHARACTERS THAT WOULD CAUSE ILLEGAL RTF (DAVID'S FIXES)

CLASS 	oofRepRTFEnv
Method	encodeToRTFStream
		- added it

Method	encodeRTFstring
		- added (David had put in oofString but keep here as only
		  limited applicability, unlike encodeEntity)
		  	
		
CLASS 	oofRepViewBand_RTFRender
Method	draw
		- added call encodeRTFString
		
		
CLASS 	oofRepTextBlock_RTFRender
Method 	draw
		- added call to encodeToRTF mOwner->text();
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/20
FIX REPORT CRASHES ON CLOSING MULTI REPORTS

CLASS	oofRepMulti
Method	dtor
		- added mSections.deleteAllCells();


CLASS	oofRepVisitor
Method	visit
		- skip visiting body band if not there
		
Method	VisitViewBand
		- added assert(inBand)
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/21
FIX INCORRECT SELECTIONS ON NESTED TABLES

CLASS	oofRepViewEditLink
- mRecordNumber added

Method	ctor
		- init mRecordNumber(0)
		- if table is related clone, save recordnumber of base

Method	enterLink
		- if table is related clone, restore record number of base
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/21-22
CHANGE REPORT EDITING TO REUSE GUI LINK CLASSES

FILE	oofrepedit.h
- add 	#include "oofgui.h"


CLASS	OOF_mixRepCellEditor
- made subclass of dbHelper
- mCellEditContent removed
- mEditAdapter added
- mContentDirty renamed to mAnyContentDirtied

Method	maybeDirty
		- added so field link can set mAnyContentDirtied

Method	InitEditControls
		- take dbGUIAdapter* instead of LView*

Method	ctor
		- init mAdapter(0)
		
Method	dtor
		- delete mAdapter
		
Method	InitEditControls
		- change inContent param to adoptedContentAdapter

Method	MarkDirty
		- removed		

Method	EnterLink
		- added to wrap setting mCurrentLink and init of link
								

CLASS	oofRepEditLink
- made subclass of dbFieldLink

Method	ctor
		- init dbFieldLink(NULL, NULL)

Method	dtor
		- clear mAdapter as we do NOT own it
		
Method	enterLink
		- take dbGUIAdapter* param so can reset parent (dbFieldLink)
		  pointer to the adapter
		  
Method	leaveLink
		- clear dbFieldLink::owner()		  

Method	tellGUIcareAboutLocking
		- added empty virtual to hide parent


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/23
WINDOWS BUILD OF EDITING

CLASS	OOF_mixRepCellEditor
- moved most methods to OOF_mixRepAbstractCellEditor in oofrepedit.*

Method	UnableToMoveWarning		
		- use oofRuntimeEnv::beep() to be cross-platform

Method	FinishCreationByLinkingDataModel
		- added in Windows version to avoid early use of uninitialised mAdapter
			
	
CLASS	oofRepWindow (Win)
Method	CreatePreviewContent
		- added to contain most of the guts of creating window
		- add creation of editing environment if oofRepEditor in settings
		
Method	CreateReportWindow
		- moved most logic to CreatePreviewContent

Method	OnLButtonUp
		- added to trap clicks

MMAP	ON_WM_LBUTTONUP message map entry added
		  

CLASS	oofRepPageList
Method	index
		- added publishing of private parent method
		  
FILE	oofRepMFC.cpp
- add #include "oofrepeditx.h"


FILE	oofrepeditor.h
- moved oofRepEditor class here so can include without GUI


FILE	oofrep3.cpp
- changed #include "oofrepedit.h" to "oofrepeditor.h"

  		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/23
SUPPORT BUTTON DISABLING

CLASS	OOF_mixRepCellEditor
Method	UpdateMovementButtons
		- permanently disable the next/prev item buttons until we implement


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/23
PREVENT EDITING CALCULATED FIELDS

CLASS	oofRepEditLink
Method	getCellText
		- reverse the order of params (seldom set row, col)		


CLASS	oofRepLayoutEditLink
Method	getCellText
		- reverse the order of params 		


CLASS	oofRepViewEditLink
Method	getCellText
		- check if field is virtual to return outIsEditable
		- reverse the order of params
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/23
MINOR FIXES
CLASS	oofRepViewEditLink
Method	getCellText
		- update the outLocationName
		
		
FILE	RepWindow.ppob
- old version of CellEditor dialog removed


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/23
UPDATE LOCATION DISPLAYS
CLASS	oofRepViewEditLink
Method	getCellText
		- update the outLocationName based on heading and row number


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/23
FIX CRASH IF CLICK PREVIEW WINDOW BEFORE CONTENT FULLY INITIALISED

CLASS	oofRepEditingEnv
Method	singleClick
		- check to see mInterationPages has been init'd


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
99/12/24
MINOR CLEANUPS

CLASS	OOF_mixRepAbstractCellEditor
Method	UpdateLocationDisplay
		- removed - we expect you to update in LoadCellEditField as that's
		  where user code knows if there's a location display
		  

CLASS	CRepEditDialog		  
Method	UpdateLocationDisplay
		- removed unused method (see LoadCellEditField)


CLASS	OOF_mixRepCellEditor (Mac and Win)
Method	InitEditControls
		- allow NULL defaults for buttons


CLASS	oofRepViewRedirectingRender
Method	draw
		- compensate to make click area recording more accurate
		

CLASS	oofRepEditLink
Method	enterLink
		- removed assert(!mAdapter || mAdapter==inAdapter)
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/04-06
REDIRECTING RENDERERS FOR LAYOUT BANDS - GENERATING COORDINATES

FILE	oofrepeditor.h
- added forward decl of oofRepLayoutEditLink		


CLASS	oofRepEditor
Method	makeLayoutEditLink	
		- changed return type to oofRepLayoutEditLink*

Method	makeDefaultRenderWrapper
		- removed
		
Method	makeDefaultBlockRenderWrapper
		- added


CLASS	oofRepTextBlock
Method	makeRender(const oofRepEditingEnv&
		- moved up to oofRepBlock
		

CLASS	oofRepLayoutRedirectingRender
- sCurrentLayoutRedirectingRender added
- mEditLink added

Method	ctor
		- init mEditLink(0)

Method	draw	
		- set and clear sCurrentLayoutRedirectingRender
		- create mEditLink if not set

Method	SetupEditLink
		- added
		
Method	currentLayoutRedirectingRender
		- added simple getter
		
Method	addAreaForCurrentBlock		
		- added

Method	LayoutRender
		- added downcaster
		

CLASS	oofRepRedirectingRender
Method	draw
		- made pure virtual

Method	clone
		- made pure virtual
				
		
CLASS	oofRepBlockRedirectingRender	
- added to record block positions		
	
				
CLASS	oofRepLayoutEditLink
- mRows added

Method	InitMapping
		- added

Method	getFirstCoordsForBlock
		- added to scan map
		

CLASS	oofRepLayoutBand_Render
- mCurrentX, mCurrentY, mCurrentBlock added

Method	SetCurrentBlockCoords
		- added protected setter


Method	getCurrentBlockCoords
		- added public getter
		

CLASS	oofRepLayoutBand_MacRender
CLASS	oofRepLayoutBand_WinRender
Method	draw		
		- call SetCurrentBlockCoords
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/05-06
REDIRECTING RENDERERS FOR BLOCKS IN LAYOUT BANDS - EDITING INTERFACE

CLASS	oofRepBlock
Method	countCells
		- added returning default of 0
		
Method	getCellText
		- added to return empty string
		
Method	setCellText
		- added default that asserts
		

CLASS	oofRepPictBlock
Method	countCells
		- added assuming 1
		
Method	getCellText
		- added to return locked picture filename

		

CLASS	oofRepTextBlock
Method	countCells
		- added assuming 1
		
Method	getCellText
		- added to return fixed text or field contents

Method	setCellText
		- added to set fixed strings and maybe field


CLASS	oofRepBracketedTextBlock
- mTrailingText made protected (was private) so subclasses can write

Method	countCells
		- added assuming 3 - may want to edit even blank bits either side
		

CLASS	oofRepFieldBlock
Method	getCellText
		- added to return fixed text or field contents

Method	setCellText
		- added to set fixed strings and maybe field
		

CLASS	oofRepPageNoBlock
Method	getCellText
		- added to return fixed text or page number string

Method	setCellText
		- added to set fixed strings


CLASS	oofRepLayoutBand_Render
Method	ownerLayout
		- added inline getter	


CLASS	oofRepLayoutEditLink
Method	MapCoordsToBlock
		- added

Method	setCellText, getCellText
		- completed, just forwarding to block

Method	maxCols
		- just return mMaxCols

Method	maxRows
		- just return mMaxRows
		

CLASS	OOF_RepBlockCellRows
		OOF_RepBlockCellRow
		OOF_RepBlockCellMap
		- added
				
				
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/05-06
FIX WINDOWS REPORT EDITING REFRESH & MATCH MAC IMPLEMENTATION

CLASS	oofRepWinGUIPreviewMFC
- mParentWindow added (for symmetry with Mac, not currently used)

Method	parentWindow
		- added simple getter/setter pair
		
Method	ctor
		- init mParentWindow(0)		


CLASS	oofRepWindow (MFC)
Method	CreatePreviewContent
		- set the environment parentWindow()

MMap	- add entry for ID_REPORT_REFRESH mapping straight to ReflowReport
	
					
CLASS	oofRepMacGUIPreviewPP
Method	ctor
		- init mCommander(0)		



FILE	oofRPRes.h
- added ID_REPORT_REFRESH

		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/06
ADD DEBUGGING CODE TO DUMP INTERACTIONS

CLASS	oofRepEditingEnv
Method	addInteractionArea(both)
		- dump area locn depending on definition of OOF_REPEDIT_LOG_FILENAME

Method	startEnvironment		
		- write out identifying point in log file
		
		
CLASS	oofRepInteractorSimpleClickStrategy
Method	singleClick
		- dump click locn depending on definition of OOF_REPEDIT_LOG_FILENAME
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/06
REMOVE MEMORY LEAK IN REPORT EDITING - DELETE OWNED LINKS

CLASS	OOF_InteractionPageAreas
- mOwnedLinks added

Method	dtor
		- delete owned links via decRefs
		
Method	addEditLinkStartOnPage
		- add the link to mOwnedLinks		
		- renamed to pageAdoptsEditLink to make function clearer
		- inc ref count of incoming link
		
		
CLASS	oofRepEditingEnv
- mSplitAreaForNextPage renamed to mSplitAreaForNextPage to make it clearer
  that we're not reusing something from previous page
  
Method	addEditLinkStartOnPage
		- renamed to pageAdoptsEditLink
		- inc refs on the incoming link
		

CLASS	oofRepEditLink
		- made subclass of OOF_mixRefCount so can share refs

Method	ctor
		- init parent OOF_mixRefCount(0)
		

CLASS	oofRepLayoutRedirectingRender
Method	dtor
		- added to dec refs of mEditLink
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/07
FIX REPORT MOVEMENT TO COPE WITH IRREGULAR LAYOUT

CLASS	OOF_mixRepAbstractCellEditor
Method	GoToAnotherCell 
		- use calls to get next row/col based on current position, 
		  rather than navigation inside grid
		  
		  

CLASS	oofRepEditLink
Method	maxCols
		maxRows
		colsInRow
		rowsInCol
		- removed
		
Method	atFirst
		getLastCoords
		getLeftOfCurrent
		getRightOfCurrent
		getUpFromCurrent
		getDownFromCurrent
		- added simple base movement methods assuming in single cell


CLASS	oofRepViewEditLink
- mMaxRows, mMaxCols added

Method	ctor
		- init mMaxRows, mMaxCols based on incoming view
		
Method	maxCols
		maxRows
		- removed
		
		
Method	atFirst
		getLastCoords
		getLeftOfCurrent
		getRightOfCurrent
		getUpFromCurrent
		getDownFromCurrent
		- added simple base movement methods assuming in single cell


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/09
FIX ZOOMED WINDOW EFFECTS ON CLICK LOCATION FOR EDITING

CLASS	oofRepWindow
- mCachedScaleRatio added
- enum cmdRefresh=ID_REPORT_REFRESH added to make code from Mac more portable

Method	ctor
		- init mCachedScaleRatio(0)
		
Method	ScalingRelativeToPage
		- added to hide comparison of mScaleFactor to make it clearer
		  what's been tested
		  
Method	GetTransformedPageSize
		- set mCachedScaleRatio to preserve value calculated from page size
		- use ScalingRelativeToPage instead of direct test of mScaleFactor

Method	OnSize
		- use ScalingRelativeToPage instead of direct test of mScaleFactor
		
Method	OnLButtonUp
		- if mScaleFactor!=100 scale incoming point back to match		
		- add general scaling by 1.2 empirically determined
		- offset by scrolling position of window
		

CLASS	oofRepInteractorSimpleClickStrategy
Method	SingleClick		
		- remove logging - only measures clicks that find areas, moved up call-chain to
		
		
CLASS	oofRepEditingEnv
Method	singleClick		
		- add logging of click, with the extra param of the area found so can see who we match
		  and if we fail

		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/09-11
EDITING COLUMN HEADERS

CLASS	oofRepEditor
Method	makeDefaultEditLink
		- removed empty virtual
		
Method	makeColHeaderEditLink
		- added
		

CLASS	oofRepViewRedirectingRender
- mColHeaderEditLink added

Method	ctor
		- init mColHeaderEditLink(0)

Method	dtor
		- added to mColHeaderEditLink->decRefs
		
Method	startTableBody		  
		- create mColHeaderEditLink

Method	AddRowInteractionAreas
		- added
		
Method	draw
		- use AddRowInteractionAreas

Method	drawColumnHeaders
		- change last row of areas to point to mColHeaderEditLink
		- use AddRowInteractionAreas to add a row for 1st real row						

		
CLASS	oofRepColHeaderEditLink
- added


CLASS	oofRepEditLink
Method	ctor
		- init mLastRow, mLastCol(0)

		
CLASS	oofRepEditingEnv
Method	changeAreasToNewLink
		- added forwarder to OOF_InteractionPageAreas

		
CLASS	OOF_InteractionPageAreas
Method	changeAreasToNewLink
		- added to remap matching areas


call mOwner->drawColumnHeaders instead of local render version
(so redirection can kick in if necessary) in:
- oofRepViewBand_CSVRender::draw
- oofRepViewBand_HTMLRender::draw		
- oofRepViewBand_RTFRender::draw				
- oofRepViewBand_TSVRender::draw
- oofRepViewBand_MacRender::draw
- oofRepViewBand_WinRender::draw
- oofRepViewBand_MacRender::DrawContinuingOverPage
- oofRepViewBand_WinRender::DrawContinuingOverPage
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/10
ALLOW USER-CONTROLLED DISABLE OF EDITING FIELDS IN VIEW BANDS

CLASS	oofRepViewBand
- mNonEditableFields added

Method	ctor(all)
		- init mNonEditableFields(0)
		
Method	copy ctor
		- copy mNonEditableFields
		
Method	dtor
		- delete mNonEditableFields

Method	fieldIsNonEditable
		setFieldNonEditable
		- added setter/getter
		

CLASS	oofRepViewEditLink
Method	getCellText
		- call fieldIsNonEditable to test


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/11
FIX BUGS IN  USER-CONTROLLED DISABLE OF EDITING FIELDS IN VIEW BANDS

CLASS	oofRepViewBand
Method	copy ctor
		- use new bool[aNumber] not new bool(aNumber)

Method		setFieldNonEditable
		- use new bool[aNumber] not new bool(aNumber)
		- clear the newly allocated array
		

CLASS	oofRepViewEditLink
Method	getCellText
		- reverse sense of test of fieldIsNonEditable
		
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/11
AUTOMATICALLY ENABLE AND DISABLE EDIT FIELD IN REPORT EDIT DIALOG

CLASS	oofRepLayoutEditLink
		oofRepViewEditLink
		
Method	getCellText
		- use mAdapter to make edit field read-only
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/12
MAKE EDITED COLUMN HEADERS APPEAR ON REDRAWN REPORT


CLASS	oofRepViewBand
- mColHeadersNeedRecalc added

Method	dirtyColHeaders
		- added setter for mColHeadersNeedRecalc

Method	startTableBody
		- pass mColHeadersNeedRecalc to render
		

CLASS	OOF_mixViewExtraRender
Method	startTableBody
		- add bool param
		

CLASS	oofRepViewBand_HTMLRender
Method	startTableBody
		- add bool param - unused
		

CLASS	oofRepViewBand_XMLRender
Method	startTableBody
		- add bool param - unused
				

CLASS	oofRepViewBand_MacRender
Method	startTableBody
		- add bool param and call CalcColHeaderWrapping
		
Method	finishConstruction
		- use CalcColHeaderWrapping

Method	CalcColHeaderWrapping
		- added 
				

CLASS	oofRepViewBand_WinRender
Method	startTableBody
		- add bool param and call CalcColHeaderWrapping
		
Method	finishConstruction
		- use CalcColHeaderWrapping

Method	CalcColHeaderWrapping
		- added and set font style to bold before wrapping
		  (old Win bug - wrapping calculated with non-bold font)


CLASS	oofRepColHeaderEditLink
Method	setCellText
		- call dirtyColHeaders

Method	Drawable
		- added caster

		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/12
FIX LAYOUT BAND NAVIGATION IN EDITOR

CLASS	oofRepLayoutEditLink
Method	getUpFromCurrent
		- use mCurrentRow-1 not constant 0 for new row
		
Method	initMapping		
		- inc mLastRow sonot left at zero (otherwise can never move down)
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/12
FIX INCONSISTENT MULTIPLE COL WIDTH CALCS

CLASS	oofRepViewBand_Render
Method	CalcColWidths
		- added using the bandSetting variations from draw() methods
		- include the initSizers of the col headers from the Mac draw
		  (was missing in text file output - possible source of console bugs?)

Method	finishConstruction
		- unconditionally invoke CalcColWidths (bug was that only did if 
		  drawing headers)
		  		
		  		
CLASS	oofRepViewBand_MacRender
Method	finishConstruction
		- just init the mColHeaders

Method	draw
		drawColumnHeaders
		- removed CalcColWidths
		  		
		  		
CLASS	oofRepViewBand_WinRender
Method	finishConstruction
		- just init the mColHeaders

Method	draw
		drawColumnHeaders
		- removed CalcColWidths
			  		
		  		
CLASS	oofRepViewBand_XMLRender
Method	finishConstruction
		- removed

Method	drawColumnHeaders	
		- removed		


CLASS	oofRepViewBand_TextRender
Method	drawColumnHeaders	
		- removed		


CLASS	oofRepViewBand_RTFRender
Method	drawColumnHeaders	
		draw			  		
		- remove colSizer calculateWidths
		

CLASS	oofRepViewRedirectingRender
Method	draw		
		- remove colSizer calculateWidths



CLASS	oofRepViewBand_HTMLRender
Method	draw
		- removed the call to drawColumnHeaders
		
Method	drawColumnHeaders	
		- removed		

Method	CalcColWidths
		- added
				
		
CLASS	OOF_mixViewExtraRender		
Method	drawColumnHeaders	
		- made empty (was pure virtual)
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/12
FINE-TUNE EDITING BEHAVIOUR AND DEFAULTS

CLASS	OOF_mixRepAbstractCellEditor
Method	AttemptSaveCellEditField		
		LoadCellEditField
		- added defaults using the mAdapter to copy to and from field
		
		
(see OOFILE_Code_Change_Diary.txt for change to avoid errors when save large 
items back to dbChar fields)

		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/12
FIX FAILURE TO REFRESH WINDOWS PREVIEW AFTER EDITING

CLASS	oofRepWindow
- change message map for ID_REPORT_REFRESH from ON_COMMAND
  to ON_MESSAGE(ID_REPORT_REFRESH, ReflowReport)


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/13
FIX CRASH IN CALCCOLHEADERS IN SAMPLE COL ALIGNENT (VIEWS WITHOUT COL HEADERS)

CLASS	oofRepViewBand_MacRender
		oofRepViewBand_WinRender
Method	startTableBody
		- make CalcColHeaderWrapping call conditional because the sizers
		  are only initialised if drawing headers at this level - will crash
		  if always called when hit a report which suppresses headers
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/14
WINDOWS BUG REPORT - EDITING TRIGGERED WHEN OPEN REPORT


CLASS	oofRepWindow  (Win)
- mButtonWasDown added

Method	ctor
		- init mButtonWasDown(false)
		
Method	OnLButtonDown
		- added to set mButtonWasDown
		
Method	OnLButtonUp
		- only act if mButtonWasDown
		
MMAP	ON_WMLBUTTONDOWN
		- added
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/14
WINDOWS BUG REPORT - OPENING NAMES WITH APOSTROPHES

CLASS	OOF_XMLrepLayoutParser
- mCharData added

Method	ParseAccumulatedCharData
		- moved old charData processing here
		
Method	charData
		- just keep appending to mCharData 		
		
Method	endElement
		- call ParseAccumulatedCharData
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/15
FIX PARSING BUGS FOR READING XML REPORTS

CLASS	OOF_XMLrepLayoutParser
Method	ParseAccumulatedCharData
		- clear mCharData when finished parsing it so exiting nested
		  scope doesn't reinterpret that data
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/15
FIX RECENTLY INTRODUCED FAILURE TO OUTPUT RTF

CLASS	oofRepRTFEnv
Method	encodeRTFString
		- add return of srcString if don't process any entities
		  was returning empty string
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/15
FIX FAILURE TO DRAW COLUMN HEADERS (DEPENDING ON APPLICATION)

CLASS	oofRepViewBand
- mColHeadersNeedRecalc renamed to mColHeadersNeedCalc to be clearer
  that not just for recalcs
  
Method	copy ctor
		- correct - add members to init list so they are copied:
		  mHeaders, mFooters, mHeaderBreaks, mFooterBreaks,
		  mHeight, mCustomDrawers, 
		- init mNonEditableFields(0), mColHeadersNeedRecalc(true)
		  
Method	ctor (both)
		- init mColHeadersNeedRecalc(true)


		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/16
FIX FAILURE TO PARSE SOME COMPLEX XML FILES
(was incorrectly written files - duplicate ID's)

CLASS	oofIDfactory
Method	leaveLevel
		- don't reset the current level ID value to 1 - some complex
		  traversals will recreate!
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/17
FIX FAILURE TO PARSE UNKNOWN SERIALISED XML ELEMENTS


CLASS	OOF_XMLrepAdornerParser
Method	endElement
		- if mCurrentSerializable is blank don't try to add adorner
		

CLASS	OOF_XMLrepLayoutParser
Method	endElement
		- if mCurrentSerializable is blank don't try to add custom drawer
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/17
BUG - ASSERT RESETTING ID'S WHEN SAVE REPORT THAT'S BEEN OPENED FROM DOCUMENT

CLASS	oofRepDrawable
Method	clearID
		- added
		
		
CLASS	OOF_repXMLclearIDVisitor added 


CLASS	OOF_XMLrepParser
Method	FinishReport
		- use a OOF_repXMLclearIDVisitor in case anything earlier 
		  makes assumptions
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/17
FIX - IMPROVE COLUMN ACCURACY FOR CLICKS TRIGGERING EDITING

CLASS	oofRepViewRedirectingRender
Method	AddRowInteractionAreas
		- compensate properly for the gutters on either side of cell drawn
		  content, and how adorners offset that gutter
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/17
FIX - PAGE SETUP CHANGES TO ORIENTATION PRIOR REPORT NOT SHOWN IN REPORT

CLASS	oofRepWinEnv
Method	initDefaultPageSetup
		- added
		
		
CLASS	oofRepWindow
Method	ctor
		- moved most page setup logic to initDefaultPageSetup				  
		
		
CLASS	oofRepWinGUIPreviewMFC
Method	ctor
		- moved dumb device-level default logic to initDefaultPageSetup	
		- use initDefaultPageSetup if passed NULL (less likely now given
		  oofRepWindow change - won't be passing down nulls)	



-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/18
BETTER CLICK DETECTION WHEN NON-EDITABLE AREAS ON REPORT

CLASS	OOF_InteractionArea
Method	matchesPageLocation
		- evaluate height and width ranges if specified
		

CLASS	oofRepLayoutRedirectingRender
Method	addAreaForCurrentBlock


CLASS	oofRepDrawable
Method	makeRender
		- now use editor to make a default wrapper, previously just passed to parent
		

CLASS	oofRepEditor
Method	makeDefaultRenderWrapper		
		- added factory
		

CLASS	oofNonEditableRedirectingRender
- added to call startNonEditableArea when drawing


CLASS	oofRepEditingEnv
Method	startNonEditableArea
		- added forwarder to close previous area in page		
		
		
CLASS	OOF_InteractionPageAreas
Method	startNonEditableArea		
		- added to terminate the last row which doesn't have a 
		  height set
		- modified this fix to set ALL preceding areas with zero
		  heights, until hits one with non-zero height
		  
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/18
FIX EDITING OF PICTURE BLOCKS NOT DISPLAYING ANY DATA

CLASS	oofRepPictBlock
Method	getCellText
		- add call to describe() to get picture path or resource ID
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/18
FIX FAILURE TO GO TO LAST CELL IN EDIT DIALOG

CLASS	oofRepEditLink
Method	getLastCoords
		- return last cell coords, was returning current
		  
		  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/02/17,27
USE XML STANDALONE READING AND WRITING WITHOUT OOFILE DATABASE 

FILE	oofrep.h
		oofadorn.h
- #include "oofxmldb.h" instead of "oofxml.h"

OOF_repXMLadornerVisitor::VisitAdorner
OOF_repXMLadornerVisitor::VisitAdorner
- refer to oofXMLwriter::makerSerializableElement
  instead of oofTagMaker...
  
  
OOF_repXMLlayoutVisitor::VisitViewBand
OOF_XMLrepLayoutParser::GetDatabaseInContext
- refer to oofTagMaker::encode/decodeName instead of
  oofXMLwriter
  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/20
FIX MINOR WINDOWS ERRORS

CLASS	oofRepEditingEnvironment
Method	startEnvironment
		- use dbDateTime::currentTime() instead of now() manipulator
		  if logging to OOF_REPEDIT_LOG_FILENAME because of VC compiler err
		  

CLASS	oofRepWinGUIPreviewMFC
Method	initDefaultPageSetup
		- fix refs to copied code that used &ps instead of ps so caused
		  memory overwrites


CLASS	OOF_mixRepCellEditor
Method	InitEditControls(
		- mOKButton - inOK replaced by assignment
		  (wasn't using member so no runtime errors due to non-init)
		

LIBRARY PROJECTS
- add XXXX SO targets, eg: \oofile\MSVC\vc5\Bin\Release\OOFReportLibSO.lib
so have static oldstream release builds for testing releases


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/22
FIX WINDOWS SCALING ERRORS WITH DIFFERENT RESOLUTIONS

CLASS	oofRepWindow
Method	OnLButtonUp
		- replace empirically determined ratio of 1.2 with formula
		  varying according to resolution.
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/22
ASSERT DUE TO GOING OVER PAGE ON COMPLEX REPORTS

CLASS	oofRepEditingEnv
- mSplitAreaForNextPage renamed as mLastAreaOnPrevPage and 
  no longer commented as "owned"
  
Method	splitBandOverPage
		- just hang onto ref to last area because that edit link
		  must be added to next page
		  
		  
Method	resumeBandOverPage
		- just hang onto ref to last area because that edit link
		  must be added to next page		  


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/25
FIX CRASH AFTER GOING OVER PAGE ON COMPLEX REPORTS

CLASS	oofRepEditingEnv
- mLastAreaOnPrevPage again keeps temp copy of an area so we can
  be sure the edit link is not deleted
  
Method	splitBandOverPage
		- mLastAreaOnPrevPage assigned a copy of last area
		  
		  
Method	resumeBandOverPage
		- mLastAreaOnPrevPage deleted
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/25
FIX MINOR BUG NOT MAKING BLOCKS READONLY RELIABLY

CLASS	oofRepLayoutEditLink
Method	getCellText
		- was not passing local var in to get block readonly status
		  so would make readonly randomly depending on how bool init
		  by chance
		  (spotted from warning about using uninitialized variable)
		  

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/25
FIX FAILURE OF WINDOWS PREVIEW WINDOW TO SENSE CLICKS > 1ST PAGE

CLASS	oofRepWinGUIPreviewMFC
- mCurrentPage added

Method	ctor
		- init mCurrentPage(0)

Method	drawPage
		- update mCurrentPage		
		
Method	previewPageOrdinal		
		- return mCurrentPage instead of mPages.index()
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/01/26
FIX WINDOWS CRASH EDITING IN RELEASE MODE

CLASS	oofRepWindow
Method	OnRefresh
		- added to call ReflowReport

MMap	ID_REPORT_REFRESH mapped to OnRefresh which has correct signature
		
  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/02/27
MAKE DUMMY NAMES ON REPORT UNIQUE ACROSS REPORT, NOT JUST  PER VIEWBAND

CLASS	OOF_repXMLschemaVisitor
- mDummyNames added

Method	UniquifyTables
		- remove local dummyNames using mDummyNames instead
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/02/27
EDITING JOIN KEYS AND OTHER FIELDS - AUTOMATICALLY MORE RUGGED & FASTER 

CLASS	oofRepEditor
Method	makeRepEditingSetupVisitor
		- added factory


CLASS	oofRep
Method	draw		
		- invoke oofRepEditor::makeRepEditingSetupVisitor instead of just
		  creating hardcoded OOF_repBufferSettingVisitor
		  
		  
CLASS	
- added subclass of OOF_repBufferSettingVisitor		  


FILE	oofrep1.cpp
- add #include "oofrepeditor.h"


CLASS	OOF_repBufferSettingVisitor
- moved decl out to oofrep1.h so can be used elsewhere, was just within .cpp


		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/02/28
FIX FAILURE TO ENABLE EDITING REPORT CELL PROPERLY

CLASS	OOF_mixRepAbstractCellEditor
Method	LoadCellEditField
		- remove redundant passing in bool to get editing setting


CLASS	oofRepEditLink
Method	setCellText
		- made non-const
		

CLASS	oofRepColHeaderEditLink
		oofRepLayoutEditLink
		oofRepViewEditLink
Method	getCellText
		- made non-const
		- call readOnly, not mAdaptor->readOnly so sets own member variable used
		  on Mac to test if field is read-only and so disable actions


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/04/13
DAVID's FIXES FOR  CORRECT ENCODING OF HI-ASCII

CLASS	OOF_XMLrepLayoutParser
Method	charData
		- use oofString::utf8To8BitAscii				
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/04/17
FIX FAILURE TO SAVE AND RESTORE BLOCK FIXED WIDTHS

CLASS	oofRepTextBlock_XMLRender
Method	describeLayout
		- if block has a fixedWidth() write a fixedWidth attribute
		

CLASS	OOF_XMLrepLayoutParser
- mCurrentBlockFixedWidth added 		

Method	BuildBlock
		- read optional fixedWidth attribute into mCurrentBlockFixedWidth
		
Method	ParseAccumulatedCharData
		- set fixedWidth attribute from mCurrentBlockFixedWidth	
		
		
CLASS	oofRepBlock
Method	fixedWidth(unsigned long inWidth) 		
		- change return type from void to oofRepBlock&  so can chain in <<
		  when adding to headers etc.
		- moved implementation out of class declaration to match others
		  
Method	fixedWidth() 		
		- moved implementation out of class declaration
		  

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/10/20-22
MERGE DAVID CARBONISED  & SERVER-AWARE BRANCHES

FILE	oofAdCon.cpp
- added to utils directory, used with "console-only" report-writer build


CLASS	oofRepDrawable
Method	makeEditLink
		- disable for CONSOLE_PROJECT
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/11/19
FIX CONSOLE-ONLY REPORTS

General replace
CONSOLE_PROJECT (pretty meaningless!) with
OOF_REP_NO_GUI


CLASS	oofRepSettings
Method	oofRepSettings(oofRepSettings*)
		- add closing #endif for #ifdef OOF_REP_NO_GUI


CLASS	oofRepGraphBand...
Method	makeRender(const oofRepCSVEnv&
		- comment unused 'env' argument just to save warnings
		
		
FILE	oofrixml.h
- added #include "oofSting.h"		


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/11/19
ALLOW SIMPLE XML-DRIVEN REPORTS WITH EXISTING DATABASE
AND LESS DETAILED XML SPEC

CLASS	OOF_XMLrepParser
- removed //owned comment next to mDB as we may create it by side effect
  (parsing </schema> but we are not responsible for delete!)
  
Method	ctor
		- take optional dbConnect*
		  

Method	startElement		  
		- don't require ID on <report>
		
Method	OpenTable
		- don't require ID on <table>		
		

CLASS	oofColSizer
Method	calculateWidths		
		- cope with total sep width ending up > width
		

CLASS	OOF_repXMLstyleCleanupVisitor
Method	VisitDrawable
		- allow for null text style being returned
		

CLASS	oofRepBlock
Method	textStyle()		
		- cope with no current layout from which to get default style
		

CLASS	oofCSS2RepTextStyle
Method	FindFontColour
		FindFontFamily
		FindAlignment
		FindFontSize
		- if missing, return oofRep::defaultSettings()->defaultTextStyle()->?	

Method	FindLineHeight
		- if missing, default to 1.0
		

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/11/23
INTEGRATE DAVID CHANGES FOR PRO6

CLASS	oofRepWindow
Method	DoPrint
		- use local var rather than writable temp for oofRepMacPrint


CLASS	oofRepLayoutBand
Method	operator<<(oofRepBlock&
		- change param to const ref
		

FILE	oofrpRTF.cpp
- change #if defined __MWERKS__  & __MWERKS__ == 0x2301	
to
#if defined __MWERKS__  & __MWERKS__ >= 0x2301	
		


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2000/11/23
FINISH BUILDING WITH PRO6

CLASS	oofRepGraphBand
Method	finishConstruction
		- use local var rather than writable temp for 
		oofDrawStyleSetDefaultIteration
		
		
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/02/05
REFACTOR TO ALLOW SUBCLASSING WITH XML XTRAS NUGGET

CLASS	OOF_XMLrepParser
Method	startElement
		endElement
		- split into separate virtual calls

Method	startElem_report
		startElem_section
		startElem_style
		startElem_adorners
		startElem_layout
		startElem_schema
		startUnknownElem
		endElem_report
		endElem_section
		endElem_style
		endElem_adorners
		endElem_layout
		endElem_schema
		endUnknownElem
		- added factored out code from old startElement/endElement
		  or empty stubs for later overriding
		  
		  
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/08/17 MERGE DAVID'S OS/X AND PRO7 FIXES


Conditionally use new Carbon accessors
- oofBorderAdorner_MacRender::drawcell
- oofBorderAdorner_MacRender::drawTo
- oofShadingAdorner_MacRender::drawcell
- oofBandShadingAdorner_MacRender::drawcell
- oofPattern::macPattern
- oofTextDrawer::invariant
- oofPict::Load
- oofPict::draw
- oofRepLineBand_MacRender::draw
- oofRepLayoutBand_MacRender::draw
- oofRepPictBlock_MacRender::draw
- oofRepLineBand_RTFRender::draw
- oofRepPictBand_RTFRender::draw

FILE	oofrep2.cpp
- conditionally #include <Navigation.h> instead of <StandardFile.h>


CLASS	oofRepStreamEnv
Method	canDraw
		- conditionally use new Nav services rather than standard files


oofRepViewBand_MacRender::CalcColHeaderWrapping
- just disabled setting bold text


FILE	oofRepPPWindow.h
- conditionally include <UPrintingMgr.h> or newer <UPrinting.h>	
  based on PowerPlant version __PowerPlant__	< 0x02118000	

- conditionally define handleNavEvent

  
CLASS	oofRepWindow
Method	DoPrint  
		- conditionally use UPrintingMgr or UPrinting
		- conditionally use Carbon printing via oofMacCarbonPrint

Method	navFilterProc
		- added conditional on carbon
		
Method	PrintAsPreviewed
		- conditionaly use PMBegin instead of PrOpen
		
Method	DoPageSetup		
		- conditionally use UPrintingMgr or UPrinting

Method	DoSaveAs		
		- conditionally re-implement for carbon using NavServices
		

CLASS	oofRepMacGUIPreviewPP		
Method	ctor
		- conditional on carbon - init mFlatFormat & mFlatSettings to zero
		

CLASS	oofRepMacGUIPreviewPP
Method	changeTextStyle		
		- conditionally on carbon use FMGetFontFamilyFromName
		
Method	calcPageHeight
		- conditionally on carbon use PMBegin etc.
		- conditionally use UPrintingMgr or UPrinting

Method	getFlatSettings
		getFlatFormat
		getOldRecord
		- conditionally on carbon added these getters
		

FILE	oofRepPreviewPP.h
- based on carbon, conditionally #include "oofMacCarbonPrint.h" 
  instead of "oofRepMacPrint.h"
  
  
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/10/07
ADD 'ONE LINE REPORT' CONSTRUCTION

CLASS	oofRep
Method	ctor(dbTable*,...
		- added ctor taking dbTable so will use makeView to get body
		
Method	ctor(dbView*,...
		- added ctor taking dbView for default body
		
		
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/10/07
FIX BUILDING REPORT PROGRAMS WITHOUT READING REPORTS

Make method bodies conditional on OOF_READ_XML
- oofBorderAdorner::registerSerializable
- oofShadingAdorner::registerSerializable
- oofRepBreakEveryRecord::registerSerializable


FILE	oofrep3.cpp
- make the definition of oofSerializableFactory::sFactories
  conditional on #ifdef OOF_READ_XML
  
  
FILE	oofriXML.h, oofriXML.cpp  
- make entire body of files conditional on #ifdef OOF_READ_REPORTS
(Note: the factories are generically useful if reading XML so are conditional
 on OOF_READ_XML, this stuff is more specifically only reports)
 
 
-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/10/07
FIX BUG BUILDING CARBON REPORTING APPS WITH FEWER DEPENDENCIES

FILE	oofRepMac.h
- change unconditional #include <Printing.h> to
#if !defined(TARGET_RT_MAC_MACHO) || !TARGET_RT_MAC_MACHO
	#include <Printing.h>

FILE	oofMacCarbonPrint.h
- added #include <PMApplication.h>

FILE	oofRepMacPrint.cpp
- added #include <Printing.h>
- wrap all contents testing #if defined(TARGET_API_MAC_CARBON) && TARGET_API_MAC_CARBON!=0
 so can include in Carbon builds


FILE	oofrepeditMac.h
- added forward define of LControl
- added #include <LAttachment.h>

FILE	oofrepeditMac.cpp
- added #include <LPane.h>

FILE	oofrepPreviewPP.h
- added forward define of LCommander


FILE	oofrepeditx.h
- added forward define of LPane


CLASS	oofRepMacEnv
Method	ctor
		- added default to init	mPrintRecordH(0), mSavedPort(0)


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/10/23
BRING REPORT EDITING UP TO DATE WITH LATEST GUI

CLASS	oofRepEditLink
Method	leaveLink
		- return bool to match dbFieldLink::leaveLink
		  (was hiding inherited virtual)
		  


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/10/25
DAVID FIX TO COMPILE LATEST MAC PREVIEW WINDOW WITH OLDER CODEWARRIOR

FILE	oofRepPPWindow.cpp, .h
Func	handleNavEvent		  
		- define conditional on Carbon


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/10/26
WINDOWS FIX BASED ON VC6 WARNING

CLASS	oofWinTextStyleDE
Method	safeChangeStyle
		- remove strange assign CLR_INVALID != SetTextColor
		  (looks like editing mistake)


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/12/20
FIX REPORT PREVIEW OPEN FILES - MAC CARBON NOT SHOWING FILES

CLASS	oofRepWindow
Method	DoOpen
		- add logic from UNavServicesDialogs::AskOpenOneFile
		  customised to allow it to open files from any creator

Method	DoSaveAs
		- call setNavMenuItemSpec(myMenu[2], 'MSIE', 'HTML'
		instead of setNavMenuItemSpec(myMenu[2], 'MSIE', 'TEXT'
		so that it's clearer that the document content type
		is TEXT
		- set local constants (were 'R*ch' and 'XML ' respectively)  
		OSType fileTypeToSave = 'TEXT';  
		OSType creatorType = 'R*ch';
		- set mPopMenItem.menuType = 'XML ' to drive menu choice
		  correctly, NOT same as fileTypeToSave

				  
Method	doPopUPChoice		  		
		- renamed to doPopupChoice
		- use 'HTML' as menu type for Web pages, not 'TEXT'


-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/12/20
MAC REPORT PREVIEW OPEN FILES - MAC CARBON DIDN'T ALLOW CUSTOM REPORT TYPE

CLASS	oofRepWindow
Method	navFilterProc
		- change != || != pattern of if() statement to != && !=
		- compare against '????' NOT 'RTF " as we don't import RTF,
		  only export it
		- also allow file type of XMLsettings->saveReportDocMacFileType()
		

-=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
2001/12/20
ENABLE PAGE UP/DOWN SCROLLING OF MAC REPORT PREVIEW

CLASS	oofRepWindow
Method	FinishCreateSelf
		- added LKeyScrollAttachment to the preview window, to scroll
		  our embedded report view (mPICTView)
		
				

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
OOFILE 1.4 PUBLIC RELEASE
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
